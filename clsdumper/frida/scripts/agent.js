ðŸ“¦
3964 /src/main.js.map
3721 /src/main.js
2810 /node_modules/@frida/base64-js/index.js.map
1428 /node_modules/@frida/base64-js/index.js
â†» base64-js
36817 /node_modules/@frida/buffer/index.js.map
25206 /node_modules/@frida/buffer/index.js
â†» buffer
2127 /node_modules/@frida/ieee754/index.js.map
1001 /node_modules/@frida/ieee754/index.js
â†» ieee754
11491 /node_modules/frida-java-bridge/index.js.map
8289 /node_modules/frida-java-bridge/index.js
â†» frida-java-bridge
2015 /node_modules/frida-java-bridge/lib/alloc.js.map
903 /node_modules/frida-java-bridge/lib/alloc.js
85520 /node_modules/frida-java-bridge/lib/android.js.map
82544 /node_modules/frida-java-bridge/lib/android.js
338 /node_modules/frida-java-bridge/lib/api.js.map
141 /node_modules/frida-java-bridge/lib/api.js
43116 /node_modules/frida-java-bridge/lib/class-factory.js.map
27255 /node_modules/frida-java-bridge/lib/class-factory.js
5430 /node_modules/frida-java-bridge/lib/class-model.js.map
36340 /node_modules/frida-java-bridge/lib/class-model.js
23781 /node_modules/frida-java-bridge/lib/env.js.map
19095 /node_modules/frida-java-bridge/lib/env.js
20974 /node_modules/frida-java-bridge/lib/jvm.js.map
17792 /node_modules/frida-java-bridge/lib/jvm.js
2020 /node_modules/frida-java-bridge/lib/jvmti.js.map
1278 /node_modules/frida-java-bridge/lib/jvmti.js
1037 /node_modules/frida-java-bridge/lib/lru.js.map
451 /node_modules/frida-java-bridge/lib/lru.js
544 /node_modules/frida-java-bridge/lib/machine-code.js.map
173 /node_modules/frida-java-bridge/lib/machine-code.js
342 /node_modules/frida-java-bridge/lib/memoize.js.map
97 /node_modules/frida-java-bridge/lib/memoize.js
18202 /node_modules/frida-java-bridge/lib/mkdex.js.map
9137 /node_modules/frida-java-bridge/lib/mkdex.js
324 /node_modules/frida-java-bridge/lib/result.js.map
100 /node_modules/frida-java-bridge/lib/result.js
13044 /node_modules/frida-java-bridge/lib/types.js.map
8168 /node_modules/frida-java-bridge/lib/types.js
3153 /node_modules/frida-java-bridge/lib/vm.js.map
2180 /node_modules/frida-java-bridge/lib/vm.js
1075 /src/config/constants.js.map
894 /src/config/constants.js
901 /src/config/offsets.js.map
844 /src/config/offsets.js
1516 /src/core/androidVersion.js.map
1193 /src/core/androidVersion.js
7018 /src/core/antiFrida.js.map
4864 /src/core/antiFrida.js
1546 /src/core/deduplicator.js.map
808 /src/core/deduplicator.js
1085 /src/core/dexDumper.js.map
767 /src/core/dexDumper.js
8240 /src/core/offsetResolver.js.map
7076 /src/core/offsetResolver.js
4931 /src/strategies/artWalker.js.map
3445 /src/strategies/artWalker.js
4801 /src/strategies/classLoaderHook.js.map
3772 /src/strategies/classLoaderHook.js
3450 /src/strategies/cookieExtractor.js.map
2399 /src/strategies/cookieExtractor.js
2320 /src/strategies/dexFileConstructorHook.js.map
1700 /src/strategies/dexFileConstructorHook.js
4241 /src/strategies/fartDump.js.map
3062 /src/strategies/fartDump.js
2806 /src/strategies/memoryScanner.js.map
1864 /src/strategies/memoryScanner.js
2073 /src/strategies/mmapHook.js.map
1424 /src/strategies/mmapHook.js
3418 /src/strategies/oatExtractor.js.map
2106 /src/strategies/oatExtractor.js
1869 /src/strategies/openCommonHook.js.map
1397 /src/strategies/openCommonHook.js
1012 /src/utils/logger.js.map
463 /src/utils/logger.js
1395 /src/utils/memoryUtils.js.map
954 /src/utils/memoryUtils.js
1013 /src/utils/messageSender.js.map
634 /src/utils/messageSender.js
âœ„
{"version":3,"file":"main.js","names":["Java","Deduplicator","DexDumper","OffsetResolver","getAndroidInfo","getAndroidInfoNative","installAntiFridaBypass","runMemoryScanner","runCookieExtractor","runOpenCommonHook","runClassLoaderHooks","runArtWalker","runMmapHook","runOatExtractor","runFartDump","runDexFileConstructorHook","sendInfo","sendStrategyStatus","sendError","logger","setDebug","STRATEGY_NAMES","enabledStrategies","Set","ART_WALK","OPEN_COMMON_HOOK","MEMORY_SCAN","COOKIE","CLASSLOADER_HOOK","OAT_EXTRACT","FART_DUMP","DEXFILE_CONSTRUCTOR","deepScan","antiFrida","dumper","offsetResolver","formatBytes","bytes","toFixed","rpc","exports","configure","strategies","deep","debug","noAntiFrida","Array","from","recv","info","e","warn","apiLevel","release","arch","artOffsets","resolve","has","MMAP_HOOK","uniqueCount","totalBytes","perform","javaInfo","executeStrategies","Interceptor","detachAll"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/","sources":["main.ts"],"mappings":"OAAOA,MAAU,2CACRC,MAAoB,6CACpBC,MAAiB,+CACjBC,MAAsB,oDACtBC,0BAAgBC,MAA4B,4DAC5CC,MAA8B,iDAC9BC,MAAwB,6DACxBC,MAA0B,8DAC1BC,MAAyB,+DACzBC,MAA2B,yDAC3BC,MAAoB,kDACpBC,MAAmB,qDACnBC,MAAuB,qDACvBC,MAAmB,+DACnBC,MAAiC,4DACjCC,wBAAUC,eAAoBC,MAAiB,4CAC/CC,cAAQC,MAAgB,6CACxBC,MAAoC,wBAE7C,IAAIC,EAAuC,IAAIC,IAAI,CAC/CF,EAAeG,SACfH,EAAeI,iBACfJ,EAAeK,YACfL,EAAeM,OACfN,EAAeO,iBACfP,EAAeQ,YACfR,EAAeS,UACfT,EAAeU,sBAKfC,GAAW,EACXC,GAAY,EAGhB,MACMC,EAAS,IAAIhC,EADL,IAAID,GAEZkC,EAAiB,IAAIhC,EAgK3B,SAASiC,EAAYC,GACjB,OAAIA,EAAQ,KAAa,GAAGA,MACxBA,EAAQ,QAAoB,IAAIA,EAAQ,MAAMC,QAAQ,QACnD,IAAID,EAAQ,SAAeC,QAAQ,OAC9C,CAlKAC,IAAIC,QAAU,CACVC,UAAUC,EAAmCC,EAAeC,EAAgBC,GACpED,GAAOxB,GAAS,GAChBsB,IAAYpB,EAAoB,IAAIC,IAAImB,IAC5CV,EAAWW,EACPE,IAAaZ,GAAY,GAC7Bd,EAAOyB,MAAM,QAAS,sBAAsBE,MAAMC,KAAKzB,YAA4BqB,gBAAmBV,IAC1G,GAIJe,KAAK,OAAO,MAIZ,WAKI,GAFA7B,EAAO8B,KAAK,QAAS,+BAEjBhB,EACA,IACI3B,G,CACF,MAAO4C,GACL/B,EAAOgC,KAAK,QAAS,wCAAwCD,I,CAMrE,MAAMD,EAAO5C,IACb,IAAI+C,EAAWH,EAAKG,SACpBpC,EAAS,WAAWiC,EAAKI,gBAAgBJ,EAAKG,oBAAoBH,EAAKK,QAGvE,IAAIC,EAAa,KACjB,IACIA,EAAapB,EAAeqB,QAAQJ,E,CACtC,MAAOF,GACL/B,EAAOgC,KAAK,QAAS,4BAA4BD,I,CAIrD,GAAI5B,EAAkBmC,IAAIpC,EAAeqC,WACrC,IAAM9C,EAAYsB,E,CAClB,MAAOgB,GAAKhC,EAAUG,EAAeqC,UAAW,GAAGR,I,MAEnDjC,EAAmBI,EAAeqC,UAAW,UAAW,YAI5D,GAAIpC,EAAkBmC,IAAIpC,EAAeU,qBACrC,IAAMhB,EAA0BmB,E,CAChC,MAAOgB,GAAKhC,EAAUG,EAAeU,oBAAqB,GAAGmB,I,MAE7DjC,EAAmBI,EAAeU,oBAAqB,UAAW,YAItE,GAAIT,EAAkBmC,IAAIpC,EAAeI,kBACrC,IAAMhB,EAAkByB,E,CACxB,MAAOgB,GAAKhC,EAAUG,EAAeI,iBAAkB,GAAGyB,I,MAE1DjC,EAAmBI,EAAeI,iBAAkB,UAAW,YAInE,GAAIH,EAAkBmC,IAAIpC,EAAeS,WACrC,IAAMhB,EAAYoB,EAAQC,EAAgBoB,E,CAC1C,MAAOL,GAAKhC,EAAUG,EAAeS,UAAW,GAAGoB,I,MAEnDjC,EAAmBI,EAAeS,UAAW,UAAW,YAI5D,GAAIR,EAAkBmC,IAAIpC,EAAeG,UACrC,GAAI+B,EACA,IAAM5C,EAAauB,EAAQC,EAAgBoB,E,CAC3C,MAAOL,GAAKhC,EAAUG,EAAeG,SAAU,GAAG0B,I,MAElDjC,EAAmBI,EAAeG,SAAU,UAAW,sCAG3DP,EAAmBI,EAAeG,SAAU,UAAW,YAI3D,GAAIF,EAAkBmC,IAAIpC,EAAeQ,aACrC,IAAMhB,EAAgBqB,E,CACtB,MAAOgB,GAAKhC,EAAUG,EAAeQ,YAAa,GAAGqB,I,MAErDjC,EAAmBI,EAAeQ,YAAa,UAAW,YAI9D,GAAIP,EAAkBmC,IAAIpC,EAAeK,aACrC,IAAMnB,EAAiB2B,EAAQF,E,CAC/B,MAAOkB,GAAKhC,EAAUG,EAAeK,YAAa,GAAGwB,I,MAErDjC,EAAmBI,EAAeK,YAAa,UAAW,YAG9DV,EAAS,+BAA+BkB,EAAOyB,iCAAiCvB,EAAYF,EAAO0B,gBAOnG,GAHkBtC,EAAkBmC,IAAIpC,EAAeM,SACnDL,EAAkBmC,IAAIpC,EAAeO,kBAGrC,IACI5B,EAAK6D,SAAQ,KACT1C,EAAO8B,KAAK,QAAS,sBAGrB,IACI,MAAMa,EAAW1D,IACjBgD,EAAWU,EAASV,Q,CACtB,M,CAKF,GAAI9B,EAAkBmC,IAAIpC,EAAeM,QACrC,IAAMnB,EAAmB0B,EAAQC,E,CACjC,MAAOe,GAAKhC,EAAUG,EAAeM,OAAQ,GAAGuB,I,MAEhDjC,EAAmBI,EAAeM,OAAQ,UAAW,YAIzD,GAAIL,EAAkBmC,IAAIpC,EAAeO,kBACrC,IAAMlB,EAAoBwB,E,CAC1B,MAAOgB,GAAKhC,EAAUG,EAAeO,iBAAkB,GAAGsB,I,MAE1DjC,EAAmBI,EAAeO,iBAAkB,UAAW,YAGnEZ,EAAS,4BAA4BkB,EAAOyB,iCAAiCvB,EAAYF,EAAO0B,gBAChG5C,EAAS,6CAA6C,G,CAE5D,MAAOkC,GACL/B,EAAOgC,KAAK,QAAS,qCAAqCD,KAC1DlC,EAAS,yDAAyDkB,EAAOyB,iCAAiCvB,EAAYF,EAAO0B,e,MAGjI5C,EAAS,4BAA4BkB,EAAOyB,iCAAiCvB,EAAYF,EAAO0B,eAExG,CAxIIG,EAAmB,IA4IvBf,KAAK,QAAQ,KACT7B,EAAO8B,KAAK,QAAS,wBACrBe,YAAYC,YACZjD,EAAS,gBAAgB","ignoreList":[]}
âœ„
import e from"frida-java-bridge";import{Deduplicator as t}from"./core/deduplicator.js";import{DexDumper as r}from"./core/dexDumper.js";import{OffsetResolver as s}from"./core/offsetResolver.js";import{getAndroidInfo as i,getAndroidInfoNative as o}from"./core/androidVersion.js";import{installAntiFridaBypass as a}from"./core/antiFrida.js";import{runMemoryScanner as O}from"./strategies/memoryScanner.js";import{runCookieExtractor as l}from"./strategies/cookieExtractor.js";import{runOpenCommonHook as n}from"./strategies/openCommonHook.js";import{runClassLoaderHooks as p}from"./strategies/classLoaderHook.js";import{runArtWalker as c}from"./strategies/artWalker.js";import{runMmapHook as f}from"./strategies/mmapHook.js";import{runOatExtractor as A}from"./strategies/oatExtractor.js";import{runFartDump as m}from"./strategies/fartDump.js";import{runDexFileConstructorHook as d}from"./strategies/dexFileConstructorHook.js";import{sendInfo as E,sendStrategyStatus as u,sendError as C}from"./utils/messageSender.js";import{logger as T,setDebug as _}from"./utils/logger.js";import{STRATEGY_NAMES as R}from"./config/constants.js";let g=new Set([R.ART_WALK,R.OPEN_COMMON_HOOK,R.MEMORY_SCAN,R.COOKIE,R.CLASSLOADER_HOOK,R.OAT_EXTRACT,R.FART_DUMP,R.DEXFILE_CONSTRUCTOR]),D=!1,$=!0;const h=new r(new t),M=new s;function N(e){return e<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(1)} KB`:`${(e/1048576).toFixed(1)} MB`}rpc.exports={configure(e,t,r,s){r&&_(!0),e&&(g=new Set(e)),D=t,s&&($=!1),T.debug("AGENT",`Config: strategies=${Array.from(g)}, deep=${t}, antiFrida=${$}`)}},recv("run",(()=>{!function(){if(T.info("AGENT","CLSDumper agent starting..."),$)try{a()}catch(e){T.warn("AGENT",`Anti-frida bypass error (non-fatal): ${e}`)}const t=o();let r=t.apiLevel;E(`Android ${t.release} (API ${t.apiLevel}), arch: ${t.arch}`);let s=null;try{s=M.resolve(r)}catch(e){T.warn("AGENT",`Offset resolution error: ${e}`)}if(g.has(R.MMAP_HOOK))try{f(h)}catch(e){C(R.MMAP_HOOK,`${e}`)}else u(R.MMAP_HOOK,"skipped","Disabled");if(g.has(R.DEXFILE_CONSTRUCTOR))try{d(h)}catch(e){C(R.DEXFILE_CONSTRUCTOR,`${e}`)}else u(R.DEXFILE_CONSTRUCTOR,"skipped","Disabled");if(g.has(R.OPEN_COMMON_HOOK))try{n(h)}catch(e){C(R.OPEN_COMMON_HOOK,`${e}`)}else u(R.OPEN_COMMON_HOOK,"skipped","Disabled");if(g.has(R.FART_DUMP))try{m(h,M,s)}catch(e){C(R.FART_DUMP,`${e}`)}else u(R.FART_DUMP,"skipped","Disabled");if(g.has(R.ART_WALK))if(s)try{c(h,M,s)}catch(e){C(R.ART_WALK,`${e}`)}else u(R.ART_WALK,"skipped","Could not resolve ART offsets");else u(R.ART_WALK,"skipped","Disabled");if(g.has(R.OAT_EXTRACT))try{A(h)}catch(e){C(R.OAT_EXTRACT,`${e}`)}else u(R.OAT_EXTRACT,"skipped","Disabled");if(g.has(R.MEMORY_SCAN))try{O(h,D)}catch(e){C(R.MEMORY_SCAN,`${e}`)}else u(R.MEMORY_SCAN,"skipped","Disabled");E(`Native strategies complete: ${h.uniqueCount} unique DEX files (${N(h.totalBytes)})`);if(g.has(R.COOKIE)||g.has(R.CLASSLOADER_HOOK))try{e.perform((()=>{T.info("AGENT","Java bridge active");try{const e=i();r=e.apiLevel}catch{}if(g.has(R.COOKIE))try{l(h,M)}catch(e){C(R.COOKIE,`${e}`)}else u(R.COOKIE,"skipped","Disabled");if(g.has(R.CLASSLOADER_HOOK))try{p(h)}catch(e){C(R.CLASSLOADER_HOOK,`${e}`)}else u(R.CLASSLOADER_HOOK,"skipped","Disabled");E(`All strategies complete: ${h.uniqueCount} unique DEX files (${N(h.totalBytes)})`),E("Hooks active â€” watching for dynamic loads.")}))}catch(e){T.warn("AGENT",`Java bridge failed (anti-debug?): ${e}`),E(`Java strategies skipped (anti-debug). Native results: ${h.uniqueCount} unique DEX files (${N(h.totalBytes)})`)}else E(`All strategies complete: ${h.uniqueCount} unique DEX files (${N(h.totalBytes)})`)}()})),recv("stop",(()=>{T.info("AGENT","Received stop signal"),Interceptor.detachAll(),E("Agent stopped")}));
âœ„
{"version":3,"file":"index.js","names":["lookup","revLookup","code","i","len","length","charCodeAt","getLens","b64","Error","validLen","indexOf","byteLength","lens","placeHoldersLen","toByteArray","arr","Uint8Array","_byteLength","curByte","tmp","encodeChunk","uint8","start","end","output","push","num","join","fromByteArray","extraBytes","parts","maxChunkLength","len2"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/@frida/base64-js/","sources":[""],"mappings":"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","ignoreList":[]}
âœ„
const t=[],o=[],n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(let c=0,h=n.length;c<h;++c)t[c]=n[c],o[n.charCodeAt(c)]=c;function r(t){const o=t.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");let n=t.indexOf("=");-1===n&&(n=o);return[n,n===o?0:4-n%4]}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63;export function byteLength(t){const o=r(t),n=o[0],e=o[1];return 3*(n+e)/4-e}export function toByteArray(t){const n=r(t),e=n[0],c=n[1],h=new Uint8Array(function(t,o,n){return 3*(o+n)/4-n}(0,e,c));let s=0;const a=c>0?e-4:e;let f;for(f=0;f<a;f+=4){const n=o[t.charCodeAt(f)]<<18|o[t.charCodeAt(f+1)]<<12|o[t.charCodeAt(f+2)]<<6|o[t.charCodeAt(f+3)];h[s++]=n>>16&255,h[s++]=n>>8&255,h[s++]=255&n}if(2===c){const n=o[t.charCodeAt(f)]<<2|o[t.charCodeAt(f+1)]>>4;h[s++]=255&n}if(1===c){const n=o[t.charCodeAt(f)]<<10|o[t.charCodeAt(f+1)]<<4|o[t.charCodeAt(f+2)]>>2;h[s++]=n>>8&255,h[s++]=255&n}return h}function e(o,n,r){const e=[];for(let h=n;h<r;h+=3){const n=(o[h]<<16&16711680)+(o[h+1]<<8&65280)+(255&o[h+2]);e.push(t[(c=n)>>18&63]+t[c>>12&63]+t[c>>6&63]+t[63&c])}var c;return e.join("")}export function fromByteArray(o){const n=o.length,r=n%3,c=[],h=16383;for(let t=0,s=n-r;t<s;t+=h)c.push(e(o,t,t+h>s?s:t+h));if(1===r){const r=o[n-1];c.push(t[r>>2]+t[r<<4&63]+"==")}else if(2===r){const r=(o[n-2]<<8)+o[n-1];c.push(t[r>>10]+t[r>>4&63]+t[r<<2&63]+"=")}return c.join("")}
âœ„
{"version":3,"file":"index.js","names":["base64","ieee754","config","INSPECT_MAX_BYTES","K_MAX_LENGTH","createBuffer","length","RangeError","buf","Uint8Array","Object","setPrototypeOf","Buffer","prototype","TYPED_ARRAY_SUPPORT","defineProperty","enumerable","get","isBuffer","this","buffer","byteOffset","arg","encodingOrOffset","TypeError","allocUnsafe","from","value","string","encoding","isEncoding","byteLength","actual","write","slice","fromString","ArrayBuffer","isView","arrayView","copy","fromArrayBuffer","fromArrayLike","fromArrayView","SharedArrayBuffer","valueOf","b","obj","len","checked","undefined","Number","isNaN","type","Array","isArray","data","fromObject","Symbol","toPrimitive","assertSize","size","array","i","toString","poolSize","alloc","fill","allocUnsafeSlow","SlowBuffer","mustMatch","arguments","loweredCase","utf8ToBytes","base64ToBytes","toLowerCase","slowToString","start","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","n","m","bidirectionalIndexOf","val","dir","arrayIndexOf","indexOf","call","lastIndexOf","arr","indexSize","arrLength","valLength","String","read","readUInt16BE","foundIndex","found","j","hexWrite","offset","remaining","strLen","parsed","parseInt","substr","utf8Write","blitBuffer","asciiWrite","str","byteArray","push","charCodeAt","asciiToBytes","base64Write","ucs2Write","units","c","hi","lo","utf16leToBytes","fromByteArray","Math","min","res","firstByte","codePoint","bytesPerSequence","secondByte","thirdByte","fourthByte","tempCodePoint","codePoints","fromCharCode","apply","decodeCodePointsArray","_isBuffer","compare","a","x","y","concat","list","pos","set","swap16","swap32","swap64","toLocaleString","equals","inspect","max","replace","trim","for","target","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","Error","toJSON","_arr","ret","out","hexSliceLookupTable","bytes","checkOffset","ext","checkInt","wrtBigUInt64LE","checkIntBI","BigInt","wrtBigUInt64BE","checkIEEE754","writeFloat","littleEndian","noAssert","writeDouble","newBuf","subarray","readUintLE","readUIntLE","mul","readUintBE","readUIntBE","readUint8","readUInt8","readUint16LE","readUInt16LE","readUint16BE","readUint32LE","readUInt32LE","readUint32BE","readUInt32BE","readBigUInt64LE","validateNumber","first","last","boundsError","readBigUInt64BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readBigInt64LE","readBigInt64BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUintLE","writeUIntLE","writeUintBE","writeUIntBE","writeUint8","writeUInt8","writeUint16LE","writeUInt16LE","writeUint16BE","writeUInt16BE","writeUint32LE","writeUInt32LE","writeUint32BE","writeUInt32BE","writeBigUInt64LE","writeBigUInt64BE","writeIntLE","limit","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeBigInt64LE","writeBigInt64BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","copyWithin","code","errors","E","sym","getMessage","Base","constructor","super","writable","configurable","name","stack","message","addNumericalSeparator","range","ERR_OUT_OF_RANGE","checkBounds","ERR_INVALID_ARG_TYPE","floor","ERR_BUFFER_OUT_OF_BOUNDS","input","msg","received","isInteger","abs","INVALID_BASE64_RE","Infinity","leadSurrogate","toByteArray","split","base64clean","src","dst","alphabet","table","i16","kMaxLength"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/@frida/buffer/","sources":[""],"mappings":"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","ignoreList":[]}
âœ„
/*!
 * The buffer module from node.js, for Frida.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
import*as t from"base64-js";import*as e from"ieee754";export const config={INSPECT_MAX_BYTES:50};const r=2147483647;export{r as kMaxLength};function n(t){if(t>2147483647)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,Buffer.prototype),e}Buffer.TYPED_ARRAY_SUPPORT=!0,Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}});export function Buffer(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return o(t)}return f(t,e,r)}function f(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!Buffer.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const r=0|a(t,e);let f=n(r);const i=f.write(t,e);i!==r&&(f=f.slice(0,i));return f}(t,e);if(ArrayBuffer.isView(t))return function(t){if(t instanceof Uint8Array){const e=new Uint8Array(t);return s(e.buffer,e.byteOffset,e.byteLength)}return u(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(t instanceof ArrayBuffer||t&&t.buffer instanceof ArrayBuffer)return s(t,e,r);if(t instanceof SharedArrayBuffer||t&&t.buffer instanceof SharedArrayBuffer)return s(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const f=t.valueOf&&t.valueOf();if(null!=f&&f!==t)return Buffer.from(f,e,r);const i=function(t){if(Buffer.isBuffer(t)){const e=0|h(t.length),r=n(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||Number.isNaN(t.length)?n(0):u(t);if("Buffer"===t.type&&Array.isArray(t.data))return u(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return Buffer.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function i(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function o(t){return i(t),n(t<0?0:0|h(t))}function u(t){const e=t.length<0?0:0|h(t.length),r=n(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function s(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,Buffer.prototype),n}function h(t){if(t>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|t}Buffer.poolSize=8192,Buffer.from=function(t,e,r){return f(t,e,r)},Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype),Object.setPrototypeOf(Buffer,Uint8Array),Buffer.alloc=function(t,e,r){return function(t,e,r){return i(t),t<=0?n(t):void 0!==e?"string"==typeof r?n(t).fill(e,r):n(t).fill(e):n(t)}(t,e,r)},Buffer.allocUnsafe=function(t){return o(t)},Buffer.allocUnsafeSlow=function(t){return o(t)};export function SlowBuffer(t){return+t!=t&&(t=0),Buffer.alloc(+t)}function a(t,e){if(Buffer.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||t instanceof ArrayBuffer)return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let f=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return z(t).length;default:if(f)return n?-1:j(t).length;e=(""+e).toLowerCase(),f=!0}}function c(t,e,r){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return A(this,e,r);case"utf8":case"utf-8":return m(this,e,r);case"ascii":return I(this,e,r);case"latin1":case"binary":return U(this,e,r);case"base64":return E(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function l(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function p(t,e,r,n,f){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,Number.isNaN(r)&&(r=f?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(f)return-1;r=t.length-1}else if(r<0){if(!f)return-1;r=0}if("string"==typeof e&&(e=Buffer.from(e,n)),Buffer.isBuffer(e))return 0===e.length?-1:g(t,e,r,n,f);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?f?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):g(t,[e],r,n,f);throw new TypeError("val must be string, number or Buffer")}function g(t,e,r,n,f){let i,o=1,u=t.length,s=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,u/=2,s/=2,r/=2}function h(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(f){let n=-1;for(i=r;i<u;i++)if(h(t,i)===h(e,-1===n?0:i-n)){if(-1===n&&(n=i),i-n+1===s)return n*o}else-1!==n&&(i-=i-n),n=-1}else for(r+s>u&&(r=u-s),i=r;i>=0;i--){let r=!0;for(let n=0;n<s;n++)if(h(t,i+n)!==h(e,n)){r=!1;break}if(r)return i}return-1}function y(t,e,r,n){r=Number(r)||0;const f=t.length-r;n?(n=Number(n))>f&&(n=f):n=f;const i=e.length;let o;for(n>i/2&&(n=i/2),o=0;o<n;++o){const n=parseInt(e.substr(2*o,2),16);if(Number.isNaN(n))return o;t[r+o]=n}return o}function B(t,e,r,n){return D(j(e,t.length-r),t,r,n)}function w(t,e,r,n){return D(function(t){const e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function d(t,e,r,n){return D(z(e),t,r,n)}function b(t,e,r,n){return D(function(t,e){let r,n,f;const i=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,f=r%256,i.push(f),i.push(n);return i}(e,t.length-r),t,r,n)}function E(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function m(t,e,r){r=Math.min(t.length,r);const n=[];let f=e;for(;f<r;){const e=t[f];let i=null,o=e>239?4:e>223?3:e>191?2:1;if(f+o<=r){let r,n,u,s;switch(o){case 1:e<128&&(i=e);break;case 2:r=t[f+1],128==(192&r)&&(s=(31&e)<<6|63&r,s>127&&(i=s));break;case 3:r=t[f+1],n=t[f+2],128==(192&r)&&128==(192&n)&&(s=(15&e)<<12|(63&r)<<6|63&n,s>2047&&(s<55296||s>57343)&&(i=s));break;case 4:r=t[f+1],n=t[f+2],u=t[f+3],128==(192&r)&&128==(192&n)&&128==(192&u)&&(s=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&u,s>65535&&s<1114112&&(i=s))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),f+=o}return function(t){const e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=4096));return r}(n)}Buffer.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==Buffer.prototype},Buffer.compare=function(t,e){if(t instanceof Uint8Array&&(t=Buffer.from(t,t.offset,t.byteLength)),e instanceof Uint8Array&&(e=Buffer.from(e,e.offset,e.byteLength)),!Buffer.isBuffer(t)||!Buffer.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let f=0,i=Math.min(r,n);f<i;++f)if(t[f]!==e[f]){r=t[f],n=e[f];break}return r<n?-1:n<r?1:0},Buffer.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Buffer.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;const n=Buffer.allocUnsafe(e);let f=0;for(r=0;r<t.length;++r){let e=t[r];if(e instanceof Uint8Array)f+e.length>n.length?(Buffer.isBuffer(e)||(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),e.copy(n,f)):Uint8Array.prototype.set.call(n,e,f);else{if(!Buffer.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,f)}f+=e.length}return n},Buffer.byteLength=a,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)l(this,e,e+1);return this},Buffer.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)l(this,e,e+3),l(this,e+1,e+2);return this},Buffer.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)l(this,e,e+7),l(this,e+1,e+6),l(this,e+2,e+5),l(this,e+3,e+4);return this},Buffer.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?m(this,0,t):c.apply(this,arguments)},Buffer.prototype.toLocaleString=Buffer.prototype.toString,Buffer.prototype.equals=function(t){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===Buffer.compare(this,t)},Buffer.prototype.inspect=function(){let t="";const e=config.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},Buffer.prototype[Symbol.for("nodejs.util.inspect.custom")]=Buffer.prototype.inspect,Buffer.prototype.compare=function(t,e,r,n,f){if(t instanceof Uint8Array&&(t=Buffer.from(t,t.offset,t.byteLength)),!Buffer.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===f&&(f=this.length),e<0||r>t.length||n<0||f>this.length)throw new RangeError("out of range index");if(n>=f&&e>=r)return 0;if(n>=f)return-1;if(e>=r)return 1;if(this===t)return 0;let i=(f>>>=0)-(n>>>=0),o=(r>>>=0)-(e>>>=0);const u=Math.min(i,o),s=this.slice(n,f),h=t.slice(e,r);for(let t=0;t<u;++t)if(s[t]!==h[t]){i=s[t],o=h[t];break}return i<o?-1:o<i?1:0},Buffer.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},Buffer.prototype.indexOf=function(t,e,r){return p(this,t,e,r,!0)},Buffer.prototype.lastIndexOf=function(t,e,r){return p(this,t,e,r,!1)},Buffer.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const f=this.length-e;if((void 0===r||r>f)&&(r=f),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let i=!1;for(;;)switch(n){case"hex":return y(this,t,e,r);case"utf8":case"utf-8":return B(this,t,e,r);case"ascii":case"latin1":case"binary":return w(this,t,e,r);case"base64":return d(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(t,e,r){let n="";r=Math.min(t.length,r);for(let f=e;f<r;++f)n+=String.fromCharCode(127&t[f]);return n}function U(t,e,r){let n="";r=Math.min(t.length,r);for(let f=e;f<r;++f)n+=String.fromCharCode(t[f]);return n}function A(t,e,r){const n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let f="";for(let n=e;n<r;++n)f+=G[t[n]];return f}function v(t,e,r){const n=t.slice(e,r);let f="";for(let t=0;t<n.length-1;t+=2)f+=String.fromCharCode(n[t]+256*n[t+1]);return f}function R(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function T(t,e,r,n,f,i){if(!Buffer.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>f||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function L(t,e,r,n,f){k(e,n,f,t,r,7);let i=Number(e&BigInt(4294967295));t[r++]=i,i>>=8,t[r++]=i,i>>=8,t[r++]=i,i>>=8,t[r++]=i;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,r}function O(t,e,r,n,f){k(e,n,f,t,r,7);let i=Number(e&BigInt(4294967295));t[r+7]=i,i>>=8,t[r+6]=i,i>>=8,t[r+5]=i,i>>=8,t[r+4]=i;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o>>=8,t[r+2]=o,o>>=8,t[r+1]=o,o>>=8,t[r]=o,r+8}function S(t,e,r,n,f,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function _(t,r,n,f,i){return r=+r,n>>>=0,i||S(t,0,n,4),e.write(t,r,n,f,23,4),n+4}function x(t,r,n,f,i){return r=+r,n>>>=0,i||S(t,0,n,8),e.write(t,r,n,f,52,8),n+8}Buffer.prototype.slice=function(t,e){const r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,Buffer.prototype),n},Buffer.prototype.readUintLE=Buffer.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||R(t,e,this.length);let n=this[t],f=1,i=0;for(;++i<e&&(f*=256);)n+=this[t+i]*f;return n},Buffer.prototype.readUintBE=Buffer.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||R(t,e,this.length);let n=this[t+--e],f=1;for(;e>0&&(f*=256);)n+=this[t+--e]*f;return n},Buffer.prototype.readUint8=Buffer.prototype.readUInt8=function(t,e){return t>>>=0,e||R(t,1,this.length),this[t]},Buffer.prototype.readUint16LE=Buffer.prototype.readUInt16LE=function(t,e){return t>>>=0,e||R(t,2,this.length),this[t]|this[t+1]<<8},Buffer.prototype.readUint16BE=Buffer.prototype.readUInt16BE=function(t,e){return t>>>=0,e||R(t,2,this.length),this[t]<<8|this[t+1]},Buffer.prototype.readUint32LE=Buffer.prototype.readUInt32LE=function(t,e){return t>>>=0,e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Buffer.prototype.readUint32BE=Buffer.prototype.readUInt32BE=function(t,e){return t>>>=0,e||R(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Buffer.prototype.readBigUInt64LE=function(t){P(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||M(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,f=this[++t]+256*this[++t]+65536*this[++t]+r*2**24;return BigInt(n)+(BigInt(f)<<BigInt(32))},Buffer.prototype.readBigUInt64BE=function(t){P(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||M(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],f=this[++t]*2**24+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(f)},Buffer.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||R(t,e,this.length);let n=this[t],f=1,i=0;for(;++i<e&&(f*=256);)n+=this[t+i]*f;return f*=128,n>=f&&(n-=Math.pow(2,8*e)),n},Buffer.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||R(t,e,this.length);let n=e,f=1,i=this[t+--n];for(;n>0&&(f*=256);)i+=this[t+--n]*f;return f*=128,i>=f&&(i-=Math.pow(2,8*e)),i},Buffer.prototype.readInt8=function(t,e){return t>>>=0,e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Buffer.prototype.readInt16LE=function(t,e){t>>>=0,e||R(t,2,this.length);const r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function(t,e){t>>>=0,e||R(t,2,this.length);const r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function(t,e){return t>>>=0,e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Buffer.prototype.readInt32BE=function(t,e){return t>>>=0,e||R(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Buffer.prototype.readBigInt64LE=function(t){P(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||M(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)},Buffer.prototype.readBigInt64BE=function(t){P(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||M(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+r)},Buffer.prototype.readFloatLE=function(t,r){return t>>>=0,r||R(t,4,this.length),e.read(this,t,!0,23,4)},Buffer.prototype.readFloatBE=function(t,r){return t>>>=0,r||R(t,4,this.length),e.read(this,t,!1,23,4)},Buffer.prototype.readDoubleLE=function(t,r){return t>>>=0,r||R(t,8,this.length),e.read(this,t,!0,52,8)},Buffer.prototype.readDoubleBE=function(t,r){return t>>>=0,r||R(t,8,this.length),e.read(this,t,!1,52,8)},Buffer.prototype.writeUintLE=Buffer.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){T(this,t,e,r,Math.pow(2,8*r)-1,0)}let f=1,i=0;for(this[e]=255&t;++i<r&&(f*=256);)this[e+i]=t/f&255;return e+r},Buffer.prototype.writeUintBE=Buffer.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){T(this,t,e,r,Math.pow(2,8*r)-1,0)}let f=r-1,i=1;for(this[e+f]=255&t;--f>=0&&(i*=256);)this[e+f]=t/i&255;return e+r},Buffer.prototype.writeUint8=Buffer.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,1,255,0),this[e]=255&t,e+1},Buffer.prototype.writeUint16LE=Buffer.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},Buffer.prototype.writeUint16BE=Buffer.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},Buffer.prototype.writeUint32LE=Buffer.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},Buffer.prototype.writeUint32BE=Buffer.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},Buffer.prototype.writeBigUInt64LE=function(t,e=0){return L(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))},Buffer.prototype.writeBigUInt64BE=function(t,e=0){return O(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))},Buffer.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);T(this,t,e,r,n-1,-n)}let f=0,i=1,o=0;for(this[e]=255&t;++f<r&&(i*=256);)t<0&&0===o&&0!==this[e+f-1]&&(o=1),this[e+f]=(t/i>>0)-o&255;return e+r},Buffer.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);T(this,t,e,r,n-1,-n)}let f=r-1,i=1,o=0;for(this[e+f]=255&t;--f>=0&&(i*=256);)t<0&&0===o&&0!==this[e+f+1]&&(o=1),this[e+f]=(t/i>>0)-o&255;return e+r},Buffer.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},Buffer.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},Buffer.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},Buffer.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},Buffer.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},Buffer.prototype.writeBigInt64LE=function(t,e=0){return L(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},Buffer.prototype.writeBigInt64BE=function(t,e=0){return O(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},Buffer.prototype.writeFloatLE=function(t,e,r){return _(this,t,e,!0,r)},Buffer.prototype.writeFloatBE=function(t,e,r){return _(this,t,e,!1,r)},Buffer.prototype.writeDoubleLE=function(t,e,r){return x(this,t,e,!0,r)},Buffer.prototype.writeDoubleBE=function(t,e,r){return x(this,t,e,!1,r)},Buffer.prototype.copy=function(t,e,r,n){if(!Buffer.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);const f=n-r;return this===t?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),f},Buffer.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;let f;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(f=e;f<r;++f)this[f]=t;else{const i=Buffer.isBuffer(t)?t:Buffer.from(t,n),o=i.length;if(0===o)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(f=0;f<r-e;++f)this[f+e]=i[f%o]}return this};const $={};function N(t,e,r){$[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function C(t){let e="",r=t.length;const n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function k(t,e,r,n,f,i){if(t>r||t<e){const n="bigint"==typeof e?"n":"";let f;throw f=i>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(i+1)}${n}`:`>= -(2${n} ** ${8*(i+1)-1}${n}) and < 2 ** ${8*(i+1)-1}${n}`:`>= ${e}${n} and <= ${r}${n}`,new $.ERR_OUT_OF_RANGE("value",f,t)}!function(t,e,r){P(e,"offset"),void 0!==t[e]&&void 0!==t[e+r]||M(e,t.length-(r+1))}(n,f,i)}function P(t,e){if("number"!=typeof t)throw new $.ERR_INVALID_ARG_TYPE(e,"number",t)}function M(t,e,r){if(Math.floor(t)!==t)throw P(t,r),new $.ERR_OUT_OF_RANGE(r||"offset","an integer",t);if(e<0)throw new $.ERR_BUFFER_OUT_OF_BOUNDS;throw new $.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}N("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),N("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),N("ERR_OUT_OF_RANGE",(function(t,e,r){let n=`The value of "${t}" is out of range.`,f=r;return Number.isInteger(r)&&Math.abs(r)>2**32?f=C(String(r)):"bigint"==typeof r&&(f=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(f=C(f)),f+="n"),n+=` It must be ${e}. Received ${f}`,n}),RangeError);const F=/[^+/0-9A-Za-z-_]/g;function j(t,e){let r;e=e||1/0;const n=t.length;let f=null;const i=[];for(let o=0;o<n;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!f){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&i.push(239,191,189);continue}f=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),f=r;continue}r=65536+(f-55296<<10|r-56320)}else f&&(e-=3)>-1&&i.push(239,191,189);if(f=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function z(e){return t.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(e))}function D(t,e,r,n){let f;for(f=0;f<n&&!(f+r>=e.length||f>=t.length);++f)e[f+r]=t[f];return f}const G=function(){const t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let f=0;f<16;++f)e[n+f]=t[r]+t[f]}return e}();export default{config,kMaxLength:2147483647,Buffer,SlowBuffer};
âœ„
{"version":3,"file":"index.js","names":["read","buffer","offset","isLE","mLen","nBytes","e","m","eLen","eMax","eBias","nBits","i","d","s","NaN","Infinity","Math","pow","write","value","c","rt","abs","isNaN","floor","log","LN2"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/@frida/ieee754/","sources":[""],"mappings":";OAEO,SAASA,KAAMC,EAAQC,EAAQC,EAAMC,EAAMC,GAChD,IAAIC,EAAGC,EACP,MAAMC,EAAiB,EAATH,EAAcD,EAAO,EAC7BK,GAAQ,GAAKD,GAAQ,EACrBE,EAAQD,GAAQ,EACtB,IAAIE,GAAS,EACTC,EAAIT,EAAQE,EAAS,EAAK,EAC9B,MAAMQ,EAAIV,GAAQ,EAAI,EACtB,IAAIW,EAAIb,EAAOC,EAASU,GAOxB,IALAA,GAAKC,EAELP,EAAIQ,GAAM,IAAOH,GAAU,EAC3BG,KAAQH,EACRA,GAASH,EACFG,EAAQ,GACbL,EAAS,IAAJA,EAAWL,EAAOC,EAASU,GAChCA,GAAKC,EACLF,GAAS,EAMX,IAHAJ,EAAID,GAAM,IAAOK,GAAU,EAC3BL,KAAQK,EACRA,GAASP,EACFO,EAAQ,GACbJ,EAAS,IAAJA,EAAWN,EAAOC,EAASU,GAChCA,GAAKC,EACLF,GAAS,EAGX,GAAU,IAANL,EACFA,EAAI,EAAII,MACH,IAAIJ,IAAMG,EACf,OAAOF,EAAIQ,IAAsBC,KAAdF,GAAK,EAAI,GAE5BP,GAAQU,KAAKC,IAAI,EAAGd,GACpBE,GAAQI,CACV,CACA,OAAQI,GAAK,EAAI,GAAKP,EAAIU,KAAKC,IAAI,EAAGZ,EAAIF,EAC5C,QAEO,SAASe,MAAOlB,EAAQmB,EAAOlB,EAAQC,EAAMC,EAAMC,GACxD,IAAIC,EAAGC,EAAGc,EACNb,EAAiB,EAATH,EAAcD,EAAO,EACjC,MAAMK,GAAQ,GAAKD,GAAQ,EACrBE,EAAQD,GAAQ,EAChBa,EAAe,KAATlB,EAAca,KAAKC,IAAI,GAAI,IAAMD,KAAKC,IAAI,GAAI,IAAM,EAChE,IAAIN,EAAIT,EAAO,EAAKE,EAAS,EAC7B,MAAMQ,EAAIV,EAAO,GAAK,EAChBW,EAAIM,EAAQ,GAAgB,IAAVA,GAAe,EAAIA,EAAQ,EAAK,EAAI,EAmC5D,IAjCAA,EAAQH,KAAKM,IAAIH,GAEbI,MAAMJ,IAAUA,IAAUJ,KAC5BT,EAAIiB,MAAMJ,GAAS,EAAI,EACvBd,EAAIG,IAEJH,EAAIW,KAAKQ,MAAMR,KAAKS,IAAIN,GAASH,KAAKU,KAClCP,GAASC,EAAIJ,KAAKC,IAAI,GAAIZ,IAAM,IAClCA,IACAe,GAAK,IAGLD,GADEd,EAAII,GAAS,EACNY,EAAKD,EAELC,EAAKL,KAAKC,IAAI,EAAG,EAAIR,IAEpBW,GAAK,IACff,IACAe,GAAK,GAGHf,EAAII,GAASD,GACfF,EAAI,EACJD,EAAIG,GACKH,EAAII,GAAS,GACtBH,GAAMa,EAAQC,EAAK,GAAKJ,KAAKC,IAAI,EAAGd,GACpCE,GAAQI,IAERH,EAAIa,EAAQH,KAAKC,IAAI,EAAGR,EAAQ,GAAKO,KAAKC,IAAI,EAAGd,GACjDE,EAAI,IAIDF,GAAQ,GACbH,EAAOC,EAASU,GAAS,IAAJL,EACrBK,GAAKC,EACLN,GAAK,IACLH,GAAQ,EAKV,IAFAE,EAAKA,GAAKF,EAAQG,EAClBC,GAAQJ,EACDI,EAAO,GACZP,EAAOC,EAASU,GAAS,IAAJN,EACrBM,GAAKC,EACLP,GAAK,IACLE,GAAQ,EAGVP,EAAOC,EAASU,EAAIC,IAAU,IAAJC,CAC5B","ignoreList":[]}
âœ„
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
export function read(t,o,a,e,h){let r,M;const p=8*h-e-1,n=(1<<p)-1,w=n>>1;let f=-7,l=a?h-1:0;const s=a?-1:1;let i=t[o+l];for(l+=s,r=i&(1<<-f)-1,i>>=-f,f+=p;f>0;)r=256*r+t[o+l],l+=s,f-=8;for(M=r&(1<<-f)-1,r>>=-f,f+=e;f>0;)M=256*M+t[o+l],l+=s,f-=8;if(0===r)r=1-w;else{if(r===n)return M?NaN:1/0*(i?-1:1);M+=Math.pow(2,e),r-=w}return(i?-1:1)*M*Math.pow(2,r-e)}export function write(t,o,a,e,h,r){let M,p,n,w=8*r-h-1;const f=(1<<w)-1,l=f>>1,s=23===h?Math.pow(2,-24)-Math.pow(2,-77):0;let i=e?0:r-1;const N=e?1:-1,c=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(p=isNaN(o)?1:0,M=f):(M=Math.floor(Math.log(o)/Math.LN2),o*(n=Math.pow(2,-M))<1&&(M--,n*=2),(o+=M+l>=1?s/n:s*Math.pow(2,1-l))*n>=2&&(M++,n/=2),M+l>=f?(p=0,M=f):M+l>=1?(p=(o*n-1)*Math.pow(2,h),M+=l):(p=o*Math.pow(2,l-1)*Math.pow(2,h),M=0));h>=8;)t[a+i]=255&p,i+=N,p/=256,h-=8;for(M=M<<h|p,w+=h;w>0;)t[a+i]=255&M,i+=N,M/=256,w-=8;t[a+i-N]|=128*c}
âœ„
{"version":3,"file":"index.js","names":["getApi","getAndroidVersion","withAllArtThreadsSuspended","withRunnableArtThread","makeArtClassVisitor","makeArtClassLoaderVisitor","backtrace","deoptimizeEverything","deoptimizeBootImage","deoptimizeMethod","ClassFactory","ClassModel","Env","initialize","VM","checkJniResult","pointerSize","Process","initFactoryFromApplication","factory","app","use","loader","getClassLoader","myUid","SYSTEM_UID","value","cacheDir","codeCacheDir","getCacheDir","getCanonicalPath","getCodeCacheDir","getFilesDir","initFactoryFromLoadedApk","apk","JFile","dataDir","$new","getDataDir","runtime","ACC_PUBLIC","ACC_PRIVATE","ACC_PROTECTED","ACC_STATIC","ACC_FINAL","ACC_SYNCHRONIZED","ACC_BRIDGE","ACC_VARARGS","ACC_NATIVE","ACC_ABSTRACT","ACC_STRICT","ACC_SYNTHETIC","constructor","this","classFactory","vm","api","_initialized","_apiError","_wakeupHandler","_pollListener","_pendingMainOps","_pendingVmOps","_cachedIsAppProcess","_tryInitialize","e","_initialize","_dispose","perform","env","_disposeAll","dispose","Script","nextTick","available","androidVersion","synchronized","obj","fn","$h","objHandle","NativePointer","Error","getEnv","monitorEnter","monitorExit","enumerateLoadedClasses","callbacks","_checkAvailable","flavor","_enumerateLoadedClassesJvm","_enumerateLoadedClassesArt","_enumerateLoadedClassesDalvik","enumerateLoadedClassesSync","classes","onMatch","c","push","onComplete","enumerateClassLoaders","_enumerateClassLoadersJvm","_enumerateClassLoadersArt","enumerateClassLoadersSync","loaders","jvmti","countPtr","Memory","alloc","classesPtr","getLoadedClasses","count","readS32","readPointer","handles","i","add","deallocate","handle","className","getClassName","forEach","deleteLocalRef","choose","addGlobalReference","vmHandle","thread","collectClassHandles","klass","deleteGlobalRef","artClassLinker","address","visitClassLoaders","undefined","ClassLoader","loaderHandles","collectLoaderHandles","cast","HASH_TOMBSTONE","ptr","hashTable","gDvm","tableSize","pEntries","end","offset","dataPtr","isNull","equals","description","readUtf8String","startsWith","name","substring","length","replace","enumerateMethods","query","map","group","wrap","scheduleOnMainThread","performNow","wakeupHandler","Handler","Looper","getMainLooper","Interceptor","attach","getModuleByName","getExportByName","_makePollHook","flush","sendEmptyMessage","mainThreadId","id","pending","threadId","shift","_isAppProcess","_performPendingVmOpsWhenReady","currentApplication","ActivityThread","_performPendingVmOps","initialized","hookpoint","handleBindApplication","implementation","data","instrumentationName","makeApplication","forceDefaultAppClass","instrumentation","apply","arguments","getPackageInfo","overloads","m","argumentTypes","sort","arityA","arityB","_","method","args","call","options","openClassFile","filePath","specifier","retain","C","array","type","elements","isMainThread","mainLooper","myLooper","$isSameObject","registerClass","spec","result","readlink","NativeFunction","Module","getGlobalExportByName","exceptions","pathname","allocUtf8String","bufferSize","buffer","size","toInt32","exe","test","bindWeak"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/","sources":[""],"mappings":"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","ignoreList":[]}
âœ„
import e from"./lib/api.js";import{getAndroidVersion as t,withAllArtThreadsSuspended as s,withRunnableArtThread as a,makeArtClassVisitor as r,makeArtClassLoaderVisitor as i,backtrace as o,deoptimizeEverything as n,deoptimizeBootImage as l,deoptimizeMethod as c}from"./lib/android.js";import h from"./lib/class-factory.js";import d from"./lib/class-model.js";import p from"./lib/env.js";import{initialize as m}from"./lib/types.js";import u from"./lib/vm.js";import{checkJniResult as C}from"./lib/result.js";const f=Process.pointerSize;function v(e,t){const s=e.use("android.os.Process");e.loader=t.getClassLoader(),s.myUid()===s.SYSTEM_UID.value?(e.cacheDir="/data/system",e.codeCacheDir="/data/dalvik-cache"):"getCodeCacheDir"in t?(e.cacheDir=t.getCacheDir().getCanonicalPath(),e.codeCacheDir=t.getCodeCacheDir().getCanonicalPath()):(e.cacheDir=t.getFilesDir().getCanonicalPath(),e.codeCacheDir=t.getCacheDir().getCanonicalPath())}function _(e,t){const s=e.use("java.io.File");e.loader=t.getClassLoader();const a=s.$new(t.getDataDir()).getCanonicalPath();e.cacheDir=a,e.codeCacheDir=a+"/cache"}const g=new class{ACC_PUBLIC=1;ACC_PRIVATE=2;ACC_PROTECTED=4;ACC_STATIC=8;ACC_FINAL=16;ACC_SYNCHRONIZED=32;ACC_BRIDGE=64;ACC_VARARGS=128;ACC_NATIVE=256;ACC_ABSTRACT=1024;ACC_STRICT=2048;ACC_SYNTHETIC=4096;constructor(){this.classFactory=null,this.ClassFactory=h,this.vm=null,this.api=null,this._initialized=!1,this._apiError=null,this._wakeupHandler=null,this._pollListener=null,this._pendingMainOps=[],this._pendingVmOps=[],this._cachedIsAppProcess=null;try{this._tryInitialize()}catch(e){}}_tryInitialize(){if(this._initialized)return!0;if(null!==this._apiError)throw this._apiError;let t;try{t=e(),this.api=t}catch(e){throw this._apiError=e,e}if(null===t)return!1;const s=new u(t);return this.vm=s,m(s),h._initialize(s,t),this.classFactory=new h,this._initialized=!0,!0}_dispose(){if(null===this.api)return;const{vm:e}=this;e.perform((e=>{h._disposeAll(e),p.dispose(e)})),Script.nextTick((()=>{u.dispose(e)}))}get available(){return this._tryInitialize()}get androidVersion(){return t()}synchronized(e,t){const{$h:s=e}=e;if(!(s instanceof NativePointer))throw new Error("Java.synchronized: the first argument `obj` must be either a pointer or a Java instance");const a=this.vm.getEnv();C("VM::MonitorEnter",a.monitorEnter(s));try{t()}finally{a.monitorExit(s)}}enumerateLoadedClasses(e){this._checkAvailable();const{flavor:t}=this.api;"jvm"===t?this._enumerateLoadedClassesJvm(e):"art"===t?this._enumerateLoadedClassesArt(e):this._enumerateLoadedClassesDalvik(e)}enumerateLoadedClassesSync(){const e=[];return this.enumerateLoadedClasses({onMatch(t){e.push(t)},onComplete(){}}),e}enumerateClassLoaders(e){this._checkAvailable();const{flavor:t}=this.api;if("jvm"===t)this._enumerateClassLoadersJvm(e);else{if("art"!==t)throw new Error("Enumerating class loaders is not supported on Dalvik");this._enumerateClassLoadersArt(e)}}enumerateClassLoadersSync(){const e=[];return this.enumerateClassLoaders({onMatch(t){e.push(t)},onComplete(){}}),e}_enumerateLoadedClassesJvm(e){const{api:t,vm:s}=this,{jvmti:a}=t,r=s.getEnv(),i=Memory.alloc(4),o=Memory.alloc(f);a.getLoadedClasses(i,o);const n=i.readS32(),l=o.readPointer(),c=[];for(let e=0;e!==n;e++)c.push(l.add(e*f).readPointer());a.deallocate(l);try{for(const t of c){const s=r.getClassName(t);e.onMatch(s,t)}e.onComplete()}finally{c.forEach((e=>{r.deleteLocalRef(e)}))}}_enumerateClassLoadersJvm(e){this.choose("java.lang.ClassLoader",e)}_enumerateLoadedClassesArt(e){const{vm:t,api:s}=this,i=t.getEnv(),o=s["art::JavaVMExt::AddGlobalRef"],{vm:n}=s;a(t,i,(t=>{const a=r((s=>{const a=o(n,t,s);try{const t=i.getClassName(a);e.onMatch(t,a)}finally{i.deleteGlobalRef(a)}return!0}));s["art::ClassLinker::VisitClasses"](s.artClassLinker.address,a)})),e.onComplete()}_enumerateClassLoadersArt(e){const{classFactory:t,vm:r,api:o}=this,n=r.getEnv(),l=o["art::ClassLinker::VisitClassLoaders"];if(void 0===l)throw new Error("This API is only available on Android >= 7.0");const c=t.use("java.lang.ClassLoader"),h=[],d=o["art::JavaVMExt::AddGlobalRef"],{vm:p}=o;a(r,n,(e=>{const t=i((t=>(h.push(d(p,e,t)),!0)));s((()=>{l(o.artClassLinker.address,t)}))}));try{h.forEach((s=>{const a=t.cast(s,c);e.onMatch(a)}))}finally{h.forEach((e=>{n.deleteGlobalRef(e)}))}e.onComplete()}_enumerateLoadedClassesDalvik(e){const{api:t}=this,s=ptr("0xcbcacccd"),a=t.gDvm.add(172).readPointer(),r=a.readS32(),i=a.add(12).readPointer(),o=8*r;for(let t=0;t<o;t+=8){const a=i.add(t).add(4).readPointer();if(a.isNull()||a.equals(s))continue;const r=a.add(24).readPointer().readUtf8String();if(r.startsWith("L")){const t=r.substring(1,r.length-1).replace(/\//g,".");e.onMatch(t)}}e.onComplete()}enumerateMethods(e){const{classFactory:t}=this,s=this.vm.getEnv(),a=t.use("java.lang.ClassLoader");return d.enumerateMethods(e,this.api,s).map((e=>{const r=e.loader;return e.loader=null!==r?t.wrap(r,a,s):null,e}))}scheduleOnMainThread(e){this.performNow((()=>{this._pendingMainOps.push(e);let{_wakeupHandler:t}=this;if(null===t){const{classFactory:e}=this,s=e.use("android.os.Handler"),a=e.use("android.os.Looper");t=s.$new(a.getMainLooper()),this._wakeupHandler=t}null===this._pollListener&&(this._pollListener=Interceptor.attach(Process.getModuleByName("libc.so").getExportByName("epoll_wait"),this._makePollHook()),Interceptor.flush()),t.sendEmptyMessage(1)}))}_makePollHook(){const e=Process.id,{_pendingMainOps:t}=this;return function(){if(this.threadId!==e)return;let s;for(;void 0!==(s=t.shift());)try{s()}catch(e){Script.nextTick((()=>{throw e}))}}}perform(e){if(this._checkAvailable(),this._isAppProcess()&&null===this.classFactory.loader)this._pendingVmOps.push(e),1===this._pendingVmOps.length&&this._performPendingVmOpsWhenReady();else try{this.vm.perform(e)}catch(e){Script.nextTick((()=>{throw e}))}}performNow(e){return this._checkAvailable(),this.vm.perform((()=>{const{classFactory:t}=this;if(this._isAppProcess()&&null===t.loader){const e=t.use("android.app.ActivityThread").currentApplication();null!==e&&v(t,e)}return e()}))}_performPendingVmOpsWhenReady(){this.vm.perform((()=>{const{classFactory:e}=this,t=e.use("android.app.ActivityThread"),s=t.currentApplication();if(null!==s)return v(e,s),void this._performPendingVmOps();const a=this;let r=!1,i="early";const o=t.handleBindApplication;o.implementation=function(t){if(null!==t.instrumentationName.value){i="late";const t=e.use("android.app.LoadedApk").makeApplication;t.implementation=function(s,i){return r||(r=!0,_(e,this),a._performPendingVmOps()),t.apply(this,arguments)}}o.apply(this,arguments)};const n=t.getPackageInfo.overloads.map((e=>[e.argumentTypes.length,e])).sort((([e],[t])=>t-e)).map((([e,t])=>t))[0];n.implementation=function(...t){const s=n.call(this,...t);return r||"early"!==i||(r=!0,_(e,s),a._performPendingVmOps()),s}}))}_performPendingVmOps(){const{vm:e,_pendingVmOps:t}=this;let s;for(;void 0!==(s=t.shift());)try{e.perform(s)}catch(e){Script.nextTick((()=>{throw e}))}}use(e,t){return this.classFactory.use(e,t)}openClassFile(e){return this.classFactory.openClassFile(e)}choose(e,t){this.classFactory.choose(e,t)}retain(e){return this.classFactory.retain(e)}cast(e,t){return this.classFactory.cast(e,t)}array(e,t){return this.classFactory.array(e,t)}backtrace(e){return o(this.vm,e)}isMainThread(){const e=this.classFactory.use("android.os.Looper"),t=e.getMainLooper(),s=e.myLooper();return null!==s&&t.$isSameObject(s)}registerClass(e){return this.classFactory.registerClass(e)}deoptimizeEverything(){const{vm:e}=this;return n(e,e.getEnv())}deoptimizeBootImage(){const{vm:e}=this;return l(e,e.getEnv())}deoptimizeMethod(e){const{vm:t}=this;return c(t,t.getEnv(),e)}_checkAvailable(){if(!this.available)throw new Error("Java API not available")}_isAppProcess(){let e=this._cachedIsAppProcess;if(null===e){if("jvm"===this.api.flavor)return e=!1,this._cachedIsAppProcess=e,e;const t=new NativeFunction(Module.getGlobalExportByName("readlink"),"pointer",["pointer","pointer","pointer"],{exceptions:"propagate"}),s=Memory.allocUtf8String("/proc/self/exe"),a=1024,r=Memory.alloc(a),i=t(s,r,ptr(a)).toInt32();if(-1!==i){const t=r.readUtf8String(i);e=/^\/system\/bin\/app_process/.test(t)}else e=!0;this._cachedIsAppProcess=e}return e}};Script.bindWeak(g,(()=>{g._dispose()}));export default g;
âœ„
{"version":3,"file":"alloc.js","names":["pageSize","pointerSize","Process","CodeAllocator","constructor","sliceSize","this","slicesPerPage","pages","free","allocateSlice","spec","alignment","anyLocation","undefined","near","anyAlignment","slice","pop","n","length","alignMask","ptr","i","satisfiesLocation","_isSliceNear","satisfiesAlignment","and","isNull","splice","_allocatePage","page","Memory","alloc","add","push","sliceEnd","maxDistance","startDistance","abs","sub","endDistance","compare","freeSlice","nptr","shmt","mask","shl","not","makeAllocator"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"AAAA,MAAMA,SACJA,EAAQC,YACRA,GACEC,QAEJ,MAAMC,EACJC,YAAaC,GACXC,KAAKD,UAAYA,EACjBC,KAAKC,cAAgBP,EAAWK,EAEhCC,KAAKE,MAAQ,GACbF,KAAKG,KAAO,EACd,CAEAC,cAAeC,EAAMC,GACnB,MAAMC,OAA4BC,IAAdH,EAAKI,KACnBC,EAA6B,IAAdJ,EACrB,GAAIC,GAAeG,EAAc,CAC/B,MAAMC,EAAQX,KAAKG,KAAKS,MACxB,QAAcJ,IAAVG,EACF,OAAOA,CAEX,MAAO,GAAIL,EAAYZ,EAAU,CAC/B,MAAMS,KAAEA,GAASH,KACXa,EAAIV,EAAKW,OACTC,EAAYL,EAAe,KAAOM,IAAIV,EAAY,GACxD,IAAK,IAAIW,EAAI,EAAGA,IAAMJ,EAAGI,IAAK,CAC5B,MAAMN,EAAQR,EAAKc,GAEbC,EAAoBX,GAAeP,KAAKmB,aAAaR,EAAON,GAC5De,EAAqBV,GAAgBC,EAAMU,IAAIN,GAAWO,SAEhE,GAAIJ,GAAqBE,EACvB,OAAOjB,EAAKoB,OAAON,EAAG,GAAG,EAE7B,CACF,CAEA,OAAOjB,KAAKwB,cAAcnB,EAC5B,CAEAmB,cAAenB,GACb,MAAMoB,EAAOC,OAAOC,MAAMjC,EAAUW,IAE9BN,UAAEA,EAASE,cAAEA,GAAkBD,KAErC,IAAK,IAAIiB,EAAI,EAAGA,IAAMhB,EAAegB,IAAK,CACxC,MAAMN,EAAQc,EAAKG,IAAIX,EAAIlB,GAC3BC,KAAKG,KAAK0B,KAAKlB,EACjB,CAIA,OAFAX,KAAKE,MAAM2B,KAAKJ,GAETA,CACT,CAEAN,aAAcR,EAAON,GACnB,MAAMyB,EAAWnB,EAAMiB,IAAI5B,KAAKD,YAE1BU,KAAEA,EAAIsB,YAAEA,GAAgB1B,EAExB2B,EAAgBC,EAAIxB,EAAKyB,IAAIvB,IAC7BwB,EAAcF,EAAIxB,EAAKyB,IAAIJ,IAEjC,OAAOE,EAAcI,QAAQL,IAAgB,GACzCI,EAAYC,QAAQL,IAAgB,CAC1C,CAEAM,UAAW1B,GACTX,KAAKG,KAAK0B,KAAKlB,EACjB,EAGF,SAASsB,EAAKK,GACZ,MAAMC,EAAwB,IAAhB5C,EAAqB,GAAK,GAClC6C,EAAOxB,IAAI,GAAGyB,IAAIF,GAAMG,MAC9B,OAAOJ,EAAKjB,IAAImB,EAClB,gBAEe,SAASG,EAAe5C,GACrC,OAAO,IAAIF,EAAcE,EAC3B","ignoreList":[]}
âœ„
const{pageSize:e,pointerSize:s}=Process;class t{constructor(s){this.sliceSize=s,this.slicesPerPage=e/s,this.pages=[],this.free=[]}allocateSlice(s,t){const i=void 0===s.near,r=1===t;if(i&&r){const e=this.free.pop();if(void 0!==e)return e}else if(t<e){const{free:e}=this,c=e.length,n=r?null:ptr(t-1);for(let t=0;t!==c;t++){const c=e[t],l=i||this._isSliceNear(c,s),o=r||c.and(n).isNull();if(l&&o)return e.splice(t,1)[0]}}return this._allocatePage(s)}_allocatePage(s){const t=Memory.alloc(e,s),{sliceSize:i,slicesPerPage:r}=this;for(let e=1;e!==r;e++){const s=t.add(e*i);this.free.push(s)}return this.pages.push(t),t}_isSliceNear(e,s){const t=e.add(this.sliceSize),{near:r,maxDistance:c}=s,n=i(r.sub(e)),l=i(r.sub(t));return n.compare(c)<=0&&l.compare(c)<=0}freeSlice(e){this.free.push(e)}}function i(e){const t=4===s?31:63,i=ptr(1).shl(t).not();return e.and(i)}export default function r(e){return new t(e)}
âœ„
{"version":3,"file":"android.js","names":["makeCodeAllocator","jvmtiVersion","jvmtiCapabilities","EnvJvmti","parseInstructionsAt","memoize","checkJniResult","JNI_OK","VM","pointerSize","Process","readU32","readPointer","writeU32","writePointer","NativePointer","prototype","THUMB_BIT_REMOVAL_MASK","ptr","not","ENV_VTABLE_OFFSET_EXCEPTION_CLEAR","ENV_VTABLE_OFFSET_FATAL_ERROR","DVM_JNI_ENV_OFFSET_SELF","STD_STRING_SIZE","STD_VECTOR_SIZE","getArtRuntimeSpec","api","vm","runtime","artRuntime","startOffset","endOffset","apiLevel","getAndroidApiLevel","codename","getAndroidCodename","isApiLevel34OrApexEquivalent","spec","offset","add","equals","classLinkerOffsets","jniIdManagerOffset","classLinkerOffset","internTableOffset","threadListOffset","heapOffset","candidate","heap","threadList","internTable","classLinker","jniIdManager","tryGetArtClassLinkerSpec","Error","instrumentationIsPointer","getArtApexVersion","instrumentation","impl","undefined","instrumentationPointerParser","arch","limit","tryDetectInstrumentationPointer","instrumentationOffsetParsers","tryDetectInstrumentationOffset","jniIdsIndirection","find","jniIdsIndirectionOffsetParsers","tryDetectJniIdsIndirectionOffset","getArtInstrumentationSpec","deoptEnabledOffset","forcedInterpretOnly","deoptimizationEnabled","getArtMethodSpec","getApi","perform","env","process","findClass","getElapsedCpuTime","unwrapMethodId","getStaticMethodId","deleteLocalRef","runtimeModule","getModuleByName","runtimeStart","base","runtimeEnd","size","entrypointFieldSize","jniCodeOffset","accessFlagsOffset","remaining","field","address","compare","kAccPublic","quickCodeOffset","jniCode","quickCode","accessFlags","interpreterCode","getArtThreadSpec","threadHandle","getArtThreadFromEnv","envHandle","handle","isExceptionReportedOffset","exceptionOffset","throwLocationOffset","topHandleScopeOffset","managedStackOffset","selfOffset","isExceptionReportedToInstrumentation","exception","throwLocation","topHandleScope","managedStack","self","getArtManagedStackSpec","topQuickFrame","link","getArtThreadStateTransitionImpl","callback","NativeCallback","onThreadStateTransitionComplete","makeArtThreadStateTransitionImpl","getAndroidVersion","getAndroidSystemProperty","parseInt","mountInfo","File","readAllText","artSource","sourceVersions","Map","line","trimEnd","split","elements","mountRoot","startsWith","mountSource","includes","set","strVersion","get","computeArtApexVersionFromApiLevel","getArtQuickFrameInfoGetterThunk","thunk","NULL","makeThunk","writer","putMovRegRegOffsetPtr","putCallAddressWithArguments","putMovRegReg","putPopReg","putRet","putPushReg","putMovRegPtrReg","putMovRegOffsetPtrReg","putPopRegs","putPushRegReg","putPopRegReg","putStrRegRegOffset","NativeFunction","nativeFunctionOptions","makeCxxMethodWrapperReturningPointerByValue","argTypes","concat","resultPtr","Memory","alloc","arguments","exceptions","artThreadStateTransitions","cachedApi","cachedArtClassLinkerSpec","MethodMangler","artController","inlineHooks","patchedClasses","artQuickInterceptors","thunkPage","thunkOffset","taughtArtAboutReplacementMethods","taughtArtAboutMethodInstrumentation","backtraceModule","jdwpSessions","socketpair","trampolineAllocator","vmModules","enumerateModules","filter","m","test","name","path","length","vmModule","flavor","indexOf","isArt","temporaryApi","module","this","findExportByName","findSymbolByName","addLocalReference","pending","functions","JNI_GetCreatedJavaVMs","artInterpreterToCompiledCodeBridge","_ZN3art9JavaVMExt12AddGlobalRefEPNS_6ThreadENS_6ObjPtrINS_6mirror6ObjectEEE","_ZN3art9JavaVMExt12AddGlobalRefEPNS_6ThreadEPNS_6mirror6ObjectE","_ZN3art17ReaderWriterMutex13ExclusiveLockEPNS_6ThreadE","_ZN3art17ReaderWriterMutex15ExclusiveUnlockEPNS_6ThreadE","_ZN3art22IndirectReferenceTable3AddEjPNS_6mirror6ObjectE","_ZN3art22IndirectReferenceTable3AddENS_15IRTSegmentStateENS_6ObjPtrINS_6mirror6ObjectEEE","_ZN3art9JavaVMExt12DecodeGlobalEPv","decodeGlobal","thread","ref","_ZN3art9JavaVMExt12DecodeGlobalEPNS_6ThreadEPv","_ZNK3art6Thread19DecodeGlobalJObjectEP8_jobject","_ZNK3art6Thread13DecodeJObjectEP8_jobject","_ZN3art10ThreadList10SuspendAllEPKcb","_ZN3art10ThreadList10SuspendAllEv","suspendAll","cause","longSuspend","_ZN3art10ThreadList9ResumeAllEv","_ZN3art11ClassLinker12VisitClassesEPNS_12ClassVisitorE","_ZN3art11ClassLinker12VisitClassesEPFbPNS_6mirror5ClassEPvES4_","visitClasses","visitor","_ZNK3art11ClassLinker17VisitClassLoadersEPNS_18ClassLoaderVisitorE","_ZN3art2gc4Heap12VisitObjectsEPFvPNS_6mirror6ObjectEPvES5_","_ZN3art2gc4Heap12GetInstancesERNS_24VariableSizedHandleScopeENS_6HandleINS_6mirror5ClassEEEiRNSt3__16vectorINS4_INS5_6ObjectEEENS8_9allocatorISB_EEEE","_ZN3art2gc4Heap12GetInstancesERNS_24VariableSizedHandleScopeENS_6HandleINS_6mirror5ClassEEEbiRNSt3__16vectorINS4_INS5_6ObjectEEENS8_9allocatorISB_EEEE","getInstances","instance","scope","hClass","maxCount","instances","_ZN3art12StackVisitorC2EPNS_6ThreadEPNS_7ContextENS0_13StackWalkKindEjb","_ZN3art12StackVisitorC2EPNS_6ThreadEPNS_7ContextENS0_13StackWalkKindEmb","_ZN3art12StackVisitor9WalkStackILNS0_16CountTransitionsE0EEEvb","_ZNK3art12StackVisitor9GetMethodEv","_ZNK3art12StackVisitor16DescribeLocationEv","makeCxxMethodWrapperReturningStdStringByValue","_ZNK3art12StackVisitor24GetCurrentQuickFrameInfoEv","result","frameSizeInBytes","coreSpillMask","fpSpillMask","_ZN3art7Context6CreateEv","_ZN3art6Thread18GetLongJumpContextEv","_ZN3art6mirror5Class13GetDescriptorEPNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE","_ZN3art6mirror5Class11GetLocationEv","_ZN3art9ArtMethod12PrettyMethodEb","_ZN3art12PrettyMethodEPNS_9ArtMethodEb","_ZN3art6Thread14CurrentFromGdbEv","_ZN3art6mirror6Object5CloneEPNS_6ThreadE","_ZN3art6mirror6Object5CloneEPNS_6ThreadEm","clone","thisPtr","threadPtr","numTargetBytes","_ZN3art6mirror6Object5CloneEPNS_6ThreadEj","_ZN3art3Dbg14SetJdwpAllowedEb","_ZN3art3Dbg13ConfigureJdwpERKNS_4JDWP11JdwpOptionsE","_ZN3art31InternalDebuggerControlCallback13StartDebuggerEv","_ZN3art3Dbg9StartJdwpEv","_ZN3art3Dbg8GoActiveEv","_ZN3art3Dbg21RequestDeoptimizationERKNS_21DeoptimizationRequestE","_ZN3art3Dbg20ManageDeoptimizationEv","_ZN3art15instrumentation15Instrumentation20EnableDeoptimizationEv","_ZN3art15instrumentation15Instrumentation20DeoptimizeEverythingEPKc","_ZN3art15instrumentation15Instrumentation20DeoptimizeEverythingEv","deoptimize","key","_ZN3art7Runtime19DeoptimizeBootImageEv","_ZN3art15instrumentation15Instrumentation10DeoptimizeEPNS_9ArtMethodE","_ZN3art3jni12JniIdManager14DecodeMethodIdEP10_jmethodID","_ZN3art3jni12JniIdManager13DecodeFieldIdEP9_jfieldID","_ZN3art11interpreter18GetNterpEntryPointEv","_ZN3art7Monitor17TranslateLocationEPNS_9ArtMethodEjPPKcPi","variables","_ZN3art3Dbg9gRegistryE","isJdwpStarted","isNull","_ZN3art3Dbg15gDebuggerActiveE","isDebuggerActive","readU8","optionals","Set","_Z20dvmDecodeIndirectRefP6ThreadP8_jobject","_Z15dvmUseJNIBridgeP6MethodPv","_Z20dvmHeapSourceGetBasev","_Z21dvmHeapSourceGetLimitv","_Z16dvmIsValidObjectPK6Object","gDvmJni","gDvm","missing","signature","Object","entries","call","has","push","handler","join","vms","vmCount","readInt","kAccCompileDontBother","runtimeSpec","runtimeOffset","instrumentationOffset","artInstrumentation","artHeap","artThreadList","getArtClassLinkerSpec","quickResolutionTrampoline","quickImtConflictTrampoline","quickGenericJniTrampoline","quickToInterpreterBridgeTrampoline","artClassLinker","artQuickGenericJniTrampoline","getArtQuickEntrypointFromTrampoline","artQuickToInterpreterBridge","artQuickResolutionTrampoline","globalsLock","globals","lock","table","acquire","release","IRT_FIRST_SEGMENT","obj","makeAddGlobalRefFallbackForAndroid5","decode","makeDecodeGlobalFallback","artNterpEntryPoint","threadOffsets","managedStackOffsets","code","lockSize","methodsSize","replacementsSize","lastSeenArtMethodSize","methods","replacements","lastSeenArtMethod","getOatQuickMethodHeaderImpl","cm","CModule","last_seen_art_method","get_oat_quick_method_header_impl","fastOptions","scheduling","replacedMethods","isReplacement","is_replacement_method","get_replacement_method","set_replacement_method","synchronize","synchronize_replacement_methods","delete","delete_replacement_method","translate","translate_method","findReplacementFromQuickCode","find_replacement_method_from_quick_code","hooks","Interpreter","doCall","on_interpreter_do_call","ArtMethod","getOatQuickMethodHeader","on_art_method_get_oat_quick_method_header","prettyMethod","on_art_method_pretty_method","Gc","copyingPhase","onLeave","on_leave_gc_concurrent_copying_copying_phase","runFlip","onEnter","makeArtController","Interceptor","attach","flush","fixupArtQuickDeliverExceptionBug","cachedJvmti","defineProperty","tryGetEnvJvmti","cxxImports","enumerateImports","imp","reduce","$new","_Znwm","_Znwj","$delete","_ZdlPv","ArtMethodMangler","DalvikMethodMangler","_getApi","ensurePluginLoadedAddr","ensurePluginLoaded","errorPtr","allocUtf8String","kArtTiVersion","v1_2","tryGetEnvHandle","capaBuf","writeU64","canTagObjects","addCapabilities","ensureClassInitialized","classRef","getClassName","ia32","parsex86InstrumentationOffset","x64","arm","insn","mnemonic","ops","operands","op2","type","value","arm64","valueOf","disp","parsex86InstrumentationPointer","mem","src","parsex86JniIdsIndirectionOffset","prevInsn","prevMnemonic","delta","quickGenericJniTrampolineOffset","quickResolutionTrampolineOffset","getArtClassSpec","fieldSpec","getArtFieldSpec","methodSpec","fInfo","artArrayLengthSize","artArrayEntrySize","artArrayMax","mInfo","readArtArray","objectBase","fieldOffset","lengthSize","header","readU64","data","hasEntry","needle","info","artArray","artArrayEnd","Math","min","i","clazz","clazzRef","newGlobalRef","object","withRunnableArtThread","fieldInstance","unwrapFieldId","getFieldId","fieldStatic","getStaticFieldId","offsetStatic","offsetInstance","sfieldOffset","ifieldOffset","offsetMethods","methodInstance","getMethodId","offsetCopiedMethods","methodsArraySize","readU16","ifields","sfields","copiedMethodsOffset","deleteGlobalRef","artQuickTrampolineParsers","parseArtQuickTrampolineX86","trampoline","tryParse","Instruction","parse","systemPropertyGet","getExportByName","buf","readUtf8String","fn","id","toString","withAllArtThreadsSuspended","ArtClassVisitor","constructor","visit","vtable","onVisit","klass","_onVisit","makeArtClassVisitor","ArtClassLoaderVisitor","makeArtClassLoaderVisitor","WalkKind","ArtStackVisitor","context","walkKind","numFrames","checkSuspended","vtableSize","onVisitFrame","_visitFrame","bind","_onVisitFrame","curShadowFrame","_curShadowFrame","_curQuickFrame","_curQuickFramePc","_curOatQuickMethodHeader","_getMethodImpl","_descLocImpl","_getCQFIImpl","walkStack","includeTransitions","visitFrame","getMethod","methodHandle","getCurrentQuickFramePc","getCurrentQuickFrame","getCurrentShadowFrame","describeLocation","StdString","disposeToString","getCurrentOatQuickMethodHeader","getCurrentQuickFrameInfo","withSignature","thunkRelocators","globalThis","X86Relocator","ThumbRelocator","Arm64Relocator","thunkWriters","X86Writer","ThumbWriter","Arm64Writer","write","pageSize","Writer","patchCode","pc","or","notifyArtMethodHooked","method","forEach","entrypoint","protect","interceptor","ArtQuickCodeInterceptor","activate","instrumentArtQuickEntrypoints","artInterpreterDoCallExportRegex","art","enumerateExports","enumerateSymbols","entry","instrumentArtMethodInvocationFromInterpreter","gc","instrumentArtGarbageCollection","patterns","pattern","matches","scanSync","instrumentArtFixupStaticTrampolines","ensureArtKnowsHowToHandleMethodInstrumentation","artGetOatQuickMethodHeaderInlinedCopyHandler","signatures","map","validateMatch","returnEmptyObject","MatchPattern","impls","enumerateRanges","sub","match","validationResult","instrument","maybeInstrumentGetOatQuickMethodHeaderInlineCopies","replace","e","ensureArtKnowsHowToHandleReplacementMethods","validateGetOatQuickMethodHeaderInlinedMatchArm","methodReg","target","redirectCapacity","relocator","readOne","writeAll","skipOne","putBCondLabel","putBytes","savedRegs","putPushRegs","putCmpRegImm","putBLabel","tailIsRegular","input","whenRegularMethod","putLabel","writeOne","putBranchAddress","whenTrue","InlineHook","putLdrRegAddress","validateGetOatQuickMethodHeaderInlinedMatchArm64","scratchReg","numSavedRegs","putCmpRegReg","tailInstruction","next","putBrReg","ldr","ldrDst","ldrSrc","branch","targetWhenTrue","targetWhenFalse","targetWhenRegularMethod","targetWhenRuntimeMethod","whenRuntimeMethod","substring","originalCode","readByteArray","revert","writeByteArray","makeMethodMangler","methodId","translateMethod","backtrace","options","getEnv","performImpl","current_backtrace","perform_art_thread_state_transition","art_make_context","art_stack_visitor_init","art_stack_visitor_walk_stack","art_stack_visitor_get_method","art_stack_visitor_describe_location","translate_location","get_class_location","cxx_delete","strtoul","_create","_destroy","_getId","_get_id","_getFrames","_get_frames","performThreadStateTransition","_on_thread_state_transition_complete","destroy","_performData","bt","Backtrace","Script","bindWeak","getId","getFrames","JSON","makeBacktraceModule","frames","revertGlobalPatches","vtablePtr","vtableCountPtr","writeS32","vtableCount","clear","splice","deactivate","hook","unwrapGenericId","fieldId","genericId","apiMethod","jniIdsIndirectionOffset","artQuickCodeReplacementTrampolineWriters","redirectSize","constraints","artMethodOffsets","putPushax","putAndRegU32","putSubRegImm","putMovRegFsU32Ptr","putCallAddressWithAlignedArguments","putTestRegReg","putJccShortLabel","putPopax","eoi","putJmpAddress","putJmpRegOffsetPtr","putMovRegGsU32Ptr","targetAddress","and","putSubRegRegImm","putLdrRegRegOffset","putAddRegRegImm","availableScratchRegs","Array","from","artQuickCodePrologueWriters","writeArtQuickCodePrologueX86","putAdrpRegAddress","artQuickCodeHookRedirectSize","quickCodeAddress","overwrittenPrologue","overwrittenPrologueLength","_canRelocateCode","relocationSize","Relocator","nextOffset","nextScratchRegs","read","written","regsAccessed","regs","reg","_allocateTrampoline","maxRedirectSize","alignment","maxDistance","near","allocateSlice","_destroyTrampoline","freeSlice","prologueLength","writeTrampoline","dup","writePrologue","opaqueMethodId","originalMethod","hookedMethodId","replacementMethodId","isInstanceMethod","fetchArtMethod","originalFlags","hookInfo","cloneArtMethod","patchArtMethod","hookedMethodRemovedFlags","kAccFastInterpreterToInterpreterInvoke","isArtQuickEntrypoint","resolveTarget","wrapper","artMethodOffset","original","patches","keys","argsSize","acc","t","registersSize","insSize","writeU16","shorty","readCString","returnType","hints","ch","computeDalvikJniArgInfo","dvmUseJNIBridge","copy","objectPtr","classObject","dvmDecodeIndirectRef","$h","h","$borrowClassHandle","unref","classKey","readS32","shadowVtable","shadowVtableCount","targetMethods","methodKey","targetMethod","methodIndex","deoptimizeMethod","requestDeoptimization","deoptimizeEverything","deoptimizeBootImage","kind","session","JdwpSession","kJdwpTransportAndroidAdb","transport","server","suspend","port","writeU8","makeJdwpOptions","startDebugger","startJdwp","request","enableDeopt","libart","acceptImpl","receiveClientFdImpl","controlPair","makeSocketPair","clientPair","_controlFd","_clientFd","acceptListener","args","state","detach","_handshakeRequest","_performHandshake","async","UnixInputStream","autoClose","output","UnixOutputStream","handshakePacket","readAll","threadStateTransitionRecompilers","recompileExceptionClearForX86","buffer","exceptionClearImpl","nextFuncImpl","neuteredOffsets","blocks","branchTargets","thumbBitRemovalMask","current","shift","alreadyCovered","values","some","begin","end","blockId","thumbBit","block","lastInsn","reachedEndOfBlock","ifThenBlockRemaining","insnId","existingBlock","isOutsideIfThenBlock","branchTarget","op","sort","a","b","blocksOrdered","entryBlock","unshift","foundCore","threadReg","realImplReg","insnAddressId","keep","branchLabelFromOperand","putBCondLabelWide","substr","putCbzRegLabel","putCbnzRegLabel","dstValue","dstOffset","nzcvqReg","clobberedRegs","putMrsRegReg","putMsrRegReg","dstOp","srcOp","dispose","throwThreadStateTransitionParseError","blockAddressKey","invokeCallback","putPushAllXRegisters","putPopAllXRegisters","toInt32","putTbzRegImmLabel","putTbnzRegImmLabel","srcReg","putBlImm","envVtable","innerExceptionClearImpl","innerNextFuncImpl","recompile","isReportedOffset","throwLocationStartOffset","_code","_callback","putJmpNearLabel","putJccNearLabel","dst","putPushfx","putMovRegU64","uint64","putAndRegReg","putPopfx","argCount","argvSize","putCallAddress","putAddRegImm","invokeThunk","isTiny","_getData","str","HandleVector","storage","elementSize","_begin","_end","_storage","_elementSize","init","static","vector","super","handles","cur","BHS_OFFSET_NUM_REFS","BHS_SIZE","BaseHandleScope","_link","_numberOfReferences","numberOfReferences","VSHS_OFFSET_SELF","remainder","alignPointerOffset","VSHS_OFFSET_CURRENT_SCOPE","VSHS_SIZE","VariableSizedHandleScope","_self","_currentScope","kNumReferencesPerScope","_scopeLayout","FixedSizeHandleScope","layoutForCapacity","_topHandleScopePtr","topHandleScopePtr","currentScope","newHandle","layout","_refsStorage","refsStorage","_pos","pos","_layout","numRefs","objectVisitorPredicateFactories","onMatch","predicate","onMatchCallback","_onMatchCallback","instructions","needleOffset","onMatchOffset","codeSize","instruction","index","makeObjectVisitorPredicate","makeGenericObjectVisitorPredicate"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"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","ignoreList":[]}
âœ„
import e from"./alloc.js";import{jvmtiVersion as t,jvmtiCapabilities as n,EnvJvmti as r}from"./jvmti.js";import{parseInstructionsAt as o}from"./machine-code.js";import a from"./memoize.js";import{checkJniResult as i,JNI_OK as s}from"./result.js";import c from"./vm.js";const d=Process.pointerSize,{readU32:l,readPointer:u,writeU32:p,writePointer:_}=NativePointer.prototype,m=ptr(1).not(),h=17*d,g=18*d;export const DVM_JNI_ENV_OFFSET_SELF=12;const f=3*d,b=3*d,v=a((function(e){const t=e.vm,n=e.artRuntime,r=4===d?200:384,a=r+100*d,i=getAndroidApiLevel(),s=N(),{isApiLevel34OrApexEquivalent:c}=e;let l=null;for(let e=r;e!==a;e+=d){if(n.add(e).readPointer().equals(t)){let t,r=null;i>=33||"Tiramisu"===s||c?(t=[e-4*d],r=e-d):i>=30||"R"===s?(t=[e-3*d,e-4*d],r=e-d):t=i>=29?[e-2*d]:i>=27?[e-f-3*d]:[e-f-2*d];for(const e of t){const t=e-d,o=t-d;let a;a=c?o-9*d:i>=24?o-8*d:i>=23?o-7*d:o-4*d;const s={offset:{heap:a,threadList:o,internTable:t,classLinker:e,jniIdManager:r}};if(null!==Q(n,s)){l=s;break}}break}}if(null===l)throw new Error("Unable to determine Runtime field offsets");const u=getArtApexVersion()>=36e7;return l.offset.instrumentation=u?function(e){const t=e["art::Runtime::DeoptimizeBootImage"];if(void 0===t)return null;return o(t,q[Process.arch],{limit:30})}(e):function(e){const t=e["art::Runtime::DeoptimizeBootImage"];if(void 0===t)return null;return o(t,G[Process.arch],{limit:30})}(e),l.offset.jniIdsIndirection=function(e){const t=e.find("_ZN3art7Runtime12SetJniIdTypeENS_9JniIdTypeE");if(null===t)return null;const n=o(t,H[Process.arch],{limit:20});if(null===n)throw new Error("Unable to determine Runtime.jni_ids_indirection_ offset");return n}(e),l})),k=a((function(){const e={"4-21":136,"4-22":136,"4-23":172,"4-24":196,"4-25":196,"4-26":196,"4-27":196,"4-28":212,"4-29":172,"4-30":180,"4-31":180,"8-21":224,"8-22":224,"8-23":296,"8-24":344,"8-25":344,"8-26":352,"8-27":352,"8-28":392,"8-29":328,"8-30":336,"8-31":336}[`${d}-${getAndroidApiLevel()}`];if(void 0===e)throw new Error("Unable to determine Instrumentation field offsets");return{offset:{forcedInterpretOnly:4,deoptimizationEnabled:e}}}));export const getArtMethodSpec=a((function(e){const t=getApi();let n;return e.perform((e=>{const r=e.findClass("android/os/Process"),o=fe(e.getStaticMethodId(r,"getElapsedCpuTime","()J"));e.deleteLocalRef(r);const a=Process.getModuleByName("libandroid_runtime.so"),i=a.base,s=i.add(a.size),c=getAndroidApiLevel(),l=c<=21?8:d;let u=null,p=null,_=2;for(let e=0;64!==e&&0!==_;e+=4){const t=o.add(e);if(null===u){const n=t.readPointer();n.compare(i)>=0&&n.compare(s)<0&&(u=e,_--)}if(null===p){281==(2950692863&t.readU32())&&(p=e,_--)}}if(0!==_)throw new Error("Unable to determine ArtMethod field offsets");const m=u+l;n={size:c<=21?m+32:m+d,offset:{jniCode:u,quickCode:m,accessFlags:p}},"artInterpreterToCompiledCodeBridge"in t&&(n.offset.interpreterCode=u-l)})),n}));export const getArtThreadSpec=a((function(e){const t=getAndroidApiLevel();let n;return e.perform((e=>{const r=getArtThreadFromEnv(e),o=e.handle;let a=null,i=null,s=null,c=null,l=null,u=null;for(let e=144;256!==e;e+=d){if(r.add(e).readPointer().equals(o)){i=e-6*d,l=e-4*d,u=e+2*d,t<=22&&(i-=d,a=i-d-72-12,s=e+6*d,l-=d,u-=d),c=e+9*d,t<=22&&(c+=2*d+4,8===d&&(c+=4)),t>=23&&(c+=d);break}}if(null===c)throw new Error("Unable to determine ArtThread field offsets");n={offset:{isExceptionReportedToInstrumentation:a,exception:i,throwLocation:s,topHandleScope:c,managedStack:l,self:u}}})),n}));const S=a((function(){return getAndroidApiLevel()>=23?{offset:{topQuickFrame:0,link:d}}:{offset:{topQuickFrame:2*d,link:0}}})),E=a((function(e,t){const n=new NativeCallback(re,"void",["pointer"]);return Le(e,t,n)}));export const getAndroidVersion=a((function(){return ne("ro.build.version.release")}));const N=a((function(){return ne("ro.build.version.codename")}));export const getAndroidApiLevel=a((function(){return parseInt(ne("ro.build.version.sdk"),10)}));export const getArtApexVersion=a((function(){try{const e=File.readAllText("/proc/self/mountinfo");let t=null;const n=new Map;for(const r of e.trimEnd().split("\n")){const e=r.split(" "),o=e[4];if(!o.startsWith("/apex/com.android.art"))continue;const a=e[10];o.includes("@")?n.set(a,o.split("@")[1]):t=a}const r=n.get(t);return void 0!==r?parseInt(r):ee()}catch{return ee()}}));const A=a((function(e){let t=NULL;switch(Process.arch){case"ia32":t=de(32,(t=>{t.putMovRegRegOffsetPtr("ecx","esp",4),t.putMovRegRegOffsetPtr("edx","esp",8),t.putCallAddressWithArguments(e,["ecx","edx"]),t.putMovRegReg("esp","ebp"),t.putPopReg("ebp"),t.putRet()}));break;case"x64":t=de(32,(t=>{t.putPushReg("rdi"),t.putCallAddressWithArguments(e,["rsi"]),t.putPopReg("rdi"),t.putMovRegPtrReg("rdi","rax"),t.putMovRegOffsetPtrReg("rdi",8,"edx"),t.putRet()}));break;case"arm":t=de(16,(t=>{t.putCallAddressWithArguments(e,["r0","r1"]),t.putPopRegs(["r0","lr"]),t.putMovRegReg("pc","lr")}));break;case"arm64":t=de(64,(t=>{t.putPushRegReg("x0","lr"),t.putCallAddressWithArguments(e,["x1"]),t.putPopRegReg("x2","lr"),t.putStrRegRegOffset("x0","x2",0),t.putStrRegRegOffset("w1","x2",8),t.putRet()}))}return new NativeFunction(t,"void",["pointer","pointer"],x)})),R="ia32"===Process.arch?function(e,t){const n=new NativeFunction(e,"void",["pointer"].concat(t),x);return function(){const e=Memory.alloc(d);return n(e,...arguments),e.readPointer()}}:function(e,t){return new NativeFunction(e,"pointer",t,x)},x={exceptions:"propagate"},w={};let P=null,M=null,y=null,C=null;const I=[],L=new Map,T=[];let j=null,z=0,O=!1,F=!1,D=null;const Z=[];let V=null,J=null;export function getApi(){return null===P&&(P=function(){const e=Process.enumerateModules().filter((e=>/^lib(art|dvm).so$/.test(e.name))).filter((e=>!/\/system\/fake-libs/.test(e.path)));if(0===e.length)return null;const t=e[0],n=-1!==t.name.indexOf("art")?"art":"dalvik",r="art"===n,o={module:t,find(e){const{module:t}=this;let n=t.findExportByName(e);return null===n&&(n=t.findSymbolByName(e)),n},flavor:n,addLocalReference:null};o.isApiLevel34OrApexEquivalent=r&&(null!==o.find("_ZN3art7AppInfo29GetPrimaryApkReferenceProfileEv")||null!==o.find("_ZN3art6Thread15RunFlipFunctionEPS0_"));const a=r?{functions:{JNI_GetCreatedJavaVMs:["JNI_GetCreatedJavaVMs","int",["pointer","int","pointer"]],artInterpreterToCompiledCodeBridge:function(e){this.artInterpreterToCompiledCodeBridge=e},_ZN3art9JavaVMExt12AddGlobalRefEPNS_6ThreadENS_6ObjPtrINS_6mirror6ObjectEEE:["art::JavaVMExt::AddGlobalRef","pointer",["pointer","pointer","pointer"]],_ZN3art9JavaVMExt12AddGlobalRefEPNS_6ThreadEPNS_6mirror6ObjectE:["art::JavaVMExt::AddGlobalRef","pointer",["pointer","pointer","pointer"]],_ZN3art17ReaderWriterMutex13ExclusiveLockEPNS_6ThreadE:["art::ReaderWriterMutex::ExclusiveLock","void",["pointer","pointer"]],_ZN3art17ReaderWriterMutex15ExclusiveUnlockEPNS_6ThreadE:["art::ReaderWriterMutex::ExclusiveUnlock","void",["pointer","pointer"]],_ZN3art22IndirectReferenceTable3AddEjPNS_6mirror6ObjectE:function(e){this["art::IndirectReferenceTable::Add"]=new NativeFunction(e,"pointer",["pointer","uint","pointer"],x)},_ZN3art22IndirectReferenceTable3AddENS_15IRTSegmentStateENS_6ObjPtrINS_6mirror6ObjectEEE:function(e){this["art::IndirectReferenceTable::Add"]=new NativeFunction(e,"pointer",["pointer","uint","pointer"],x)},_ZN3art9JavaVMExt12DecodeGlobalEPv:function(e){let t;t=getAndroidApiLevel()>=26?R(e,["pointer","pointer"]):new NativeFunction(e,"pointer",["pointer","pointer"],x),this["art::JavaVMExt::DecodeGlobal"]=function(e,n,r){return t(e,r)}},_ZN3art9JavaVMExt12DecodeGlobalEPNS_6ThreadEPv:["art::JavaVMExt::DecodeGlobal","pointer",["pointer","pointer","pointer"]],_ZNK3art6Thread19DecodeGlobalJObjectEP8_jobject:["art::Thread::DecodeJObject","pointer",["pointer","pointer"]],_ZNK3art6Thread13DecodeJObjectEP8_jobject:["art::Thread::DecodeJObject","pointer",["pointer","pointer"]],_ZN3art10ThreadList10SuspendAllEPKcb:["art::ThreadList::SuspendAll","void",["pointer","pointer","bool"]],_ZN3art10ThreadList10SuspendAllEv:function(e){const t=new NativeFunction(e,"void",["pointer"],x);this["art::ThreadList::SuspendAll"]=function(e,n,r){return t(e)}},_ZN3art10ThreadList9ResumeAllEv:["art::ThreadList::ResumeAll","void",["pointer"]],_ZN3art11ClassLinker12VisitClassesEPNS_12ClassVisitorE:["art::ClassLinker::VisitClasses","void",["pointer","pointer"]],_ZN3art11ClassLinker12VisitClassesEPFbPNS_6mirror5ClassEPvES4_:function(e){const t=new NativeFunction(e,"void",["pointer","pointer","pointer"],x);this["art::ClassLinker::VisitClasses"]=function(e,n){t(e,n,NULL)}},_ZNK3art11ClassLinker17VisitClassLoadersEPNS_18ClassLoaderVisitorE:["art::ClassLinker::VisitClassLoaders","void",["pointer","pointer"]],_ZN3art2gc4Heap12VisitObjectsEPFvPNS_6mirror6ObjectEPvES5_:["art::gc::Heap::VisitObjects","void",["pointer","pointer","pointer"]],_ZN3art2gc4Heap12GetInstancesERNS_24VariableSizedHandleScopeENS_6HandleINS_6mirror5ClassEEEiRNSt3__16vectorINS4_INS5_6ObjectEEENS8_9allocatorISB_EEEE:["art::gc::Heap::GetInstances","void",["pointer","pointer","pointer","int","pointer"]],_ZN3art2gc4Heap12GetInstancesERNS_24VariableSizedHandleScopeENS_6HandleINS_6mirror5ClassEEEbiRNSt3__16vectorINS4_INS5_6ObjectEEENS8_9allocatorISB_EEEE:function(e){const t=new NativeFunction(e,"void",["pointer","pointer","pointer","bool","int","pointer"],x);this["art::gc::Heap::GetInstances"]=function(e,n,r,o,a){t(e,n,r,0,o,a)}},_ZN3art12StackVisitorC2EPNS_6ThreadEPNS_7ContextENS0_13StackWalkKindEjb:["art::StackVisitor::StackVisitor","void",["pointer","pointer","pointer","uint","uint","bool"]],_ZN3art12StackVisitorC2EPNS_6ThreadEPNS_7ContextENS0_13StackWalkKindEmb:["art::StackVisitor::StackVisitor","void",["pointer","pointer","pointer","uint","size_t","bool"]],_ZN3art12StackVisitor9WalkStackILNS0_16CountTransitionsE0EEEvb:["art::StackVisitor::WalkStack","void",["pointer","bool"]],_ZNK3art12StackVisitor9GetMethodEv:["art::StackVisitor::GetMethod","pointer",["pointer"]],_ZNK3art12StackVisitor16DescribeLocationEv:function(e){this["art::StackVisitor::DescribeLocation"]=Oe(e,["pointer"])},_ZNK3art12StackVisitor24GetCurrentQuickFrameInfoEv:function(e){var t;this["art::StackVisitor::GetCurrentQuickFrameInfo"]=(t=e,function(e){const n=Memory.alloc(12);return A(t)(n,e),{frameSizeInBytes:n.readU32(),coreSpillMask:n.add(4).readU32(),fpSpillMask:n.add(8).readU32()}})},_ZN3art7Context6CreateEv:["art::Context::Create","pointer",[]],_ZN3art6Thread18GetLongJumpContextEv:["art::Thread::GetLongJumpContext","pointer",["pointer"]],_ZN3art6mirror5Class13GetDescriptorEPNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE:function(e){this["art::mirror::Class::GetDescriptor"]=e},_ZN3art6mirror5Class11GetLocationEv:function(e){this["art::mirror::Class::GetLocation"]=Oe(e,["pointer"])},_ZN3art9ArtMethod12PrettyMethodEb:function(e){this["art::ArtMethod::PrettyMethod"]=Oe(e,["pointer","bool"])},_ZN3art12PrettyMethodEPNS_9ArtMethodEb:function(e){this["art::ArtMethod::PrettyMethodNullSafe"]=Oe(e,["pointer","bool"])},_ZN3art6Thread14CurrentFromGdbEv:["art::Thread::CurrentFromGdb","pointer",[]],_ZN3art6mirror6Object5CloneEPNS_6ThreadE:function(e){this["art::mirror::Object::Clone"]=new NativeFunction(e,"pointer",["pointer","pointer"],x)},_ZN3art6mirror6Object5CloneEPNS_6ThreadEm:function(e){const t=new NativeFunction(e,"pointer",["pointer","pointer","pointer"],x);this["art::mirror::Object::Clone"]=function(e,n){const r=NULL;return t(e,n,r)}},_ZN3art6mirror6Object5CloneEPNS_6ThreadEj:function(e){const t=new NativeFunction(e,"pointer",["pointer","pointer","uint"],x);this["art::mirror::Object::Clone"]=function(e,n){return t(e,n,0)}},_ZN3art3Dbg14SetJdwpAllowedEb:["art::Dbg::SetJdwpAllowed","void",["bool"]],_ZN3art3Dbg13ConfigureJdwpERKNS_4JDWP11JdwpOptionsE:["art::Dbg::ConfigureJdwp","void",["pointer"]],_ZN3art31InternalDebuggerControlCallback13StartDebuggerEv:["art::InternalDebuggerControlCallback::StartDebugger","void",["pointer"]],_ZN3art3Dbg9StartJdwpEv:["art::Dbg::StartJdwp","void",[]],_ZN3art3Dbg8GoActiveEv:["art::Dbg::GoActive","void",[]],_ZN3art3Dbg21RequestDeoptimizationERKNS_21DeoptimizationRequestE:["art::Dbg::RequestDeoptimization","void",["pointer"]],_ZN3art3Dbg20ManageDeoptimizationEv:["art::Dbg::ManageDeoptimization","void",[]],_ZN3art15instrumentation15Instrumentation20EnableDeoptimizationEv:["art::Instrumentation::EnableDeoptimization","void",["pointer"]],_ZN3art15instrumentation15Instrumentation20DeoptimizeEverythingEPKc:["art::Instrumentation::DeoptimizeEverything","void",["pointer","pointer"]],_ZN3art15instrumentation15Instrumentation20DeoptimizeEverythingEv:function(e){const t=new NativeFunction(e,"void",["pointer"],x);this["art::Instrumentation::DeoptimizeEverything"]=function(e,n){t(e)}},_ZN3art7Runtime19DeoptimizeBootImageEv:["art::Runtime::DeoptimizeBootImage","void",["pointer"]],_ZN3art15instrumentation15Instrumentation10DeoptimizeEPNS_9ArtMethodE:["art::Instrumentation::Deoptimize","void",["pointer","pointer"]],_ZN3art3jni12JniIdManager14DecodeMethodIdEP10_jmethodID:["art::jni::JniIdManager::DecodeMethodId","pointer",["pointer","pointer"]],_ZN3art3jni12JniIdManager13DecodeFieldIdEP9_jfieldID:["art::jni::JniIdManager::DecodeFieldId","pointer",["pointer","pointer"]],_ZN3art11interpreter18GetNterpEntryPointEv:["art::interpreter::GetNterpEntryPoint","pointer",[]],_ZN3art7Monitor17TranslateLocationEPNS_9ArtMethodEjPPKcPi:["art::Monitor::TranslateLocation","void",["pointer","uint32","pointer","pointer"]]},variables:{_ZN3art3Dbg9gRegistryE:function(e){this.isJdwpStarted=()=>!e.readPointer().isNull()},_ZN3art3Dbg15gDebuggerActiveE:function(e){this.isDebuggerActive=()=>!!e.readU8()}},optionals:new Set(["artInterpreterToCompiledCodeBridge","_ZN3art9JavaVMExt12AddGlobalRefEPNS_6ThreadENS_6ObjPtrINS_6mirror6ObjectEEE","_ZN3art9JavaVMExt12AddGlobalRefEPNS_6ThreadEPNS_6mirror6ObjectE","_ZN3art9JavaVMExt12DecodeGlobalEPv","_ZN3art9JavaVMExt12DecodeGlobalEPNS_6ThreadEPv","_ZNK3art6Thread19DecodeGlobalJObjectEP8_jobject","_ZNK3art6Thread13DecodeJObjectEP8_jobject","_ZN3art10ThreadList10SuspendAllEPKcb","_ZN3art10ThreadList10SuspendAllEv","_ZN3art11ClassLinker12VisitClassesEPNS_12ClassVisitorE","_ZN3art11ClassLinker12VisitClassesEPFbPNS_6mirror5ClassEPvES4_","_ZNK3art11ClassLinker17VisitClassLoadersEPNS_18ClassLoaderVisitorE","_ZN3art6mirror6Object5CloneEPNS_6ThreadE","_ZN3art6mirror6Object5CloneEPNS_6ThreadEm","_ZN3art6mirror6Object5CloneEPNS_6ThreadEj","_ZN3art22IndirectReferenceTable3AddEjPNS_6mirror6ObjectE","_ZN3art22IndirectReferenceTable3AddENS_15IRTSegmentStateENS_6ObjPtrINS_6mirror6ObjectEEE","_ZN3art2gc4Heap12VisitObjectsEPFvPNS_6mirror6ObjectEPvES5_","_ZN3art2gc4Heap12GetInstancesERNS_24VariableSizedHandleScopeENS_6HandleINS_6mirror5ClassEEEiRNSt3__16vectorINS4_INS5_6ObjectEEENS8_9allocatorISB_EEEE","_ZN3art2gc4Heap12GetInstancesERNS_24VariableSizedHandleScopeENS_6HandleINS_6mirror5ClassEEEbiRNSt3__16vectorINS4_INS5_6ObjectEEENS8_9allocatorISB_EEEE","_ZN3art12StackVisitorC2EPNS_6ThreadEPNS_7ContextENS0_13StackWalkKindEjb","_ZN3art12StackVisitorC2EPNS_6ThreadEPNS_7ContextENS0_13StackWalkKindEmb","_ZN3art12StackVisitor9WalkStackILNS0_16CountTransitionsE0EEEvb","_ZNK3art12StackVisitor9GetMethodEv","_ZNK3art12StackVisitor16DescribeLocationEv","_ZNK3art12StackVisitor24GetCurrentQuickFrameInfoEv","_ZN3art7Context6CreateEv","_ZN3art6Thread18GetLongJumpContextEv","_ZN3art6mirror5Class13GetDescriptorEPNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE","_ZN3art6mirror5Class11GetLocationEv","_ZN3art9ArtMethod12PrettyMethodEb","_ZN3art12PrettyMethodEPNS_9ArtMethodEb","_ZN3art3Dbg13ConfigureJdwpERKNS_4JDWP11JdwpOptionsE","_ZN3art31InternalDebuggerControlCallback13StartDebuggerEv","_ZN3art3Dbg15gDebuggerActiveE","_ZN3art15instrumentation15Instrumentation20EnableDeoptimizationEv","_ZN3art15instrumentation15Instrumentation20DeoptimizeEverythingEPKc","_ZN3art15instrumentation15Instrumentation20DeoptimizeEverythingEv","_ZN3art7Runtime19DeoptimizeBootImageEv","_ZN3art15instrumentation15Instrumentation10DeoptimizeEPNS_9ArtMethodE","_ZN3art3Dbg9StartJdwpEv","_ZN3art3Dbg8GoActiveEv","_ZN3art3Dbg21RequestDeoptimizationERKNS_21DeoptimizationRequestE","_ZN3art3Dbg20ManageDeoptimizationEv","_ZN3art3Dbg9gRegistryE","_ZN3art3jni12JniIdManager14DecodeMethodIdEP10_jmethodID","_ZN3art3jni12JniIdManager13DecodeFieldIdEP9_jfieldID","_ZN3art11interpreter18GetNterpEntryPointEv","_ZN3art7Monitor17TranslateLocationEPNS_9ArtMethodEjPPKcPi"])}:{functions:{_Z20dvmDecodeIndirectRefP6ThreadP8_jobject:["dvmDecodeIndirectRef","pointer",["pointer","pointer"]],_Z15dvmUseJNIBridgeP6MethodPv:["dvmUseJNIBridge","void",["pointer","pointer"]],_Z20dvmHeapSourceGetBasev:["dvmHeapSourceGetBase","pointer",[]],_Z21dvmHeapSourceGetLimitv:["dvmHeapSourceGetLimit","pointer",[]],_Z16dvmIsValidObjectPK6Object:["dvmIsValidObject","uint8",["pointer"]],JNI_GetCreatedJavaVMs:["JNI_GetCreatedJavaVMs","int",["pointer","int","pointer"]]},variables:{gDvmJni:function(e){this.gDvmJni=e},gDvm:function(e){this.gDvm=e}}},{functions:s={},variables:l={},optionals:u=new Set}=a,p=[];for(const[e,t]of Object.entries(s)){const n=o.find(e);null!==n?"function"==typeof t?t.call(o,n):o[t[0]]=new NativeFunction(n,t[1],t[2],x):u.has(e)||p.push(e)}for(const[e,t]of Object.entries(l)){const n=o.find(e);null!==n?t.call(o,n):u.has(e)||p.push(e)}if(p.length>0)throw new Error("Java API only partially available; please file a bug. Missing: "+p.join(", "));const _=Memory.alloc(d),m=Memory.alloc(4);if(i("JNI_GetCreatedJavaVMs",o.JNI_GetCreatedJavaVMs(_,1,m)),0===m.readInt())return null;if(o.vm=_.readPointer(),r){const e=getAndroidApiLevel();let t;t=e>=27?33554432:e>=24?16777216:0,o.kAccCompileDontBother=t;const n=o.vm.add(d).readPointer();o.artRuntime=n;const r=v(o),a=r.offset,i=a.instrumentation;o.artInstrumentation=null!==i?n.add(i):null;getArtApexVersion()>=36e7&&null!=o.artInstrumentation&&(o.artInstrumentation=o.artInstrumentation.readPointer()),o.artHeap=n.add(a.heap).readPointer(),o.artThreadList=n.add(a.threadList).readPointer();const s=n.add(a.classLinker).readPointer(),l=function(e,t){const n=Q(e,t);if(null===n)throw new Error("Unable to determine ClassLinker field offsets");return n}(n,r).offset,u=s.add(l.quickResolutionTrampoline).readPointer(),p=s.add(l.quickImtConflictTrampoline).readPointer(),_=s.add(l.quickGenericJniTrampoline).readPointer(),m=s.add(l.quickToInterpreterBridgeTrampoline).readPointer();o.artClassLinker={address:s,quickResolutionTrampoline:u,quickImtConflictTrampoline:p,quickGenericJniTrampoline:_,quickToInterpreterBridgeTrampoline:m};const h=new c(o);o.artQuickGenericJniTrampoline=X(_,h),o.artQuickToInterpreterBridge=X(m,h),o.artQuickResolutionTrampoline=X(u,h),void 0===o["art::JavaVMExt::AddGlobalRef"]&&(o["art::JavaVMExt::AddGlobalRef"]=function(e){const t=4===d?{globalsLock:32,globals:72}:{globalsLock:64,globals:112},n=e.vm.add(t.globalsLock),r=e.vm.add(t.globals),o=e["art::IndirectReferenceTable::Add"],a=e["art::ReaderWriterMutex::ExclusiveLock"],i=e["art::ReaderWriterMutex::ExclusiveUnlock"],s=0;return function(e,t,c){a(n,t);try{return o(r,s,c)}finally{i(n,t)}}}(o)),void 0===o["art::JavaVMExt::DecodeGlobal"]&&(o["art::JavaVMExt::DecodeGlobal"]=function(e){const t=e["art::Thread::DecodeJObject"];if(void 0===t)throw new Error("art::Thread::DecodeJObject is not available; please file a bug");return function(e,n,r){return t(n,r)}}(o)),void 0===o["art::ArtMethod::PrettyMethod"]&&(o["art::ArtMethod::PrettyMethod"]=o["art::ArtMethod::PrettyMethodNullSafe"]),void 0!==o["art::interpreter::GetNterpEntryPoint"]?o.artNterpEntryPoint=o["art::interpreter::GetNterpEntryPoint"]():o.artNterpEntryPoint=o.find("ExecuteNterpImpl"),C=function(e,t){const n=getArtThreadSpec(t).offset,r=S().offset,o=`\n#include <gum/guminterceptor.h>\n\nextern GMutex lock;\nextern GHashTable * methods;\nextern GHashTable * replacements;\nextern gpointer last_seen_art_method;\n\nextern gpointer get_oat_quick_method_header_impl (gpointer method, gpointer pc);\n\nvoid\ninit (void)\n{\n  g_mutex_init (&lock);\n  methods = g_hash_table_new_full (NULL, NULL, NULL, NULL);\n  replacements = g_hash_table_new_full (NULL, NULL, NULL, NULL);\n}\n\nvoid\nfinalize (void)\n{\n  g_hash_table_unref (replacements);\n  g_hash_table_unref (methods);\n  g_mutex_clear (&lock);\n}\n\ngboolean\nis_replacement_method (gpointer method)\n{\n  gboolean is_replacement;\n\n  g_mutex_lock (&lock);\n\n  is_replacement = g_hash_table_contains (replacements, method);\n\n  g_mutex_unlock (&lock);\n\n  return is_replacement;\n}\n\ngpointer\nget_replacement_method (gpointer original_method)\n{\n  gpointer replacement_method;\n\n  g_mutex_lock (&lock);\n\n  replacement_method = g_hash_table_lookup (methods, original_method);\n\n  g_mutex_unlock (&lock);\n\n  return replacement_method;\n}\n\nvoid\nset_replacement_method (gpointer original_method,\n                        gpointer replacement_method)\n{\n  g_mutex_lock (&lock);\n\n  g_hash_table_insert (methods, original_method, replacement_method);\n  g_hash_table_insert (replacements, replacement_method, original_method);\n\n  g_mutex_unlock (&lock);\n}\n\nvoid\nsynchronize_replacement_methods (guint quick_code_offset,\n                                 void * nterp_entrypoint,\n                                 void * quick_to_interpreter_bridge)\n{\n  GHashTableIter iter;\n  gpointer hooked_method, replacement_method;\n\n  g_mutex_lock (&lock);\n\n  g_hash_table_iter_init (&iter, methods);\n  while (g_hash_table_iter_next (&iter, &hooked_method, &replacement_method))\n  {\n    void ** quick_code;\n\n    *((uint32_t *) replacement_method) = *((uint32_t *) hooked_method);\n\n    quick_code = hooked_method + quick_code_offset;\n    if (*quick_code == nterp_entrypoint)\n      *quick_code = quick_to_interpreter_bridge;\n  }\n\n  g_mutex_unlock (&lock);\n}\n\nvoid\ndelete_replacement_method (gpointer original_method)\n{\n  gpointer replacement_method;\n\n  g_mutex_lock (&lock);\n\n  replacement_method = g_hash_table_lookup (methods, original_method);\n  if (replacement_method != NULL)\n  {\n    g_hash_table_remove (methods, original_method);\n    g_hash_table_remove (replacements, replacement_method);\n  }\n\n  g_mutex_unlock (&lock);\n}\n\ngpointer\ntranslate_method (gpointer method)\n{\n  gpointer translated_method;\n\n  g_mutex_lock (&lock);\n\n  translated_method = g_hash_table_lookup (replacements, method);\n\n  g_mutex_unlock (&lock);\n\n  return (translated_method != NULL) ? translated_method : method;\n}\n\ngpointer\nfind_replacement_method_from_quick_code (gpointer method,\n                                         gpointer thread)\n{\n  gpointer replacement_method;\n  gpointer managed_stack;\n  gpointer top_quick_frame;\n  gpointer link_managed_stack;\n  gpointer * link_top_quick_frame;\n\n  replacement_method = get_replacement_method (method);\n  if (replacement_method == NULL)\n    return NULL;\n\n  /*\n   * Stack check.\n   *\n   * Return NULL to indicate that the original method should be invoked, otherwise\n   * return a pointer to the replacement ArtMethod.\n   *\n   * If the caller is our own JNI replacement stub, then a stack transition must\n   * have been pushed onto the current thread's linked list.\n   *\n   * Therefore, we invoke the original method if the following conditions are met:\n   *   1- The current managed stack is empty.\n   *   2- The ArtMethod * inside the linked managed stack's top quick frame is the\n   *      same as our replacement.\n   */\n  managed_stack = thread + ${n.managedStack};\n  top_quick_frame = *((gpointer *) (managed_stack + ${r.topQuickFrame}));\n  if (top_quick_frame != NULL)\n    return replacement_method;\n\n  link_managed_stack = *((gpointer *) (managed_stack + ${r.link}));\n  if (link_managed_stack == NULL)\n    return replacement_method;\n\n  link_top_quick_frame = GSIZE_TO_POINTER (*((gsize *) (link_managed_stack + ${r.topQuickFrame})) & ~((gsize) 1));\n  if (link_top_quick_frame == NULL || *link_top_quick_frame != replacement_method)\n    return replacement_method;\n\n  return NULL;\n}\n\nvoid\non_interpreter_do_call (GumInvocationContext * ic)\n{\n  gpointer method, replacement_method;\n\n  method = gum_invocation_context_get_nth_argument (ic, 0);\n\n  replacement_method = get_replacement_method (method);\n  if (replacement_method != NULL)\n    gum_invocation_context_replace_nth_argument (ic, 0, replacement_method);\n}\n\ngpointer\non_art_method_get_oat_quick_method_header (gpointer method,\n                                           gpointer pc)\n{\n  if (is_replacement_method (method))\n    return NULL;\n\n  return get_oat_quick_method_header_impl (method, pc);\n}\n\nvoid\non_art_method_pretty_method (GumInvocationContext * ic)\n{\n  const guint this_arg_index = ${"arm64"===Process.arch?0:1};\n  gpointer method;\n\n  method = gum_invocation_context_get_nth_argument (ic, this_arg_index);\n  if (method == NULL)\n    gum_invocation_context_replace_nth_argument (ic, this_arg_index, last_seen_art_method);\n  else\n    last_seen_art_method = method;\n}\n\nvoid\non_leave_gc_concurrent_copying_copying_phase (GumInvocationContext * ic)\n{\n  GHashTableIter iter;\n  gpointer hooked_method, replacement_method;\n\n  g_mutex_lock (&lock);\n\n  g_hash_table_iter_init (&iter, methods);\n  while (g_hash_table_iter_next (&iter, &hooked_method, &replacement_method))\n    *((uint32_t *) replacement_method) = *((uint32_t *) hooked_method);\n\n  g_mutex_unlock (&lock);\n}\n`,a=8,i=d,s=d,c=d,l=Memory.alloc(a+i+s+c),u=l.add(a),p=u.add(i),_=p.add(s),m=e.find(4===d?"_ZN3art9ArtMethod23GetOatQuickMethodHeaderEj":"_ZN3art9ArtMethod23GetOatQuickMethodHeaderEm"),h=new CModule(o,{lock:l,methods:u,replacements:p,last_seen_art_method:_,get_oat_quick_method_header_impl:m??ptr("0xdeadbeef")}),g={exceptions:"propagate",scheduling:"exclusive"};return{handle:h,replacedMethods:{isReplacement:new NativeFunction(h.is_replacement_method,"bool",["pointer"],g),get:new NativeFunction(h.get_replacement_method,"pointer",["pointer"],g),set:new NativeFunction(h.set_replacement_method,"void",["pointer","pointer"],g),synchronize:new NativeFunction(h.synchronize_replacement_methods,"void",["uint","pointer","pointer"],g),delete:new NativeFunction(h.delete_replacement_method,"void",["pointer"],g),translate:new NativeFunction(h.translate_method,"pointer",["pointer"],g),findReplacementFromQuickCode:h.find_replacement_method_from_quick_code},getOatQuickMethodHeaderImpl:m,hooks:{Interpreter:{doCall:h.on_interpreter_do_call},ArtMethod:{getOatQuickMethodHeader:h.on_art_method_get_oat_quick_method_header,prettyMethod:h.on_art_method_pretty_method},Gc:{copyingPhase:{onLeave:h.on_leave_gc_concurrent_copying_copying_phase},runFlip:{onEnter:h.on_leave_gc_concurrent_copying_copying_phase}}}}}(o,h),function(e){const t=e["art::ArtMethod::PrettyMethod"];if(void 0===t)return;Interceptor.attach(t.impl,C.hooks.ArtMethod.prettyMethod),Interceptor.flush()}(o);let g=null;Object.defineProperty(o,"jvmti",{get(){return null===g&&(g=[U(h,this.artRuntime)]),g[0]}})}const h=t.enumerateImports().filter((e=>0===e.name.indexOf("_Z"))).reduce(((e,t)=>(e[t.name]=t.address,e)),{});return o.$new=new NativeFunction(h._Znwm||h._Znwj,"pointer",["ulong"],x),o.$delete=new NativeFunction(h._ZdlPv,"void",["pointer"],x),y=r?Re:Pe,o}()),P}function U(e,o){let a=null;return e.perform((()=>{const i=getApi().find("_ZN3art7Runtime18EnsurePluginLoadedEPKcPNSt3__112basic_stringIcNS3_11char_traitsIcEENS3_9allocatorIcEEEE");if(null===i)return;const c=new NativeFunction(i,"bool",["pointer","pointer","pointer"]),l=Memory.alloc(d);if(!c(o,Memory.allocUtf8String("libopenjdkjvmti.so"),l))return;const u=1073741824|t.v1_2,p=e.tryGetEnvHandle(u);if(null===p)return;a=new r(p,e);const _=Memory.alloc(8);_.writeU64(n.canTagObjects);a.addCapabilities(_)!==s&&(a=null)})),a}export function ensureClassInitialized(e,t){"art"===getApi().flavor&&e.getClassName(t)}const G={ia32:B,x64:B,arm:function(e){if("add.w"!==e.mnemonic)return null;const t=e.operands;if(3!==t.length)return null;const n=t[2];if("imm"!==n.type)return null;return n.value},arm64:function(e){if("add"!==e.mnemonic)return null;const t=e.operands;if(3!==t.length)return null;if("sp"===t[0].value||"sp"===t[1].value)return null;const n=t[2];if("imm"!==n.type)return null;const r=n.value.valueOf();if(r<256||r>1024)return null;return r}};function B(e){if("lea"!==e.mnemonic)return null;const t=e.operands[1].value.disp;return t<256||t>1024?null:t}const q={ia32:W,x64:W,arm:function(e){return null},arm64:function(e){if("ldr"!==e.mnemonic)return null;const t=e.operands;if("x0"===t[0].value)return null;const n=t[1].value;if("x0"!==n.base)return null;const r=n.disp;if(r<256||r>1024)return null;return r}};function W(e){if("mov"!==e.mnemonic)return null;const t=e.operands;if("rax"!==t[0].value)return null;const n=t[1];if("mem"!==n.type)return null;const r=n.value;if("rdi"!==r.base)return null;const o=r.disp;return o<256||o>1024?null:o}const H={ia32:K,x64:K,arm:function(e){if("ldr.w"===e.mnemonic)return e.operands[1].value.disp;return null},arm64:function(e,t){if(null===t)return null;const{mnemonic:n}=e,{mnemonic:r}=t;if("cmp"===n&&"ldr"===r||"bl"===n&&"str"===r)return t.operands[1].value.disp;return null}};function K(e){return"cmp"===e.mnemonic?e.operands[0].value.disp:null}function Q(e,t){if(null!==M)return M;const{classLinker:n,internTable:r}=t.offset,o=e.add(n).readPointer(),a=e.add(r).readPointer(),i=4===d?100:200,s=i+100*d,c=getAndroidApiLevel();let l=null;for(let e=i;e!==s;e+=d){if(o.add(e).readPointer().equals(a)){let t;t=c>=30||"R"===N()?6:c>=29?4:c>=23?3:5;const n=e+t*d;let r;r=c>=23?n-2*d:n-3*d,l={offset:{quickResolutionTrampoline:r,quickImtConflictTrampoline:n-d,quickGenericJniTrampoline:n,quickToInterpreterBridgeTrampoline:n+d}};break}}return null!==l&&(M=l),l}export function getArtClassSpec(e){let t=null;return e.perform((n=>{const r=getArtFieldSpec(e),o=getArtMethodSpec(e),a={artArrayLengthSize:4,artArrayEntrySize:r.size,artArrayMax:50},i={artArrayLengthSize:d,artArrayEntrySize:o.size,artArrayMax:100},s=(e,t,n)=>{const r=e.add(t).readPointer();if(r.isNull())return null;const o=4===n?r.readU32():r.readU64().valueOf();return o<=0?null:{length:o,data:r.add(n)}},c=(e,t,n,r)=>{try{const o=s(e,t,r.artArrayLengthSize);if(null===o)return!1;const a=Math.min(o.length,r.artArrayMax);for(let e=0;e!==a;e++){if(o.data.add(e*r.artArrayEntrySize).equals(n))return!0}}catch{}return!1},l=n.findClass("java/lang/Thread"),u=n.newGlobalRef(l);try{let r;withRunnableArtThread(e,n,(t=>{r=getApi()["art::JavaVMExt::DecodeGlobal"](e,t,u)}));const o=be(n.getFieldId(u,"name","Ljava/lang/String;")),d=be(n.getStaticFieldId(u,"MAX_PRIORITY","I"));let p=-1,_=-1;for(let e=0;256!==e;e+=4)-1===p&&c(r,e,d,a)&&(p=e),-1===_&&c(r,e,o,a)&&(_=e);if(-1===_||-1===p)throw new Error("Unable to find fields in java/lang/Thread; please file a bug");const m=_!==p?p:0,h=_;let g=-1;const f=fe(n.getMethodId(u,"getName","()Ljava/lang/String;"));for(let e=0;256!==e;e+=4)-1===g&&c(r,e,f,i)&&(g=e);if(-1===g)throw new Error("Unable to find methods in java/lang/Thread; please file a bug");let b=-1;const v=s(r,g,i.artArrayLengthSize).length;for(let e=g;256!==e;e+=4)if(r.add(e).readU16()===v){b=e;break}if(-1===b)throw new Error("Unable to find copied methods in java/lang/Thread; please file a bug");t={offset:{ifields:h,methods:g,sfields:m,copiedMethodsOffset:b}}}finally{n.deleteLocalRef(l),n.deleteGlobalRef(u)}})),t}export function getArtFieldSpec(e){const t=getAndroidApiLevel();return t>=23?{size:16,offset:{accessFlags:4}}:t>=21?{size:24,offset:{accessFlags:12}}:null}const $={ia32:Y,x64:Y,arm:function(e){if("ldr.w"===e.mnemonic)return e.operands[1].value.disp;return null},arm64:function(e){if("ldr"===e.mnemonic)return e.operands[1].value.disp;return null}};function X(e,t){let n;return t.perform((t=>{const r=getArtThreadFromEnv(t),o=(0,$[Process.arch])(Instruction.parse(e));n=null!==o?r.add(o).readPointer():e})),n}function Y(e){return"jmp"===e.mnemonic?e.operands[0].value.disp:null}export function getArtThreadFromEnv(e){return e.handle.add(d).readPointer()}function ee(){return 1e7*getAndroidApiLevel()}let te=null;function ne(e){null===te&&(te=new NativeFunction(Process.getModuleByName("libc.so").getExportByName("__system_property_get"),"int",["pointer","pointer"],x));const t=Memory.alloc(92);return te(Memory.allocUtf8String(e),t),t.readUtf8String()}export function withRunnableArtThread(e,t,n){const r=E(e,t),o=getArtThreadFromEnv(t).toString();if(w[o]=n,r(t.handle),void 0!==w[o])throw delete w[o],new Error("Unable to perform state transition; please file a bug")}function re(e){const t=e.toString(),n=w[t];delete w[t],n(e)}export function withAllArtThreadsSuspended(e){const t=getApi(),n=t.artThreadList;t["art::ThreadList::SuspendAll"](n,Memory.allocUtf8String("frida"),0);try{e()}finally{t["art::ThreadList::ResumeAll"](n)}}class oe{constructor(e){const t=Memory.alloc(4*d),n=t.add(d);t.writePointer(n);const r=new NativeCallback(((t,n)=>!0===e(n)?1:0),"bool",["pointer","pointer"]);n.add(2*d).writePointer(r),this.handle=t,this._onVisit=r}}export function makeArtClassVisitor(e){return getApi()["art::ClassLinker::VisitClasses"]instanceof NativeFunction?new oe(e):new NativeCallback((t=>!0===e(t)?1:0),"bool",["pointer","pointer"])}class ae{constructor(e){const t=Memory.alloc(4*d),n=t.add(d);t.writePointer(n);const r=new NativeCallback(((t,n)=>{e(n)}),"void",["pointer","pointer"]);n.add(2*d).writePointer(r),this.handle=t,this._onVisit=r}}export function makeArtClassLoaderVisitor(e){return new ae(e)}const ie={"include-inlined-frames":0,"skip-inlined-frames":1};export class ArtStackVisitor{constructor(e,t,n,r=0,o=!0){const a=getApi(),i=3*d,s=Memory.alloc(512+i);a["art::StackVisitor::StackVisitor"](s,e,t,ie[n],r,o?1:0);const c=s.add(512);s.writePointer(c);const l=new NativeCallback(this._visitFrame.bind(this),"bool",["pointer"]);c.add(2*d).writePointer(l),this.handle=s,this._onVisitFrame=l;const u=s.add(4===d?12:24);this._curShadowFrame=u,this._curQuickFrame=u.add(d),this._curQuickFramePc=u.add(2*d),this._curOatQuickMethodHeader=u.add(3*d),this._getMethodImpl=a["art::StackVisitor::GetMethod"],this._descLocImpl=a["art::StackVisitor::DescribeLocation"],this._getCQFIImpl=a["art::StackVisitor::GetCurrentQuickFrameInfo"]}walkStack(e=!1){getApi()["art::StackVisitor::WalkStack"](this.handle,e?1:0)}_visitFrame(){return this.visitFrame()?1:0}visitFrame(){throw new Error("Subclass must implement visitFrame")}getMethod(){const e=this._getMethodImpl(this.handle);return e.isNull()?null:new ArtMethod(e)}getCurrentQuickFramePc(){return this._curQuickFramePc.readPointer()}getCurrentQuickFrame(){return this._curQuickFrame.readPointer()}getCurrentShadowFrame(){return this._curShadowFrame.readPointer()}describeLocation(){const e=new Fe;return this._descLocImpl(e,this.handle),e.disposeToString()}getCurrentOatQuickMethodHeader(){return this._curOatQuickMethodHeader.readPointer()}getCurrentQuickFrameInfo(){return this._getCQFIImpl(this.handle)}}export class ArtMethod{constructor(e){this.handle=e}prettyMethod(e=!0){const t=new Fe;return getApi()["art::ArtMethod::PrettyMethod"](t,this.handle,e?1:0),t.disposeToString()}toString(){return`ArtMethod(handle=${this.handle})`}}const se={ia32:globalThis.X86Relocator,x64:globalThis.X86Relocator,arm:globalThis.ThumbRelocator,arm64:globalThis.Arm64Relocator},ce={ia32:globalThis.X86Writer,x64:globalThis.X86Writer,arm:globalThis.ThumbWriter,arm64:globalThis.Arm64Writer};function de(e,t){null===j&&(j=Memory.alloc(Process.pageSize));const n=j.add(z),r=Process.arch,o=ce[r];return Memory.patchCode(n,e,(r=>{const a=new o(r,{pc:n});if(t(a),a.flush(),a.offset>e)throw new Error(`Wrote ${a.offset}, exceeding maximum of ${e}`)})),z+=e,"arm"===r?n.or(1):n}function le(e,t){!function(e){if(F)return;F=!0,function(e){const t=getApi();[t.artQuickGenericJniTrampoline,t.artQuickToInterpreterBridge,t.artQuickResolutionTrampoline].forEach((t=>{Memory.protect(t,32,"rwx");const n=new Ae(t);n.activate(e),T.push(n)}))}(e),function(){const e=getApi(),t=getAndroidApiLevel(),{isApiLevel34OrApexEquivalent:n}=e;let r;if(t<=22)r=/^_ZN3art11interpreter6DoCallILb[0-1]ELb[0-1]EEEbPNS_6mirror9ArtMethodEPNS_6ThreadERNS_11ShadowFrameEPKNS_11InstructionEtPNS_6JValueE$/;else if(t<=33&&!n)r=/^_ZN3art11interpreter6DoCallILb[0-1]ELb[0-1]EEEbPNS_9ArtMethodEPNS_6ThreadERNS_11ShadowFrameEPKNS_11InstructionEtPNS_6JValueE$/;else{if(!n)throw new Error("Unable to find method invocation in ART; please file a bug");r=/^_ZN3art11interpreter6DoCallILb[0-1]EEEbPNS_9ArtMethodEPNS_6ThreadERNS_11ShadowFrameEPKNS_11InstructionEtbPNS_6JValueE$/}const o=e.module,a=[...o.enumerateExports(),...o.enumerateSymbols()].filter((e=>r.test(e.name)));if(0===a.length)throw new Error("Unable to find method invocation in ART; please file a bug");for(const e of a)Interceptor.attach(e.address,C.hooks.Interpreter.doCall)}(),function(){const e=getApi(),t=e.module.findSymbolByName("_ZN3art2gc4Heap22CollectGarbageInternalENS0_9collector6GcTypeENS0_7GcCauseEbj");if(null===t)return;const{artNterpEntryPoint:n,artQuickToInterpreterBridge:r}=e,o=getArtMethodSpec(e.vm).offset.quickCode;Interceptor.attach(t,{onLeave(){C.replacedMethods.synchronize(o,n,r)}})}(),function(){const e=[["_ZN3art11ClassLinker26VisiblyInitializedCallback22MarkVisiblyInitializedEPNS_6ThreadE","e90340f8 : ff0ff0ff"],["_ZN3art11ClassLinker26VisiblyInitializedCallback29AdjustThreadVisibilityCounterEPNS_6ThreadEl","7f0f00f9 : 1ffcffff"]],t=getApi(),n=t.module;for(const[r,o]of e){const e=n.findSymbolByName(r);if(null===e)continue;const a=Memory.scanSync(e,8192,o);if(0===a.length)return;const{artNterpEntryPoint:i,artQuickToInterpreterBridge:s}=t,c=getArtMethodSpec(t.vm).offset.quickCode;return void Interceptor.attach(a[0].address,(function(){C.replacedMethods.synchronize(c,i,s)}))}}()}(t),function(e){if(O)return;if(O=!0,!function(){if(getAndroidApiLevel()<31)return!1;const e=ue[Process.arch];if(void 0===e)return!1;const t=e.signatures.map((({pattern:e,offset:t=0,validateMatch:n=me})=>({pattern:new MatchPattern(e.join("")),offset:t,validateMatch:n}))),n=[];for(const{base:e,size:r}of getApi().module.enumerateRanges("--x"))for(const{pattern:o,offset:a,validateMatch:i}of t){const t=Memory.scanSync(e,r,o).map((({address:e,size:t})=>({address:e.sub(a),size:t+a}))).filter((e=>{const t=i(e);return null!==t&&(e.validationResult=t,!0)}));n.push(...t)}if(0===n.length)return!1;return n.forEach(e.instrument),!0}()){const{getOatQuickMethodHeaderImpl:e}=C;if(null===e)return;try{Interceptor.replace(e,C.hooks.ArtMethod.getOatQuickMethodHeader)}catch(e){}}const t=getAndroidApiLevel();let n=null;const r=getApi();t>28?n=r.find("_ZN3art2gc9collector17ConcurrentCopying12CopyingPhaseEv"):t>22&&(n=r.find("_ZN3art2gc9collector17ConcurrentCopying12MarkingPhaseEv"));null!==n&&Interceptor.attach(n,C.hooks.Gc.copyingPhase);let o=null;o=r.find("_ZN3art6Thread15RunFlipFunctionEPS0_"),null===o&&(o=r.find("_ZN3art6Thread15RunFlipFunctionEPS0_b"));null!==o&&Interceptor.attach(o,C.hooks.Gc.runFlip)}()}const ue={arm:{signatures:[{pattern:["b0 68","01 30","0c d0","1b 98",":","c0 ff","c0 ff","00 ff","00 2f"],validateMatch:pe},{pattern:["d8 f8 08 00","01 30","0c d0","1b 98",":","f0 ff ff 0f","ff ff","00 ff","00 2f"],validateMatch:pe},{pattern:["b0 68","01 30","40 f0 c3 80","00 25",":","c0 ff","c0 ff","c0 fb 00 d0","ff f8"],validateMatch:pe}],instrument:function({address:e,size:t,validationResult:n}){const{methodReg:r,target:o}=n,a=Memory.alloc(Process.pageSize);let i=t;Memory.patchCode(a,256,(t=>{const n=new ThumbWriter(t,{pc:a}),s=new ThumbRelocator(e,n);for(let e=0;2!==e;e++)s.readOne();s.writeAll(),s.readOne(),s.skipOne(),n.putBCondLabel("eq","runtime_or_replacement_method");n.putBytes([45,237,16,10]);const c=["r0","r1","r2","r3"];n.putPushRegs(c),n.putCallAddressWithArguments(C.replacedMethods.isReplacement,[r]),n.putCmpRegImm("r0",0),n.putPopRegs(c);n.putBytes([189,236,16,10]),n.putBCondLabel("ne","runtime_or_replacement_method"),n.putBLabel("regular_method"),s.readOne();const d=s.input.address.equals(o.whenRegularMethod);for(n.putLabel(d?"regular_method":"runtime_or_replacement_method"),s.writeOne();i<10;){const e=s.readOne();if(0===e){i=10;break}i=e}s.writeAll(),n.putBranchAddress(e.add(i+1)),n.putLabel(d?"runtime_or_replacement_method":"regular_method"),n.putBranchAddress(o.whenTrue),n.flush()})),I.push(new he(e,i,a)),Memory.patchCode(e,i,(t=>{const n=new ThumbWriter(t,{pc:e});n.putLdrRegAddress("pc",a.or(1)),n.flush()}))}},arm64:{signatures:[{pattern:["0a 40 b9","1f 05 00 31","40 01 00 54","88 39 00 f0",":","fc ff ff","1f fc ff ff","1f 00 00 ff","00 00 00 9f"],offset:1,validateMatch:_e},{pattern:["0a 40 b9","1f 05 00 31","40 01 00 54","00 0e 40 f9",":","fc ff ff","1f fc ff ff","1f 00 00 ff","00 fc ff ff"],offset:1,validateMatch:_e},{pattern:["0a 40 b9","1f 05 00 31","01 34 00 54","e0 03 1f aa",":","fc ff ff","1f fc ff ff","1f 00 00 ff","e0 ff ff ff"],offset:1,validateMatch:_e}],instrument:function({address:e,size:t,validationResult:n}){const{methodReg:r,scratchReg:o,target:a}=n,i=Memory.alloc(Process.pageSize);Memory.patchCode(i,256,(t=>{const n=new Arm64Writer(t,{pc:i}),o=new Arm64Relocator(e,n);for(let e=0;2!==e;e++)o.readOne();o.writeAll(),o.readOne(),o.skipOne(),n.putBCondLabel("eq","runtime_or_replacement_method");const s=["d0","d1","d2","d3","d4","d5","d6","d7","x0","x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17"],c=s.length;for(let e=0;e!==c;e+=2)n.putPushRegReg(s[e],s[e+1]);n.putCallAddressWithArguments(C.replacedMethods.isReplacement,[r]),n.putCmpRegReg("x0","xzr");for(let e=c-2;e>=0;e-=2)n.putPopRegReg(s[e],s[e+1]);n.putBCondLabel("ne","runtime_or_replacement_method"),n.putBLabel("regular_method"),o.readOne();const d=o.input,l=d.address.equals(a.whenRegularMethod);n.putLabel(l?"regular_method":"runtime_or_replacement_method"),o.writeOne(),n.putBranchAddress(d.next),n.putLabel(l?"runtime_or_replacement_method":"regular_method"),n.putBranchAddress(a.whenTrue),n.flush()})),I.push(new he(e,t,i)),Memory.patchCode(e,t,(t=>{const n=new Arm64Writer(t,{pc:e});n.putLdrRegAddress(o,i),n.putBrReg(o),n.flush()}))}}};function pe({address:e,size:t}){const n=Instruction.parse(e.or(1)),[r,a]=n.operands,i=a.value.base,s=r.value,c=Instruction.parse(n.next.add(2)),d=ptr(c.operands[0].value),l=c.address.add(c.size);let u,p;return"beq"===c.mnemonic?(u=l,p=d):(u=d,p=l),o(u.or(1),(function(e){const{mnemonic:t}=e;if("ldr"!==t&&"ldr.w"!==t)return null;const{base:n,disp:r}=e.operands[1].value;if(n!==i||20!==r)return null;return{methodReg:i,scratchReg:s,target:{whenTrue:d,whenRegularMethod:u,whenRuntimeMethod:p}}}),{limit:3})}function _e({address:e,size:t}){const[n,r]=Instruction.parse(e).operands,a=r.value.base,i="x"+n.value.substring(1),s=Instruction.parse(e.add(8)),c=ptr(s.operands[0].value),d=e.add(12);let l,u;return"b.eq"===s.mnemonic?(l=d,u=c):(l=c,u=d),o(l,(function(e){if("ldr"!==e.mnemonic)return null;const{base:t,disp:n}=e.operands[1].value;if(t!==a||24!==n)return null;return{methodReg:a,scratchReg:i,target:{whenTrue:c,whenRegularMethod:l,whenRuntimeMethod:u}}}),{limit:3})}function me(){return{}}class he{constructor(e,t,n){this.address=e,this.size=t,this.originalCode=e.readByteArray(t),this.trampoline=n}revert(){Memory.patchCode(this.address,this.size,(e=>{e.writeByteArray(this.originalCode)}))}}export function makeMethodMangler(e){return new y(e)}export function translateMethod(e){return C.replacedMethods.translate(e)}export function backtrace(e,t={}){const{limit:n=16}=t,r=e.getEnv();return null===D&&(D=function(e,t){const n=getApi(),r=Memory.alloc(Process.pointerSize),o=new CModule("\n#include <glib.h>\n#include <stdbool.h>\n#include <string.h>\n#include <gum/gumtls.h>\n#include <json-glib/json-glib.h>\n\ntypedef struct _ArtBacktrace ArtBacktrace;\ntypedef struct _ArtStackFrame ArtStackFrame;\n\ntypedef struct _ArtStackVisitor ArtStackVisitor;\ntypedef struct _ArtStackVisitorVTable ArtStackVisitorVTable;\n\ntypedef struct _ArtClass ArtClass;\ntypedef struct _ArtMethod ArtMethod;\ntypedef struct _ArtThread ArtThread;\ntypedef struct _ArtContext ArtContext;\n\ntypedef struct _JNIEnv JNIEnv;\n\ntypedef struct _StdString StdString;\ntypedef struct _StdTinyString StdTinyString;\ntypedef struct _StdLargeString StdLargeString;\n\ntypedef enum {\n  STACK_WALK_INCLUDE_INLINED_FRAMES,\n  STACK_WALK_SKIP_INLINED_FRAMES,\n} StackWalkKind;\n\nstruct _StdTinyString\n{\n  guint8 unused;\n  gchar data[(3 * sizeof (gpointer)) - 1];\n};\n\nstruct _StdLargeString\n{\n  gsize capacity;\n  gsize size;\n  gchar * data;\n};\n\nstruct _StdString\n{\n  union\n  {\n    guint8 flags;\n    StdTinyString tiny;\n    StdLargeString large;\n  };\n};\n\nstruct _ArtBacktrace\n{\n  GChecksum * id;\n  GArray * frames;\n  gchar * frames_json;\n};\n\nstruct _ArtStackFrame\n{\n  ArtMethod * method;\n  gsize dexpc;\n  StdString description;\n};\n\nstruct _ArtStackVisitorVTable\n{\n  void (* unused1) (void);\n  void (* unused2) (void);\n  bool (* visit) (ArtStackVisitor * visitor);\n};\n\nstruct _ArtStackVisitor\n{\n  ArtStackVisitorVTable * vtable;\n\n  guint8 padding[512];\n\n  ArtStackVisitorVTable vtable_storage;\n\n  ArtBacktrace * backtrace;\n};\n\nstruct _ArtMethod\n{\n  guint32 declaring_class;\n  guint32 access_flags;\n};\n\nextern GumTlsKey current_backtrace;\n\nextern void (* perform_art_thread_state_transition) (JNIEnv * env);\n\nextern ArtContext * art_make_context (ArtThread * thread);\n\nextern void art_stack_visitor_init (ArtStackVisitor * visitor, ArtThread * thread, void * context, StackWalkKind walk_kind,\n    size_t num_frames, bool check_suspended);\nextern void art_stack_visitor_walk_stack (ArtStackVisitor * visitor, bool include_transitions);\nextern ArtMethod * art_stack_visitor_get_method (ArtStackVisitor * visitor);\nextern void art_stack_visitor_describe_location (StdString * description, ArtStackVisitor * visitor);\nextern ArtMethod * translate_method (ArtMethod * method);\nextern void translate_location (ArtMethod * method, guint32 pc, const gchar ** source_file, gint32 * line_number);\nextern void get_class_location (StdString * result, ArtClass * klass);\nextern void cxx_delete (void * mem);\nextern unsigned long strtoul (const char * str, char ** endptr, int base);\n\nstatic bool visit_frame (ArtStackVisitor * visitor);\nstatic void art_stack_frame_destroy (ArtStackFrame * frame);\n\nstatic void append_jni_type_name (GString * s, const gchar * name, gsize length);\n\nstatic void std_string_destroy (StdString * str);\nstatic gchar * std_string_get_data (StdString * str);\n\nvoid\ninit (void)\n{\n  current_backtrace = gum_tls_key_new ();\n}\n\nvoid\nfinalize (void)\n{\n  gum_tls_key_free (current_backtrace);\n}\n\nArtBacktrace *\n_create (JNIEnv * env,\n         guint limit)\n{\n  ArtBacktrace * bt;\n\n  bt = g_new (ArtBacktrace, 1);\n  bt->id = g_checksum_new (G_CHECKSUM_SHA1);\n  bt->frames = (limit != 0)\n      ? g_array_sized_new (FALSE, FALSE, sizeof (ArtStackFrame), limit)\n      : g_array_new (FALSE, FALSE, sizeof (ArtStackFrame));\n  g_array_set_clear_func (bt->frames, (GDestroyNotify) art_stack_frame_destroy);\n  bt->frames_json = NULL;\n\n  gum_tls_key_set_value (current_backtrace, bt);\n\n  perform_art_thread_state_transition (env);\n\n  gum_tls_key_set_value (current_backtrace, NULL);\n\n  return bt;\n}\n\nvoid\n_on_thread_state_transition_complete (ArtThread * thread)\n{\n  ArtContext * context;\n  ArtStackVisitor visitor = {\n    .vtable_storage = {\n      .visit = visit_frame,\n    },\n  };\n\n  context = art_make_context (thread);\n\n  art_stack_visitor_init (&visitor, thread, context, STACK_WALK_SKIP_INLINED_FRAMES, 0, true);\n  visitor.vtable = &visitor.vtable_storage;\n  visitor.backtrace = gum_tls_key_get_value (current_backtrace);\n\n  art_stack_visitor_walk_stack (&visitor, false);\n\n  cxx_delete (context);\n}\n\nstatic bool\nvisit_frame (ArtStackVisitor * visitor)\n{\n  ArtBacktrace * bt = visitor->backtrace;\n  ArtStackFrame frame;\n  const gchar * description, * dexpc_part;\n\n  frame.method = art_stack_visitor_get_method (visitor);\n\n  art_stack_visitor_describe_location (&frame.description, visitor);\n\n  description = std_string_get_data (&frame.description);\n  if (strstr (description, \" '<\") != NULL)\n    goto skip;\n\n  dexpc_part = strstr (description, \" at dex PC 0x\");\n  if (dexpc_part == NULL)\n    goto skip;\n  frame.dexpc = strtoul (dexpc_part + 13, NULL, 16);\n\n  g_array_append_val (bt->frames, frame);\n\n  g_checksum_update (bt->id, (guchar *) &frame.method, sizeof (frame.method));\n  g_checksum_update (bt->id, (guchar *) &frame.dexpc, sizeof (frame.dexpc));\n\n  return true;\n\nskip:\n  std_string_destroy (&frame.description);\n  return true;\n}\n\nstatic void\nart_stack_frame_destroy (ArtStackFrame * frame)\n{\n  std_string_destroy (&frame->description);\n}\n\nvoid\n_destroy (ArtBacktrace * backtrace)\n{\n  g_free (backtrace->frames_json);\n  g_array_free (backtrace->frames, TRUE);\n  g_checksum_free (backtrace->id);\n  g_free (backtrace);\n}\n\nconst gchar *\n_get_id (ArtBacktrace * backtrace)\n{\n  return g_checksum_get_string (backtrace->id);\n}\n\nconst gchar *\n_get_frames (ArtBacktrace * backtrace)\n{\n  GArray * frames = backtrace->frames;\n  JsonBuilder * b;\n  guint i;\n  JsonNode * root;\n\n  if (backtrace->frames_json != NULL)\n    return backtrace->frames_json;\n\n  b = json_builder_new_immutable ();\n\n  json_builder_begin_array (b);\n\n  for (i = 0; i != frames->len; i++)\n  {\n    ArtStackFrame * frame = &g_array_index (frames, ArtStackFrame, i);\n    gchar * description, * ret_type, * paren_open, * paren_close, * arg_types, * token, * method_name, * class_name;\n    GString * signature;\n    gchar * cursor;\n    ArtMethod * translated_method;\n    StdString location;\n    gsize dexpc;\n    const gchar * source_file;\n    gint32 line_number;\n\n    description = std_string_get_data (&frame->description);\n\n    ret_type = strchr (description, '\\'') + 1;\n\n    paren_open = strchr (ret_type, '(');\n    paren_close = strchr (paren_open, ')');\n    *paren_open = '\\0';\n    *paren_close = '\\0';\n\n    arg_types = paren_open + 1;\n\n    token = strrchr (ret_type, '.');\n    *token = '\\0';\n\n    method_name = token + 1;\n\n    token = strrchr (ret_type, ' ');\n    *token = '\\0';\n\n    class_name = token + 1;\n\n    signature = g_string_sized_new (128);\n\n    append_jni_type_name (signature, class_name, method_name - class_name - 1);\n    g_string_append_c (signature, ',');\n    g_string_append (signature, method_name);\n    g_string_append (signature, \",(\");\n\n    if (arg_types != paren_close)\n    {\n      for (cursor = arg_types; cursor != NULL;)\n      {\n        gsize length;\n        gchar * next;\n\n        token = strstr (cursor, \", \");\n        if (token != NULL)\n        {\n          length = token - cursor;\n          next = token + 2;\n        }\n        else\n        {\n          length = paren_close - cursor;\n          next = NULL;\n        }\n\n        append_jni_type_name (signature, cursor, length);\n\n        cursor = next;\n      }\n    }\n\n    g_string_append_c (signature, ')');\n\n    append_jni_type_name (signature, ret_type, class_name - ret_type - 1);\n\n    translated_method = translate_method (frame->method);\n    dexpc = (translated_method == frame->method) ? frame->dexpc : 0;\n\n    get_class_location (&location, GSIZE_TO_POINTER (translated_method->declaring_class));\n\n    translate_location (translated_method, dexpc, &source_file, &line_number);\n\n    json_builder_begin_object (b);\n\n    json_builder_set_member_name (b, \"signature\");\n    json_builder_add_string_value (b, signature->str);\n\n    json_builder_set_member_name (b, \"origin\");\n    json_builder_add_string_value (b, std_string_get_data (&location));\n\n    json_builder_set_member_name (b, \"className\");\n    json_builder_add_string_value (b, class_name);\n\n    json_builder_set_member_name (b, \"methodName\");\n    json_builder_add_string_value (b, method_name);\n\n    json_builder_set_member_name (b, \"methodFlags\");\n    json_builder_add_int_value (b, translated_method->access_flags);\n\n    json_builder_set_member_name (b, \"fileName\");\n    json_builder_add_string_value (b, source_file);\n\n    json_builder_set_member_name (b, \"lineNumber\");\n    json_builder_add_int_value (b, line_number);\n\n    json_builder_end_object (b);\n\n    std_string_destroy (&location);\n    g_string_free (signature, TRUE);\n  }\n\n  json_builder_end_array (b);\n\n  root = json_builder_get_root (b);\n  backtrace->frames_json = json_to_string (root, FALSE);\n  json_node_unref (root);\n\n  return backtrace->frames_json;\n}\n\nstatic void\nappend_jni_type_name (GString * s,\n                      const gchar * name,\n                      gsize length)\n{\n  gchar shorty = '\\0';\n  gsize i;\n\n  switch (name[0])\n  {\n    case 'b':\n      if (strncmp (name, \"boolean\", length) == 0)\n        shorty = 'Z';\n      else if (strncmp (name, \"byte\", length) == 0)\n        shorty = 'B';\n      break;\n    case 'c':\n      if (strncmp (name, \"char\", length) == 0)\n        shorty = 'C';\n      break;\n    case 'd':\n      if (strncmp (name, \"double\", length) == 0)\n        shorty = 'D';\n      break;\n    case 'f':\n      if (strncmp (name, \"float\", length) == 0)\n        shorty = 'F';\n      break;\n    case 'i':\n      if (strncmp (name, \"int\", length) == 0)\n        shorty = 'I';\n      break;\n    case 'l':\n      if (strncmp (name, \"long\", length) == 0)\n        shorty = 'J';\n      break;\n    case 's':\n      if (strncmp (name, \"short\", length) == 0)\n        shorty = 'S';\n      break;\n    case 'v':\n      if (strncmp (name, \"void\", length) == 0)\n        shorty = 'V';\n      break;\n  }\n\n  if (shorty != '\\0')\n  {\n    g_string_append_c (s, shorty);\n\n    return;\n  }\n\n  if (length > 2 && name[length - 2] == '[' && name[length - 1] == ']')\n  {\n    g_string_append_c (s, '[');\n    append_jni_type_name (s, name, length - 2);\n\n    return;\n  }\n\n  g_string_append_c (s, 'L');\n\n  for (i = 0; i != length; i++)\n  {\n    gchar ch = name[i];\n    if (ch != '.')\n      g_string_append_c (s, ch);\n    else\n      g_string_append_c (s, '/');\n  }\n\n  g_string_append_c (s, ';');\n}\n\nstatic void\nstd_string_destroy (StdString * str)\n{\n  bool is_large = (str->flags & 1) != 0;\n  if (is_large)\n    cxx_delete (str->large.data);\n}\n\nstatic gchar *\nstd_string_get_data (StdString * str)\n{\n  bool is_large = (str->flags & 1) != 0;\n  return is_large ? str->large.data : str->tiny.data;\n}\n",{current_backtrace:Memory.alloc(Process.pointerSize),perform_art_thread_state_transition:r,art_make_context:n["art::Thread::GetLongJumpContext"]??n["art::Context::Create"],art_stack_visitor_init:n["art::StackVisitor::StackVisitor"],art_stack_visitor_walk_stack:n["art::StackVisitor::WalkStack"],art_stack_visitor_get_method:n["art::StackVisitor::GetMethod"],art_stack_visitor_describe_location:n["art::StackVisitor::DescribeLocation"],translate_method:C.replacedMethods.translate,translate_location:n["art::Monitor::TranslateLocation"],get_class_location:n["art::mirror::Class::GetLocation"],cxx_delete:n.$delete,strtoul:Process.getModuleByName("libc.so").getExportByName("strtoul")}),a=new NativeFunction(o._create,"pointer",["pointer","uint"],x),i=new NativeFunction(o._destroy,"void",["pointer"],x),s={exceptions:"propagate",scheduling:"exclusive"},c=new NativeFunction(o._get_id,"pointer",["pointer"],s),d=new NativeFunction(o._get_frames,"pointer",["pointer"],s),l=Le(e,t,o._on_thread_state_transition_complete);function u(e){i(e)}return o._performData=l,r.writePointer(l),o.backtrace=(e,t)=>{const n=a(e,t),r=new ge(n);return Script.bindWeak(r,u.bind(null,n)),r},o.getId=e=>c(e).readUtf8String(),o.getFrames=e=>JSON.parse(d(e).readUtf8String()),o}(e,r)),D.backtrace(r,n)}class ge{constructor(e){this.handle=e}get id(){return D.getId(this.handle)}get frames(){return D.getFrames(this.handle)}}export function revertGlobalPatches(){L.forEach((e=>{e.vtablePtr.writePointer(e.vtable),e.vtableCountPtr.writeS32(e.vtableCount)})),L.clear();for(const e of T.splice(0))e.deactivate();for(const e of I.splice(0))e.revert()}function fe(e){return ve(e,"art::jni::JniIdManager::DecodeMethodId")}function be(e){return ve(e,"art::jni::JniIdManager::DecodeFieldId")}function ve(e,t){const n=getApi(),r=v(n).offset,o=r.jniIdManager,a=r.jniIdsIndirection;if(null!==o&&null!==a){const r=n.artRuntime;if(0!==r.add(a).readInt()){const a=r.add(o).readPointer();return n[t](a,e)}}return e}const ke={ia32:function(e,t,n,r,o){const a=getArtThreadSpec(o).offset,i=getArtMethodSpec(o).offset;let s;return Memory.patchCode(e,128,(r=>{const o=new X86Writer(r,{pc:e}),c=new X86Relocator(t,o);o.putPushax(),o.putMovRegReg("ebp","esp"),o.putAndRegU32("esp",4294967280),o.putSubRegImm("esp",512),o.putBytes([15,174,4,36]),o.putMovRegFsU32Ptr("ebx",a.self),o.putCallAddressWithAlignedArguments(C.replacedMethods.findReplacementFromQuickCode,["eax","ebx"]),o.putTestRegReg("eax","eax"),o.putJccShortLabel("je","restore_registers","no-hint"),o.putMovRegOffsetPtrReg("ebp",28,"eax"),o.putLabel("restore_registers"),o.putBytes([15,174,12,36]),o.putMovRegReg("esp","ebp"),o.putPopax(),o.putJccShortLabel("jne","invoke_replacement","no-hint");do{s=c.readOne()}while(s<n&&!c.eoi);c.writeAll(),c.eoi||o.putJmpAddress(t.add(s)),o.putLabel("invoke_replacement"),o.putJmpRegOffsetPtr("eax",i.quickCode),o.flush()})),s},x64:function(e,t,n,r,o){const a=getArtThreadSpec(o).offset,i=getArtMethodSpec(o).offset;let s;return Memory.patchCode(e,256,(r=>{const o=new X86Writer(r,{pc:e}),c=new X86Relocator(t,o);o.putPushax(),o.putMovRegReg("rbp","rsp"),o.putAndRegU32("rsp",4294967280),o.putSubRegImm("rsp",512),o.putBytes([15,174,4,36]),o.putMovRegGsU32Ptr("rbx",a.self),o.putCallAddressWithAlignedArguments(C.replacedMethods.findReplacementFromQuickCode,["rdi","rbx"]),o.putTestRegReg("rax","rax"),o.putJccShortLabel("je","restore_registers","no-hint"),o.putMovRegOffsetPtrReg("rbp",64,"rax"),o.putLabel("restore_registers"),o.putBytes([15,174,12,36]),o.putMovRegReg("rsp","rbp"),o.putPopax(),o.putJccShortLabel("jne","invoke_replacement","no-hint");do{s=c.readOne()}while(s<n&&!c.eoi);c.writeAll(),c.eoi||o.putJmpAddress(t.add(s)),o.putLabel("invoke_replacement"),o.putJmpRegOffsetPtr("rdi",i.quickCode),o.flush()})),s},arm:function(e,t,n,r,o){const a=getArtMethodSpec(o).offset,i=t.and(m);let s;return Memory.patchCode(e,128,(r=>{const o=new ThumbWriter(r,{pc:e}),c=new ThumbRelocator(i,o);o.putPushRegs(["r1","r2","r3","r5","r6","r7","r8","r10","r11","lr"]),o.putBytes([45,237,16,10]),o.putSubRegRegImm("sp","sp",8),o.putStrRegRegOffset("r0","sp",0),o.putCallAddressWithArguments(C.replacedMethods.findReplacementFromQuickCode,["r0","r9"]),o.putCmpRegImm("r0",0),o.putBCondLabel("eq","restore_registers"),o.putStrRegRegOffset("r0","sp",0),o.putLabel("restore_registers"),o.putLdrRegRegOffset("r0","sp",0),o.putAddRegRegImm("sp","sp",8),o.putBytes([189,236,16,10]),o.putPopRegs(["lr","r11","r10","r8","r7","r6","r5","r3","r2","r1"]),o.putBCondLabel("ne","invoke_replacement");do{s=c.readOne()}while(s<n&&!c.eoi);c.writeAll(),c.eoi||o.putLdrRegAddress("pc",t.add(s)),o.putLabel("invoke_replacement"),o.putLdrRegRegOffset("pc","r0",a.quickCode),o.flush()})),s},arm64:function(e,t,n,{availableScratchRegs:r},o){const a=getArtMethodSpec(o).offset;let i;return Memory.patchCode(e,256,(o=>{const s=new Arm64Writer(o,{pc:e}),c=new Arm64Relocator(t,s);s.putPushRegReg("d0","d1"),s.putPushRegReg("d2","d3"),s.putPushRegReg("d4","d5"),s.putPushRegReg("d6","d7"),s.putPushRegReg("x1","x2"),s.putPushRegReg("x3","x4"),s.putPushRegReg("x5","x6"),s.putPushRegReg("x7","x20"),s.putPushRegReg("x21","x22"),s.putPushRegReg("x23","x24"),s.putPushRegReg("x25","x26"),s.putPushRegReg("x27","x28"),s.putPushRegReg("x29","lr"),s.putSubRegRegImm("sp","sp",16),s.putStrRegRegOffset("x0","sp",0),s.putCallAddressWithArguments(C.replacedMethods.findReplacementFromQuickCode,["x0","x19"]),s.putCmpRegReg("x0","xzr"),s.putBCondLabel("eq","restore_registers"),s.putStrRegRegOffset("x0","sp",0),s.putLabel("restore_registers"),s.putLdrRegRegOffset("x0","sp",0),s.putAddRegRegImm("sp","sp",16),s.putPopRegReg("x29","lr"),s.putPopRegReg("x27","x28"),s.putPopRegReg("x25","x26"),s.putPopRegReg("x23","x24"),s.putPopRegReg("x21","x22"),s.putPopRegReg("x7","x20"),s.putPopRegReg("x5","x6"),s.putPopRegReg("x3","x4"),s.putPopRegReg("x1","x2"),s.putPopRegReg("d6","d7"),s.putPopRegReg("d4","d5"),s.putPopRegReg("d2","d3"),s.putPopRegReg("d0","d1"),s.putBCondLabel("ne","invoke_replacement");do{i=c.readOne()}while(i<n&&!c.eoi);if(c.writeAll(),!c.eoi){const e=Array.from(r)[0];s.putLdrRegAddress(e,t.add(i)),s.putBrReg(e)}s.putLabel("invoke_replacement"),s.putLdrRegRegOffset("x16","x0",a.quickCode),s.putBrReg("x16"),s.flush()})),i}};const Se={ia32:Ee,x64:Ee,arm:function(e,t,n){const r=e.and(m);Memory.patchCode(r,16,(e=>{const n=new ThumbWriter(e,{pc:r});n.putLdrRegAddress("pc",t.or(1)),n.flush()}))},arm64:function(e,t,n){Memory.patchCode(e,16,(r=>{const o=new Arm64Writer(r,{pc:e});16===n?o.putLdrRegAddress("x16",t):o.putAdrpRegAddress("x16",t),o.putBrReg("x16"),o.flush()}))}};function Ee(e,t,n){Memory.patchCode(e,16,(n=>{const r=new X86Writer(n,{pc:e});r.putJmpAddress(t),r.flush()}))}const Ne={ia32:5,x64:16,arm:8,arm64:16};class Ae{constructor(e){this.quickCode=e,this.quickCodeAddress="arm"===Process.arch?e.and(m):e,this.redirectSize=0,this.trampoline=null,this.overwrittenPrologue=null,this.overwrittenPrologueLength=0}_canRelocateCode(e,t){const n=ce[Process.arch],r=se[Process.arch],{quickCodeAddress:o}=this,a=new r(o,new n(o));let i;if("arm64"===Process.arch){let n=new Set(["x16","x17"]);do{const e=a.readOne(),t=new Set(n),{read:r,written:o}=a.input.regsAccessed;for(const e of[r,o])for(const n of e){let e;e=n.startsWith("w")?"x"+n.substring(1):n,t.delete(e)}if(0===t.size)break;i=e,n=t}while(i<e&&!a.eoi);t.availableScratchRegs=n}else do{i=a.readOne()}while(i<e&&!a.eoi);return i>=e}_allocateTrampoline(){if(null===J){J=e(4===d?128:256)}const t=Ne[Process.arch];let n,r,o=1;const a={};if(4===d||this._canRelocateCode(t,a))n=t,r={};else{let e;"x64"===Process.arch?(n=5,e=2147467263):"arm64"===Process.arch&&(n=8,e=4294963200,o=4096),r={near:this.quickCodeAddress,maxDistance:e}}return this.redirectSize=n,this.trampoline=J.allocateSlice(r,o),a}_destroyTrampoline(){J.freeSlice(this.trampoline)}activate(e){const t=this._allocateTrampoline(),{trampoline:n,quickCode:r,redirectSize:o}=this,a=(0,ke[Process.arch])(n,r,o,t,e);this.overwrittenPrologueLength=a,this.overwrittenPrologue=Memory.dup(this.quickCodeAddress,a);(0,Se[Process.arch])(r,n,o)}deactivate(){const{quickCodeAddress:e,overwrittenPrologueLength:t}=this,n=ce[Process.arch];Memory.patchCode(e,t,(r=>{const o=new n(r,{pc:e}),{overwrittenPrologue:a}=this;o.putBytes(a.readByteArray(t)),o.flush()})),this._destroyTrampoline()}}class Re{constructor(e){const t=fe(e);this.methodId=t,this.originalMethod=null,this.hookedMethodId=t,this.replacementMethodId=null,this.interceptor=null}replace(e,t,n,r,o){const{kAccCompileDontBother:a,artNterpEntryPoint:i}=o;this.originalMethod=xe(this.methodId,r);const s=this.originalMethod.accessFlags;if(0!=(268435456&s)&&getAndroidApiLevel()<28){const e=this.originalMethod.jniCode;this.hookedMethodId=e.add(2*d).readPointer(),this.originalMethod=xe(this.hookedMethodId,r)}const{hookedMethodId:c}=this,l=function(e,t){const n=getApi();if(getAndroidApiLevel()<23){const t=n["art::Thread::CurrentFromGdb"]();return n["art::mirror::Object::Clone"](e,t)}return Memory.dup(e,getArtMethodSpec(t).size)}(c,r);this.replacementMethodId=l,we(l,{jniCode:e,accessFlags:(-3670017&s|256|a)>>>0,quickCode:o.artClassLinker.quickGenericJniTrampoline,interpreterCode:o.artInterpreterToCompiledCodeBridge},r);let u=1209008128;0==(256&s)&&(u|=524288),we(c,{accessFlags:(s&~u|a)>>>0},r);const p=this.originalMethod.quickCode;if(null!==i&&p.equals(i)&&we(c,{quickCode:o.artQuickToInterpreterBridge},r),!function(e){const t=getApi(),{module:n,artClassLinker:r}=t;return e.equals(r.quickGenericJniTrampoline)||e.equals(r.quickToInterpreterBridgeTrampoline)||e.equals(r.quickResolutionTrampoline)||e.equals(r.quickImtConflictTrampoline)||e.compare(n.base)>=0&&e.compare(n.base.add(n.size))<0}(p)){const e=new Ae(p);e.activate(r),this.interceptor=e}C.replacedMethods.set(c,l),le(0,r)}revert(e){const{hookedMethodId:t,interceptor:n}=this;we(t,this.originalMethod,e),C.replacedMethods.delete(t),null!==n&&(n.deactivate(),this.interceptor=null)}resolveTarget(e,t,n,r){return this.hookedMethodId}}function xe(e,t){const n=getArtMethodSpec(t).offset;return["jniCode","accessFlags","quickCode","interpreterCode"].reduce(((t,r)=>{const o=n[r];if(void 0===o)return t;const a=e.add(o),i="accessFlags"===r?l:u;return t[r]=i.call(a),t}),{})}function we(e,t,n){const r=getArtMethodSpec(n).offset;Object.keys(t).forEach((n=>{const o=r[n];if(void 0===o)return;const a=e.add(o);("accessFlags"===n?p:_).call(a,t[n])}))}class Pe{constructor(e){this.methodId=e,this.originalMethod=null}replace(e,t,n,r,o){const{methodId:a}=this;this.originalMethod=Memory.dup(a,56);let i=n.reduce(((e,t)=>e+t.size),0);t&&i++;const s=(256|a.add(4).readU32())>>>0,c=i,d=i;a.add(4).writeU32(s),a.add(10).writeU16(c),a.add(12).writeU16(0),a.add(14).writeU16(d),a.add(36).writeU32(function(e){if("ia32"!==Process.arch)return 2147483648;const t=e.add(28).readPointer().readCString();if(null===t||0===t.length||t.length>65535)return 2147483648;let n;switch(t[0]){case"V":n=0;break;case"F":n=1;break;case"D":n=2;break;case"J":n=3;break;case"Z":case"B":n=7;break;case"C":n=6;break;case"S":n=5;break;default:n=4}let r=0;for(let e=t.length-1;e>0;e--){const n=t[e];r+="D"===n||"J"===n?2:1}return n<<28|r}(a)),o.dvmUseJNIBridge(a,e)}revert(e){Memory.copy(this.methodId,this.originalMethod,56)}resolveTarget(e,t,n,r){const o=n.handle.add(12).readPointer();let a,i;if(t)a=r.dvmDecodeIndirectRef(o,e.$h);else{const t=e.$borrowClassHandle(n);a=r.dvmDecodeIndirectRef(o,t.value),t.unref(n)}i=t?a.add(0).readPointer():a;const s=i.toString(16);let c=L.get(s);if(void 0===c){const e=i.add(116),t=i.add(112),n=e.readPointer(),r=t.readS32(),o=r*d,a=Memory.alloc(2*o);Memory.copy(a,n,o),e.writePointer(a),c={classObject:i,vtablePtr:e,vtableCountPtr:t,vtable:n,vtableCount:r,shadowVtable:a,shadowVtableCount:r,targetMethods:new Map},L.set(s,c)}const l=this.methodId.toString(16);let u=c.targetMethods.get(l);if(void 0===u){u=Memory.dup(this.originalMethod,56);const e=c.shadowVtableCount++;c.shadowVtable.add(e*d).writePointer(u),u.add(8).writeU16(e),c.vtableCountPtr.writeS32(c.shadowVtableCount),c.targetMethods.set(l,u)}return u}}export function deoptimizeMethod(e,t,n){Me(e,t,5,n)}export function deoptimizeEverything(e,t){Me(e,t,3)}export function deoptimizeBootImage(e,t){const n=getApi();if(getAndroidApiLevel()<26)throw new Error("This API is only available on Android >= 8.0");withRunnableArtThread(e,t,(e=>{n["art::Runtime::DeoptimizeBootImage"](n.artRuntime)}))}function Me(e,t,n,r){const o=getApi();if(getAndroidApiLevel()<24)throw new Error("This API is only available on Android >= 7.0");withRunnableArtThread(e,t,(e=>{if(getAndroidApiLevel()<30){if(!o.isJdwpStarted()){const e=function(e){const t=new ye;e["art::Dbg::SetJdwpAllowed"](1);const n=function(){const e=getAndroidApiLevel()<28?2:3,t=e,n=!0,r=!1,o=0,a=8+f+2,i=Memory.alloc(a);return i.writeU32(t).add(4).writeU8(n?1:0).add(1).writeU8(r?1:0).add(1).add(f).writeU16(o),i}();e["art::Dbg::ConfigureJdwp"](n);const r=e["art::InternalDebuggerControlCallback::StartDebugger"];void 0!==r?r(NULL):e["art::Dbg::StartJdwp"]();return t}(o);Z.push(e)}o.isDebuggerActive()||o["art::Dbg::GoActive"]();const e=Memory.alloc(8+d);switch(e.writeU32(n),n){case 3:break;case 5:e.add(8).writePointer(r);break;default:throw new Error("Unsupported deoptimization kind")}o["art::Dbg::RequestDeoptimization"](e),o["art::Dbg::ManageDeoptimization"]()}else{const e=o.artInstrumentation;if(null===e)throw new Error("Unable to find Instrumentation class in ART; please file a bug");const t=o["art::Instrumentation::EnableDeoptimization"];if(void 0!==t){!!e.add(k().offset.deoptimizationEnabled).readU8()||t(e)}switch(n){case 3:o["art::Instrumentation::DeoptimizeEverything"](e,Memory.allocUtf8String("frida"));break;case 5:o["art::Instrumentation::Deoptimize"](e,r);break;default:throw new Error("Unsupported deoptimization kind")}}}))}class ye{constructor(){const e=Process.getModuleByName("libart.so"),t=e.getExportByName("_ZN3art4JDWP12JdwpAdbState6AcceptEv"),n=e.getExportByName("_ZN3art4JDWP12JdwpAdbState15ReceiveClientFdEv"),r=Ce(),o=Ce();this._controlFd=r[0],this._clientFd=o[0];let a=null;a=Interceptor.attach(t,(function(e){const t=e[0];Memory.scanSync(t.add(8252),256,"00 ff ff ff ff 00")[0].address.add(1).writeS32(r[1]),a.detach()})),Interceptor.replace(n,new NativeCallback((function(e){return Interceptor.revert(n),o[1]}),"int",["pointer"])),Interceptor.flush(),this._handshakeRequest=this._performHandshake()}async _performHandshake(){const e=new UnixInputStream(this._clientFd,{autoClose:!1}),t=new UnixOutputStream(this._clientFd,{autoClose:!1}),n=[74,68,87,80,45,72,97,110,100,115,104,97,107,101];try{await t.writeAll(n),await e.readAll(n.length)}catch(e){}}}function Ce(){null===V&&(V=new NativeFunction(Process.getModuleByName("libc.so").getExportByName("socketpair"),"int",["int","int","int","pointer"]));const e=Memory.alloc(8);if(-1===V(1,1,0,e))throw new Error("Unable to create socketpair for JDWP");return[e.readS32(),e.add(4).readS32()]}const Ie={ia32:Te,x64:Te,arm:function(e,t,n,r,o,a,i){const s={},c=new Set,d=ptr(1).not(),l=[n];for(;l.length>0;){let e=l.shift();const t=Object.values(s).some((({begin:t,end:n})=>e.compare(t)>=0&&e.compare(n)<0));if(t)continue;const n=e.and(d),o=n.toString(),a=e.and(1);let i={begin:n},u=null,p=!1,_=0;do{if(e.equals(r)){p=!0;break}const t=Instruction.parse(e),{mnemonic:n}=t;u=t;const m=e.and(d).toString(),h=s[m];if(void 0!==h){delete s[h.begin.toString()],s[o]=h,h.begin=i.begin,i=null;break}const g=0===_;let f=null;switch(n){case"b":f=ptr(t.operands[0].value),p=g;break;case"beq.w":case"beq":case"bne":case"bne.w":case"bgt":f=ptr(t.operands[0].value);break;case"cbz":case"cbnz":f=ptr(t.operands[1].value);break;case"pop.w":g&&(p=1===t.operands.filter((e=>"pc"===e.value)).length)}switch(n){case"it":_=1;break;case"itt":_=2;break;case"ittt":_=3;break;case"itttt":_=4;break;default:_>0&&_--}null!==f&&(c.add(f.toString()),l.push(f.or(a)),l.sort(((e,t)=>e.compare(t)))),e=t.next}while(!p);null!==i&&(i.end=u.address.add(u.size),s[o]=i)}const u=Object.keys(s).map((e=>s[e]));u.sort(((e,t)=>e.begin.compare(t.begin)));const p=s[n.and(d).toString()];u.splice(u.indexOf(p),1),u.unshift(p);const _=new ThumbWriter(e,{pc:t});let m=!1,g=null,f=null;u.forEach((e=>{const t=new ThumbRelocator(e.begin,_);let n=e.begin;const r=e.end;let s=0;do{if(0===t.readOne())throw new Error("Unexpected end of block");const e=t.input;n=e.address,s=e.size;const{mnemonic:r}=e,d=n.toString();c.has(d)&&_.putLabel(d);let l=!0;switch(r){case"b":_.putBLabel(ze(e.operands[0])),l=!1;break;case"beq.w":_.putBCondLabelWide("eq",ze(e.operands[0])),l=!1;break;case"bne.w":_.putBCondLabelWide("ne",ze(e.operands[0])),l=!1;break;case"beq":case"bne":case"bgt":_.putBCondLabelWide(r.substr(1),ze(e.operands[0])),l=!1;break;case"cbz":{const t=e.operands;_.putCbzRegLabel(t[0].value,ze(t[1])),l=!1;break}case"cbnz":{const t=e.operands;_.putCbnzRegLabel(t[0].value,ze(t[1])),l=!1;break}case"str":case"str.w":{const t=e.operands[1].value,n=t.disp;if(n===o){g=t.base;const e="r4"!==g?"r4":"r5",n=["r0","r1","r2","r3",e,"r9","r12","lr"];_.putPushRegs(n),_.putMrsRegReg(e,"apsr-nzcvq"),_.putCallAddressWithArguments(i,[g]),_.putMsrRegReg("apsr-nzcvq",e),_.putPopRegs(n),m=!0,l=!1}else a.has(n)&&t.base===g&&(l=!1);break}case"ldr":{const[t,n]=e.operands;if("mem"===n.type){const e=n.value;"r"===e.base[0]&&e.disp===h&&(f=t.value)}break}case"blx":e.operands[0].value===f&&(_.putLdrRegRegOffset("r0","r0",4),_.putCallAddressWithArguments(i,["r0"]),m=!0,f=null,l=!1)}l?t.writeAll():t.skipOne()}while(!n.add(s).equals(r));t.dispose()})),_.dispose(),m||je();return new NativeFunction(t.or(1),"void",["pointer"],x)},arm64:function(e,t,n,r,o,a,i){const s={},c=new Set,d=[n];for(;d.length>0;){let e=d.shift();if(Object.values(s).some((({begin:t,end:n})=>e.compare(t)>=0&&e.compare(n)<0)))continue;const t=e.toString();let n={begin:e},o=null,a=!1;do{if(e.equals(r)){a=!0;break}let i;try{i=Instruction.parse(e)}catch(t){if(0===e.readU32()){a=!0;break}throw t}o=i;const l=s[i.address.toString()];if(void 0!==l){delete s[l.begin.toString()],s[t]=l,l.begin=n.begin,n=null;break}let u=null;switch(i.mnemonic){case"b":u=ptr(i.operands[0].value),a=!0;break;case"b.eq":case"b.ne":case"b.le":case"b.gt":u=ptr(i.operands[0].value);break;case"cbz":case"cbnz":u=ptr(i.operands[1].value);break;case"tbz":case"tbnz":u=ptr(i.operands[2].value);break;case"ret":a=!0}null!==u&&(c.add(u.toString()),d.push(u),d.sort(((e,t)=>e.compare(t)))),e=i.next}while(!a);null!==n&&(n.end=o.address.add(o.size),s[t]=n)}const l=Object.keys(s).map((e=>s[e]));l.sort(((e,t)=>e.begin.compare(t.begin)));const u=s[n.toString()];l.splice(l.indexOf(u),1),l.unshift(u);const p=new Arm64Writer(e,{pc:t});p.putBLabel("performTransition");const _=t.add(p.offset);p.putPushAllXRegisters(),p.putCallAddressWithArguments(i,["x0"]),p.putPopAllXRegisters(),p.putRet(),p.putLabel("performTransition");let m=!1,g=null,f=null;l.forEach((e=>{const t=e.end.sub(e.begin).toInt32(),n=new Arm64Relocator(e.begin,p);let r;for(;0!==(r=n.readOne());){const e=n.input,{mnemonic:s}=e,d=e.address.toString();c.has(d)&&p.putLabel(d);let l=!0;switch(s){case"b":p.putBLabel(ze(e.operands[0])),l=!1;break;case"b.eq":case"b.ne":case"b.le":case"b.gt":p.putBCondLabel(s.substr(2),ze(e.operands[0])),l=!1;break;case"cbz":{const t=e.operands;p.putCbzRegLabel(t[0].value,ze(t[1])),l=!1;break}case"cbnz":{const t=e.operands;p.putCbnzRegLabel(t[0].value,ze(t[1])),l=!1;break}case"tbz":{const t=e.operands;p.putTbzRegImmLabel(t[0].value,t[1].value.valueOf(),ze(t[2])),l=!1;break}case"tbnz":{const t=e.operands;p.putTbnzRegImmLabel(t[0].value,t[1].value.valueOf(),ze(t[2])),l=!1;break}case"str":{const t=e.operands,n=t[0].value,r=t[1].value,i=r.disp;"xzr"===n&&i===o?(g=r.base,p.putPushRegReg("x0","lr"),p.putMovRegReg("x0",g),p.putBlImm(_),p.putPopRegReg("x0","lr"),m=!0,l=!1):a.has(i)&&r.base===g&&(l=!1);break}case"ldr":{const t=e.operands,n=t[1].value;"x"===n.base[0]&&n.disp===h&&(f=t[0].value);break}case"blr":e.operands[0].value===f&&(p.putLdrRegRegOffset("x0","x0",8),p.putCallAddressWithArguments(i,["x0"]),m=!0,f=null,l=!1)}if(l?n.writeAll():n.skipOne(),r===t)break}n.dispose()})),p.dispose(),m||je();return new NativeFunction(t,"void",["pointer"],x)}};function Le(e,t,n){const r=getApi(),o=t.handle.readPointer();let a;const i=r.find("_ZN3art3JNIILb1EE14ExceptionClearEP7_JNIEnv");let s;a=null!==i?i:o.add(h).readPointer();const c=r.find("_ZN3art3JNIILb1EE10FatalErrorEP7_JNIEnvPKc");s=null!==c?c:o.add(g).readPointer();const l=Ie[Process.arch];if(void 0===l)throw new Error("Not yet implemented for "+Process.arch);let u=null;const p=getArtThreadSpec(e).offset,_=p.exception,m=new Set,f=p.isExceptionReportedToInstrumentation;null!==f&&m.add(f);const b=p.throwLocation;null!==b&&(m.add(b),m.add(b+d),m.add(b+2*d));const v=Memory.alloc(65536);return Memory.patchCode(v,65536,(e=>{u=l(e,v,a,s,_,m,n)})),u._code=v,u._callback=n,u}function Te(e,t,n,r,o,a,i){const s={},c=new Set,l=[n];for(;l.length>0;){let e=l.shift();if(Object.values(s).some((({begin:t,end:n})=>e.compare(t)>=0&&e.compare(n)<0)))continue;const t=e.toString();let n={begin:e},o=null,a=!1;do{if(e.equals(r)){a=!0;break}const i=Instruction.parse(e);o=i;const d=s[i.address.toString()];if(void 0!==d){delete s[d.begin.toString()],s[t]=d,d.begin=n.begin,n=null;break}let u=null;switch(i.mnemonic){case"jmp":u=ptr(i.operands[0].value),a=!0;break;case"je":case"jg":case"jle":case"jne":case"js":u=ptr(i.operands[0].value);break;case"ret":a=!0}null!==u&&(c.add(u.toString()),l.push(u),l.sort(((e,t)=>e.compare(t)))),e=i.next}while(!a);null!==n&&(n.end=o.address.add(o.size),s[t]=n)}const u=Object.keys(s).map((e=>s[e]));u.sort(((e,t)=>e.begin.compare(t.begin)));const p=s[n.toString()];u.splice(u.indexOf(p),1),u.unshift(p);const _=new X86Writer(e,{pc:t});let m=!1,g=null;return u.forEach((e=>{const t=e.end.sub(e.begin).toInt32(),n=new X86Relocator(e.begin,_);let r;for(;0!==(r=n.readOne());){const e=n.input,{mnemonic:s}=e,l=e.address.toString();c.has(l)&&_.putLabel(l);let u=!0;switch(s){case"jmp":_.putJmpNearLabel(ze(e.operands[0])),u=!1;break;case"je":case"jg":case"jle":case"jne":case"js":_.putJccNearLabel(s,ze(e.operands[0]),"no-hint"),u=!1;break;case"mov":{const[t,n]=e.operands;if("mem"===t.type&&"imm"===n.type){const e=t.value,r=e.disp;if(r===o&&0===n.value.valueOf()){if(g=e.base,_.putPushfx(),_.putPushax(),_.putMovRegReg("xbp","xsp"),4===d)_.putAndRegU32("esp",4294967280);else{const e="rdi"!==g?"rdi":"rsi";_.putMovRegU64(e,uint64("0xfffffffffffffff0")),_.putAndRegReg("rsp",e)}_.putCallAddressWithAlignedArguments(i,[g]),_.putMovRegReg("xsp","xbp"),_.putPopax(),_.putPopfx(),m=!0,u=!1}else a.has(r)&&e.base===g&&(u=!1)}break}case"call":{const t=e.operands[0];"mem"===t.type&&t.value.disp===h&&(4===d?(_.putPopReg("eax"),_.putMovRegRegOffsetPtr("eax","eax",4),_.putPushReg("eax")):_.putMovRegRegOffsetPtr("rdi","rdi",8),_.putCallAddressWithArguments(i,[]),m=!0,u=!1);break}}if(u?n.writeAll():n.skipOne(),r===t)break}n.dispose()})),_.dispose(),m||je(),new NativeFunction(t,"void",["pointer"],x)}function je(){throw new Error("Unable to parse ART internals; please file a bug")}function ze(e){return ptr(e.value).toString()}function Oe(e,t){const{arch:n}=Process;switch(n){case"ia32":case"arm64":{let r;r="ia32"===n?de(64,(n=>{const r=1+t.length,o=4*r;n.putSubRegImm("esp",o);for(let e=0;e!==r;e++){const t=4*e;n.putMovRegRegOffsetPtr("eax","esp",o+4+t),n.putMovRegOffsetPtrReg("esp",t,"eax")}n.putCallAddress(e),n.putAddRegImm("esp",o-4),n.putRet()})):de(32,(n=>{n.putMovRegReg("x8","x0"),t.forEach(((e,t)=>{n.putMovRegReg("x"+t,"x"+(t+1))})),n.putLdrRegAddress("x7",e),n.putBrReg("x7")}));const o=new NativeFunction(r,"void",["pointer"].concat(t),x),a=function(...e){o(...e)};return a.handle=r,a.impl=e,a}default:{const n=new NativeFunction(e,"void",["pointer"].concat(t),x);return n.impl=e,n}}}class Fe{constructor(){this.handle=Memory.alloc(f)}dispose(){const[e,t]=this._getData();t||getApi().$delete(e)}disposeToString(){const e=this.toString();return this.dispose(),e}toString(){const[e]=this._getData();return e.readUtf8String()}_getData(){const e=this.handle,t=0==(1&e.readU8());return[t?e.add(1):e.add(2*d).readPointer(),t]}}export class HandleVector extends class{$delete(){this.dispose(),getApi().$delete(this)}constructor(e,t){this.handle=e,this._begin=e,this._end=e.add(d),this._storage=e.add(2*d),this._elementSize=t}init(){this.begin=NULL,this.end=NULL,this.storage=NULL}dispose(){getApi().$delete(this.begin)}get begin(){return this._begin.readPointer()}set begin(e){this._begin.writePointer(e)}get end(){return this._end.readPointer()}set end(e){this._end.writePointer(e)}get storage(){return this._storage.readPointer()}set storage(e){this._storage.writePointer(e)}get size(){return this.end.sub(this.begin).toInt32()/this._elementSize}}{static $new(){const e=new HandleVector(getApi().$new(b));return e.init(),e}constructor(e){super(e,d)}get handles(){const e=[];let t=this.begin;const n=this.end;for(;!t.equals(n);)e.push(t.readPointer()),t=t.add(d);return e}}const De=d,Ze=De+4;class Ve{$delete(){this.dispose(),getApi().$delete(this)}constructor(e){this.handle=e,this._link=e.add(0),this._numberOfReferences=e.add(De)}init(e,t){this.link=e,this.numberOfReferences=t}dispose(){}get link(){return new Ve(this._link.readPointer())}set link(e){this._link.writePointer(e)}get numberOfReferences(){return this._numberOfReferences.readS32()}set numberOfReferences(e){this._numberOfReferences.writeS32(e)}}const Je=function(e){const t=e%d;if(0!==t)return e+d-t;return e}(Ze),Ue=Je+d,Ge=Ue+d;export class VariableSizedHandleScope extends Ve{static $new(e,t){const n=new VariableSizedHandleScope(getApi().$new(Ge));return n.init(e,t),n}constructor(e){super(e),this._self=e.add(Je),this._currentScope=e.add(Ue);const t=(64-d-4-4)/4;this._scopeLayout=Be.layoutForCapacity(t),this._topHandleScopePtr=null}init(e,t){const n=e.add(getArtThreadSpec(t).offset.topHandleScope);this._topHandleScopePtr=n,super.init(n.readPointer(),-1),this.self=e,this.currentScope=Be.$new(this._scopeLayout),n.writePointer(this)}dispose(){let e;for(this._topHandleScopePtr.writePointer(this.link);null!==(e=this.currentScope);){const t=e.link;e.$delete(),this.currentScope=t}}get self(){return this._self.readPointer()}set self(e){this._self.writePointer(e)}get currentScope(){const e=this._currentScope.readPointer();return e.isNull()?null:new Be(e,this._scopeLayout)}set currentScope(e){this._currentScope.writePointer(e)}newHandle(e){return this.currentScope.newHandle(e)}}class Be extends Ve{static $new(e){const t=new Be(getApi().$new(e.size),e);return t.init(),t}constructor(e,t){super(e);const{offset:n}=t;this._refsStorage=e.add(n.refsStorage),this._pos=e.add(n.pos),this._layout=t}init(){super.init(NULL,this._layout.numberOfReferences),this.pos=0}get pos(){return this._pos.readU32()}set pos(e){this._pos.writeU32(e)}newHandle(e){const t=this.pos,n=this._refsStorage.add(4*t);return n.writeS32(e.toInt32()),this.pos=t+1,n}static layoutForCapacity(e){const t=Ze+4*e;return{size:t+4,numberOfReferences:e,offset:{refsStorage:Ze,pos:t}}}}const qe={arm:function(e,t){const n=Process.pageSize,r=Memory.alloc(n);Memory.protect(r,n,"rwx");const o=new NativeCallback(t,"void",["pointer"]);r._onMatchCallback=o;const a=[26625,18947,17041,53505,19202,18200,18288,48896],i=2*a.length,s=i+4,c=s+4;return Memory.patchCode(r,c,(function(t){a.forEach(((e,n)=>{t.add(2*n).writeU16(e)})),t.add(i).writeS32(e),t.add(s).writePointer(o)})),r.or(1)},arm64:function(e,t){const n=Process.pageSize,r=Memory.alloc(n);Memory.protect(r,n,"rwx");const o=new NativeCallback(t,"void",["pointer"]);r._onMatchCallback=o;const a=[3107979265,402653378,1795293247,1409286241,1476395139,3592355936,3596551104],i=4*a.length,s=i+4,c=s+8;return Memory.patchCode(r,c,(function(t){a.forEach(((e,n)=>{t.add(4*n).writeU32(e)})),t.add(i).writeS32(e),t.add(s).writePointer(o)})),r}};export function makeObjectVisitorPredicate(e,t){return(qe[Process.arch]||We)(e,t)}function We(e,t){return new NativeCallback((n=>{n.readS32()===e&&t(n)}),"void",["pointer","pointer"])}
âœ„
{"version":3,"file":"api.js","names":["androidGetApi","getAndroidVersion","jvmGetApi","getApi","e"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"iBAAmBA,uBAAeC,MAAyB,gCACxCC,MAAiB,WACpC,IAAIC,EAASH,EACb,IACEC,GAGF,CAFE,MAAOG,GACPD,EAASD,CACX,gBACeC","ignoreList":[]}
âœ„
import{getApi as t,getAndroidVersion as r}from"./android.js";import{getApi as o}from"./jvm.js";let a=t;try{r()}catch(t){a=o}export default a;
âœ„
{"version":3,"file":"class-factory.js","names":["Env","android","jvmEnsureClassInitialized","jvmMakeMethodMangler","ClassModel","LRU","mkdex","getType","getPrimitiveType","getArrayType","makeJniObjectTypeName","ensureClassInitialized","makeMethodMangler","PENDING_USE","Symbol","getCurrentThreadId","pointerSize","Process","factoryCache","state","factories","loaders","Integer","vm","api","isArtVm","wrapperHandler","dispatcherPrototype","methodPrototype","valueOfPrototype","cachedLoaderInvoke","cachedLoaderMethod","ignoredThreads","Map","ClassFactory","static","_vm","_api","flavor","env","forEach","factory","_dispose","classLoader","cache","defaultFactory","HashMap","use","$new","loader","addFactoryToCache","Thread","sleep","getFactoryCache","indexObj","get","index","cast","intValue","cacheDir","constructor","this","codeCacheDir","DEFAULT_CACHE_DIR","tempFileNaming","prefix","suffix","_classes","_classHandles","releaseClassHandle","_patchedMethods","Set","_loader","_types","push","Array","from","method","implementation","clear","revertGlobalPatches","dispose","value","isInitial","className","options","allowCached","C","_getUsedClass","undefined","getEnv","getClassHandle","usedLoader","callerEnv","vaMethod","loadClass","overload","handle","classNameValue","newStringUtf","tid","ignore","result","$h","throwIfExceptionPending","unignore","deleteLocalRef","makeLoaderClassHandleGetter","canonicalClassName","replace","findClass","makeBasicClassHandleGetter","_make","_setUsedClass","c","name","strategy","owned","Wrapper","call","proto","Object","create","prototype","for","$n","$C","writable","$w","set","val","$_s","$c","$m","$l","$gch","$f","classWrapper","h","$borrowClassHandle","classHandle","build","unref","retain","obj","$clone","klass","isInstanceOf","Error","getObjectClassName","wrap","wrapper","$r","Script","bindWeak","makeHandleDestructor","array","type","elements","primitiveType","arrayType","rawArray","toJni","fromJni","registerClass","spec","tempHandles","Class","Method","javaLangReflectMethod","invokeObjectMethodNoArgs","interfaces","implements","superClass","dexFields","dexMethods","dexSpec","sourceFileName","makeSourceFileName","map","iface","fields","methods","allInterfaces","slice","class","getInterfaces","baseIface","baseIfaceName","getCanonicalName","getOwnPropertyNames","fieldType","_getType","baseMethods","pendingOverloads","ifaceHandle","$ownMembers","filter","overloads","overloadIds","makeOverloadId","returnType","argumentTypes","id","methodEntries","keys","reduce","entry","rawName","e","implMethods","methodValue","impl","thrownTypeNames","m","isArray","baseMethod","parentTypeHandle","length","reflectedMethod","toReflectedMethod","thrownTypes","getGenericExceptionTypes","readTypeNames","isStatic","pendingOverload","returnTypeName","argumentTypeNames","t","signature","join","unimplementedMethodIds","dex","DexFile","fromBuffer","load","file","delete","numMethods","methodElementSize","methodElements","Memory","alloc","nativeMethods","temporaryHandles","allocUtf8String","rawSignature","rawImpl","implement","add","writePointer","registerNatives","$nativeMethods","choose","specifier","callbacks","_chooseObjectsJvm","legacyApiMissing","withRunnableArtThread","thread","_chooseObjectsArtPreA12","_chooseObjectsArtLegacy","_chooseObjectsDalvik","jvmti","tag","int64","toString","heapObjectCallback","NativeCallback","classTag","size","tagPtr","userData","writeS64","iterateOverInstancesOfClass","countPtr","objectsPtr","getObjectsWithTags","NULL","count","readS32","objects","readPointer","handles","i","deallocate","instance","onMatch","onComplete","scope","VariableSizedHandleScope","needle","object","newHandle","instances","HandleVector","artHeap","instanceHandles","newGlobalRef","$delete","deleteGlobalRef","addGlobalReference","vmHandle","toInt32","collectMatchingInstanceHandles","makeObjectVisitorPredicate","addLocalReference","libdvm","getModuleByName","pattern","arch","scan","base","address","or","NativeFunction","thunk","pageSize","patchCode","code","cw","X86Writer","pc","putMovRegRegOffsetPtr","putJmpAddress","flush","_thunk","perform","enumerateInstances","onError","reason","DVM_JNI_ENV_OFFSET_SELF","ptrClassObject","dvmDecodeIndirectRef","toMatchPattern","heapSourceBase","dvmHeapSourceGetBase","dvmHeapSourceGetLimit","sub","dvmIsValidObject","localReference","openClassFile","filePath","typeName","unbox","$t","Proxy","ClassHandle","refs","makeMethodDispatcher","invoke","arguments","makeMethodDispatcherCallable","setPrototypeOf","_o","throwIfDispatcherAmbiguous","dispatcher","throwOverloadError","methodName","message","sort","a","b","makeMethod","methodId","retType","argTypes","invocationOptions","rawRetType","rawArgTypes","callVirtually","callDirectly","nonvirtualVaMethod","staticVaMethod","params","makeMethodCallable","_p","makeMethodInstance","handler","fallback","pendingCalls","f","handleMethodInvocation","concat","_c","jniArgs","ownedObjects","self","pushLocalFrame","haveFrame","link","fn","has","args","numArgs","retval","apply","isCompatible","jniRetval","popLocalFrame","jniException","throw","nextTick","defaultValue","unlink","$dispose","Field","target","property","$has","receiver","startsWith","unwrap","$find","ownKeys","$list","getOwnPropertyDescriptor","hasOwnProperty","configurable","enumerable","defineProperties","$getCtor","allocObject","$alloc","$init","ref","unbindWeak","$className","list","$s","$super","getPrototypeOf","superWrapper","superHandle","getSuperclass","isNull","superClassName","getClassName","getSuperClassHandle","isSameObject","$isSameObject","slot","ctor","lastIndexOf","basename","javaLangClass","Constructor","javaLangReflectConstructor","invokeUInt8MethodNoArgs","jsCtorMethods","jsInitMethods","jsRetType","jsVoidType","constructors","getDeclaredConstructors","n","getArrayLength","types","getObjectArrayElement","fromReflectedMethod","getGenericParameterTypes","jsArgTypes","isInterface","defaultClass","javaLangObject","defaultConstructor","getMethodId","allocAndInit","initOnly","makeConstructor","classHandles","newLocalRef","$copyClassHandle","$getHandle","superMembers","model","member","members","find","split","ptr","substr","isVarArgs","getGenericReturnType","getTypeName","getParameterTypes","argClassName","getArrayTypeName","argType","holder","some","makeValueOfMethod","ensureDefaultValueOfImplemented","makeMethodFromSpec","field","toReflectedField","javaLangReflectField","getGenericType","rtype","getValue","setValue","rtypeJni","getStaticField","setStaticField","getField","setField","makeFieldFromSpec","makeMember","wrapperName","actualName","toJSON","Function","canInvokeWith","clone","isInstance","replacement","_r","existingReplacement","_m","revert","mangler","every","isInstanceMethod","frameCapacity","borrowedHandle","jniThis","resolveTarget","jniCall","splice","jniValue","fieldReturnType","inlineString","l","indexOf","buffer","fileValue","createTemporaryDex","getCanonicalPath","File","write","close","JFile","setWritable","setReadOnlyDex","path","_factory","DexClassLoader","exists","mkdirs","preventDetachDueToClassLoader","getClassNames","optimizedDex","classNames","enumeratorClassNames","loadDex","entries","hasMoreElements","nextElement","cacheDirValue","createTempFile","put","getParent","containsKey","threadId","names","tokens"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"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","ignoreList":[]}
âœ„
import e from"./env.js";import*as t from"./android.js";import{ensureClassInitialized as n,makeMethodMangler as r}from"./jvm.js";import o from"./class-model.js";import s from"./lru.js";import l from"./mkdex.js";import{getType as a,getPrimitiveType as i,getArrayType as c,makeJniObjectTypeName as u}from"./types.js";let{ensureClassInitialized:h,makeMethodMangler:f}=t;const d=Symbol("PENDING_USE"),{getCurrentThreadId:m,pointerSize:p}=Process,y={state:"empty",factories:[],loaders:null,Integer:null};let g=null,b=null,v=null,$=null,w=null,_=null,S=null,C=null,j=null;const E=new Map;export default class T{static _initialize(e,t){g=e,b=t,v="art"===t.flavor,"jvm"===t.flavor&&(h=n,f=r)}static _disposeAll(e){y.factories.forEach((t=>{t._dispose(e)}))}static get(e){const t=function(){switch(y.state){case"empty":{y.state="pending";const e=y.factories[0],t=e.use("java.util.HashMap"),n=e.use("java.lang.Integer");y.loaders=t.$new(),y.Integer=n;const r=e.loader;return null!==r&&J(e,r),y.state="ready",y}case"pending":do{Thread.sleep(.05)}while("pending"===y.state);return y;case"ready":return y}}(),n=t.factories[0];if(null===e)return n;const r=t.loaders.get(e);if(null!==r){const e=n.cast(r,t.Integer);return t.factories[e.intValue()]}const o=new T;return o.loader=e,o.cacheDir=n.cacheDir,J(o,e),o}constructor(){this.cacheDir="/data/local/tmp",this.codeCacheDir="/data/local/tmp/dalvik-cache",this.tempFileNaming={prefix:"frida",suffix:""},this._classes={},this._classHandles=new s(10,M),this._patchedMethods=new Set,this._loader=null,this._types=[{},{}],y.factories.push(this)}_dispose(e){Array.from(this._patchedMethods).forEach((e=>{e.implementation=null})),this._patchedMethods.clear(),t.revertGlobalPatches(),this._classHandles.dispose(e),this._classes={}}get loader(){return this._loader}set loader(e){const t=null===this._loader&&null!==e;this._loader=e,t&&"ready"===y.state&&this===y.factories[0]&&J(this,e)}use(e,t={}){const n="skip"!==t.cache;let r=n?this._getUsedClass(e):void 0;if(void 0===r)try{const t=g.getEnv(),{_loader:o}=this,s=null!==o?function(e,t,n){null===j&&(C=n.vaMethod("pointer",["pointer"]),j=t.loadClass.overload("java.lang.String").handle);return n=null,function(n){const r=n.newStringUtf(e),o=m();G(o);try{const e=C(n.handle,t.$h,j,r);return n.throwIfExceptionPending(),e}finally{U(o),n.deleteLocalRef(r)}}}(e,o,t):function(e){const t=e.replace(/\./g,"/");return function(e){const n=m();G(n);try{return e.findClass(t)}finally{U(n)}}}(e);r=this._make(e,s,t)}finally{n&&this._setUsedClass(e,r)}return r}_getUsedClass(e){let t;for(;(t=this._classes[e])===d;)Thread.sleep(.05);return void 0===t&&(this._classes[e]=d),t}_setUsedClass(e,t){void 0!==t?this._classes[e]=t:delete this._classes[e]}_make(e,t,n){const r=function(e,t,n,r){return O.call(this,e,t,n,r)},s=Object.create(O.prototype,{[Symbol.for("n")]:{value:e},$n:{get(){return this[Symbol.for("n")]}},[Symbol.for("C")]:{value:r},$C:{get(){return this[Symbol.for("C")]}},[Symbol.for("w")]:{value:null,writable:!0},$w:{get(){return this[Symbol.for("w")]},set(e){this[Symbol.for("w")]=e}},[Symbol.for("_s")]:{writable:!0},$_s:{get(){return this[Symbol.for("_s")]},set(e){this[Symbol.for("_s")]=e}},[Symbol.for("c")]:{value:[null]},$c:{get(){return this[Symbol.for("c")]}},[Symbol.for("m")]:{value:new Map},$m:{get(){return this[Symbol.for("m")]}},[Symbol.for("l")]:{value:null,writable:!0},$l:{get(){return this[Symbol.for("l")]},set(e){this[Symbol.for("l")]=e}},[Symbol.for("gch")]:{value:t},$gch:{get(){return this[Symbol.for("gch")]}},[Symbol.for("f")]:{value:this},$f:{get(){return this[Symbol.for("f")]}}});r.prototype=s;const l=new r(null);s[Symbol.for("w")]=l,s.$w=l;const a=l.$borrowClassHandle(n);try{const e=a.value;h(n,e),s.$l=o.build(e,n)}finally{a.unref(n)}return l}retain(e){const t=g.getEnv();return e.$clone(t)}cast(e,t,n){const r=g.getEnv();let o=e.$h;void 0===o&&(o=e);const s=t.$borrowClassHandle(r);try{if(!r.isInstanceOf(o,s.value))throw new Error(`Cast from '${r.getObjectClassName(o)}' to '${t.$n}' isn't possible`)}finally{s.unref(r)}return new(0,t.$C)(o,1,r,n)}wrap(e,t,n){const r=new(0,t.$C)(e,1,n,!1);return r.$r=Script.bindWeak(r,g.makeHandleDestructor(e)),r}array(e,t){const n=g.getEnv(),r=i(e);null!==r&&(e=r.name);const o=c("["+e,!1,this),s=o.toJni(t,n);return o.fromJni(s,n,!0)}registerClass(e){const t=g.getEnv(),n=[];try{const r=this.use("java.lang.Class"),o=t.javaLangReflectMethod(),s=t.vaMethod("pointer",[]),a=e.name,i=e.implements||[],c=e.superClass||this.use("java.lang.Object"),h=[],f=[],d={name:u(a),sourceFileName:W(a),superClass:u(c.$n),interfaces:i.map((e=>u(e.$n))),fields:h,methods:f},m=i.slice();i.forEach((e=>{Array.prototype.slice.call(e.class.getInterfaces()).forEach((e=>{const t=this.cast(e,r).getCanonicalName();m.push(this.use(t))}))}));const y=e.fields||{};Object.getOwnPropertyNames(y).forEach((e=>{const t=this._getType(y[e]);h.push([e,t.name])}));const g={},b={};m.forEach((e=>{const r=e.$borrowClassHandle(t);n.push(r);const o=r.value;e.$ownMembers.filter((t=>void 0!==e[t].overloads)).forEach((t=>{const n=e[t],r=n.overloads,s=r.map((e=>R(t,e.returnType,e.argumentTypes)));g[t]=[n,s,o],r.forEach(((e,t)=>{const n=s[t];b[n]=[e,o]}))}))}));const v=e.methods||{},$=Object.keys(v).reduce(((e,t)=>{const n=v[t],r="$init"===t?"<init>":t;return n instanceof Array?e.push(...n.map((e=>[r,e]))):e.push([r,n]),e}),[]),w=[];$.forEach((([e,n])=>{let r,l,a,i=3,c=[];if("function"==typeof n){const h=g[e];if(void 0!==h&&Array.isArray(h)){const[f,d,m]=h;if(d.length>1)throw new Error(`More than one overload matching '${e}': signature must be specified`);delete b[d[0]];const p=f.overloads[0];i=p.type,r=p.returnType,l=p.argumentTypes,a=n;const y=t.toReflectedMethod(m,p.handle,0),g=s(t.handle,y,o.getGenericExceptionTypes);c=V(t,g).map(u),t.deleteLocalRef(g),t.deleteLocalRef(y)}else r=this._getType("void"),l=[],a=n}else{if(n.isStatic&&(i=2),r=this._getType(n.returnType||"void"),l=(n.argumentTypes||[]).map((e=>this._getType(e))),a=n.implementation,"function"!=typeof a)throw new Error("Expected a function implementation for method: "+e);const h=R(e,r,l),f=b[h];if(void 0!==f){const[e,n]=f;delete b[h],i=e.type,r=e.returnType,l=e.argumentTypes;const a=t.toReflectedMethod(n,e.handle,0),d=s(t.handle,a,o.getGenericExceptionTypes);c=V(t,d).map(u),t.deleteLocalRef(d),t.deleteLocalRef(a)}}const h=r.name,d=l.map((e=>e.name)),m="("+d.join("")+")"+h;f.push([e,h,d,c,2===i?8:0]),w.push([e,m,i,r,l,a])}));const _=Object.keys(b);if(_.length>0)throw new Error("Missing implementation for: "+_.join(", "));const S=A.fromBuffer(l(d),this);try{S.load()}finally{S.file.delete()}const C=this.use(e.name),j=$.length;if(j>0){const e=3*p,r=Memory.alloc(j*e),o=[],s=[];w.forEach((([t,n,l,a,i,c],u)=>{const h=Memory.allocUtf8String(t),f=Memory.allocUtf8String(n),d=I(t,C,l,a,i,c);r.add(u*e).writePointer(h),r.add(u*e+p).writePointer(f),r.add(u*e+2*p).writePointer(d),s.push(h,f),o.push(d)}));const l=C.$borrowClassHandle(t);n.push(l);const a=l.value;t.registerNatives(a,r,j),t.throwIfExceptionPending(),C.$nativeMethods=o}return C}finally{n.forEach((e=>{e.unref(t)}))}}choose(e,n){const r=g.getEnv(),{flavor:o}=b;if("jvm"===o)this._chooseObjectsJvm(e,r,n);else if("art"===o){const o=void 0===b["art::gc::Heap::VisitObjects"];if(o){if(void 0===b["art::gc::Heap::GetInstances"])return this._chooseObjectsJvm(e,r,n)}t.withRunnableArtThread(g,r,(t=>{o?this._chooseObjectsArtPreA12(e,r,t,n):this._chooseObjectsArtLegacy(e,r,t,n)}))}else this._chooseObjectsDalvik(e,r,n)}_chooseObjectsJvm(e,t,n){const r=this.use(e),{jvmti:o}=b,s=r.$borrowClassHandle(t),l=int64(s.value.toString());try{const e=new NativeCallback(((e,t,n,r)=>(n.writeS64(l),1)),"int",["int64","int64","pointer","pointer"]);o.iterateOverInstancesOfClass(s.value,3,e,s.value);const a=Memory.alloc(8);a.writeS64(l);const i=Memory.alloc(4),c=Memory.alloc(p);o.getObjectsWithTags(1,a,i,c,NULL);const u=i.readS32(),h=c.readPointer(),f=[];for(let e=0;e!==u;e++)f.push(h.add(e*p).readPointer());o.deallocate(h);try{for(const e of f){const t=this.cast(e,r);if("stop"===n.onMatch(t))break}n.onComplete()}finally{f.forEach((e=>{t.deleteLocalRef(e)}))}}finally{s.unref(t)}}_chooseObjectsArtPreA12(e,n,r,o){const s=this.use(e),l=t.VariableSizedHandleScope.$new(r,g);let a;const i=s.$borrowClassHandle(n);try{const e=b["art::JavaVMExt::DecodeGlobal"](b.vm,r,i.value);a=l.newHandle(e)}finally{i.unref(n)}const c=t.HandleVector.$new();b["art::gc::Heap::GetInstances"](b.artHeap,l,a,0,c);const u=c.handles.map((e=>n.newGlobalRef(e)));c.$delete(),l.$delete();try{for(const e of u){const t=this.cast(e,s);if("stop"===o.onMatch(t))break}o.onComplete()}finally{u.forEach((e=>{n.deleteGlobalRef(e)}))}}_chooseObjectsArtLegacy(e,n,r,o){const s=this.use(e),l=[],a=b["art::JavaVMExt::AddGlobalRef"],i=b.vm;let c;const u=s.$borrowClassHandle(n);try{c=b["art::JavaVMExt::DecodeGlobal"](i,r,u.value).toInt32()}finally{u.unref(n)}const h=t.makeObjectVisitorPredicate(c,(e=>{l.push(a(i,r,e))}));b["art::gc::Heap::VisitObjects"](b.artHeap,h,NULL);try{for(const e of l){const t=this.cast(e,s);if("stop"===o.onMatch(t))break}}finally{l.forEach((e=>{n.deleteGlobalRef(e)}))}o.onComplete()}_chooseObjectsDalvik(e,n,r){const o=this.use(e);if(null===b.addLocalReference){const e=Process.getModuleByName("libdvm.so");let t;switch(Process.arch){case"arm":t="2d e9 f0 41 05 46 15 4e 0c 46 7e 44 11 b3 43 68";break;case"ia32":t="8d 64 24 d4 89 5c 24 1c 89 74 24 20 e8 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 d2"}Memory.scan(e.base,e.size,t,{onMatch:(e,t)=>{let n;if("arm"===Process.arch)e=e.or(1),n=new NativeFunction(e,"pointer",["pointer","pointer"]);else{const t=Memory.alloc(Process.pageSize);Memory.patchCode(t,16,(n=>{const r=new X86Writer(n,{pc:t});r.putMovRegRegOffsetPtr("eax","esp",4),r.putMovRegRegOffsetPtr("edx","esp",8),r.putJmpAddress(e),r.flush()})),n=new NativeFunction(t,"pointer",["pointer","pointer"]),n._thunk=t}return b.addLocalReference=n,g.perform((e=>{s(this,e)})),"stop"},onError(e){},onComplete(){null===b.addLocalReference&&r.onComplete()}})}else s(this,n);function s(e,n){const{DVM_JNI_ENV_OFFSET_SELF:s}=t,l=n.handle.add(s).readPointer();let a;const i=o.$borrowClassHandle(n);try{a=b.dvmDecodeIndirectRef(l,i.value)}finally{i.unref(n)}const c=a.toMatchPattern(),u=b.dvmHeapSourceGetBase(),h=b.dvmHeapSourceGetLimit().sub(u).toInt32();Memory.scan(u,h,c,{onMatch:(t,n)=>{b.dvmIsValidObject(t)&&g.perform((n=>{const l=n.handle.add(s).readPointer();let a;const i=b.addLocalReference(l,t);try{a=e.cast(i,o)}finally{n.deleteLocalRef(i)}if("stop"===r.onMatch(a))return"stop"}))},onError(e){},onComplete(){r.onComplete()}})}}openClassFile(e){return new A(e,null,this)}_getType(e,t=!0){return a(e,t,this)}}function O(e,t,n,r=!0){if(null!==e)if(r){const t=n.newGlobalRef(e);this.$h=t,this.$r=Script.bindWeak(this,g.makeHandleDestructor(t))}else this.$h=e,this.$r=null;else this.$h=null,this.$r=null;return this.$t=t,new Proxy(this,$)}function L(e,t){this.value=t.newGlobalRef(e),t.deleteLocalRef(e),this.refs=1}function M(e,t){e.unref(t)}function N(e){const t=function(){const e=function(){return e.invoke(this,arguments)};return e}();return Object.setPrototypeOf(t,w),t._o=e,t}function R(e,t,n){return`${t.className} ${e}(${n.map((e=>e.className)).join(", ")})`}function H(e){const t=e._o;t.length>1&&P(t[0].methodName,t,"has more than one overload, use .overload(<signature>) to choose from:")}function P(e,t,n){const r=t.slice().sort(((e,t)=>e.argumentTypes.length-t.argumentTypes.length)).map((e=>e.argumentTypes.length>0?".overload('"+e.argumentTypes.map((e=>e.className)).join("', '")+"')":".overload()"));throw new Error(`${e}(): ${n}\n\t${r.join("\n\t")}`)}function k(e,t,n,r,o,s,l,a){const i=o.type,c=s.map((e=>e.type));let u,h;return null===l&&(l=g.getEnv()),3===n?(u=l.vaMethod(i,c,a),h=l.nonvirtualVaMethod(i,c,a)):2===n?(u=l.staticVaMethod(i,c,a),h=u):(u=l.constructor(c,a),h=u),function(e){const t=function(){const e=function(){return e.invoke(this,arguments)};return e}();return Object.setPrototypeOf(t,_),t._p=e,t}([e,t,n,r,o,s,u,h])}function I(e,t,n,r,o,s,l=null){const a=new Set,i=(c=[e,t,n,r,o,s,l,a],function(){return F(arguments,c)});var c;const u=new NativeCallback(i,r.type,["pointer","pointer"].concat(o.map((e=>e.type))));return u._c=a,u}function F(t,n){const r=new e(t[0],g),[o,s,l,a,i,c,u,h]=n,f=[];let d;if(3===l){d=new(0,s.$C)(t[1],1,r,!1)}else d=s;const p=m();r.pushLocalFrame(3);let y=!0;g.link(p,r);try{let e;h.add(p),e=null!==u&&E.has(p)?u:c;const n=[],s=t.length-2;for(let e=0;e!==s;e++){const o=i[e].fromJni(t[2+e],r,!1);n.push(o),f.push(o)}const l=e.apply(d,n);if(!a.isCompatible(l))throw new Error(`Implementation for ${o} expected return value compatible with ${a.className}`);let m=a.toJni(l,r);return"pointer"===a.type&&(m=r.popLocalFrame(m),y=!1,f.push(l)),m}catch(e){const t=e.$h;return void 0!==t?r.throw(t):Script.nextTick((()=>{throw e})),a.defaultValue}finally{g.unlink(p),y&&r.popLocalFrame(NULL),h.delete(p),f.forEach((e=>{if(null===e)return;const t=e.$dispose;void 0!==t&&t.call(e)}))}}function x(e){this._p=e}$={has:(e,t)=>t in e||e.$has(t),get(e,t,n){if("string"!=typeof t||t.startsWith("$")||"class"===t)return e[t];const r=e.$find(t);return null!==r?r(n):e[t]},set:(e,t,n,r)=>(e[t]=n,!0),ownKeys:e=>e.$list(),getOwnPropertyDescriptor:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)?Object.getOwnPropertyDescriptor(e,t):{writable:!1,configurable:!0,enumerable:!0}},Object.defineProperties(O.prototype,{[Symbol.for("new")]:{enumerable:!1,get(){return this.$getCtor("allocAndInit")}},$new:{enumerable:!0,get(){return this[Symbol.for("new")]}},[Symbol.for("alloc")]:{enumerable:!1,value(){const e=g.getEnv(),t=this.$borrowClassHandle(e);try{const n=e.allocObject(t.value);return this.$f.cast(n,this)}finally{t.unref(e)}}},$alloc:{enumerable:!0,get(){return this[Symbol.for("alloc")]}},[Symbol.for("init")]:{enumerable:!1,get(){return this.$getCtor("initOnly")}},$init:{enumerable:!0,get(){return this[Symbol.for("init")]}},[Symbol.for("dispose")]:{enumerable:!1,value(){const e=this.$r;null!==e&&(this.$r=null,Script.unbindWeak(e)),null!==this.$h&&(this.$h=void 0)}},$dispose:{enumerable:!0,get(){return this[Symbol.for("dispose")]}},[Symbol.for("clone")]:{enumerable:!1,value(e){return new(0,this.$C)(this.$h,this.$t,e)}},$clone:{value(e){return this[Symbol.for("clone")](e)}},[Symbol.for("class")]:{enumerable:!1,get(){const e=g.getEnv(),t=this.$borrowClassHandle(e);try{const n=this.$f;return n.cast(t.value,n.use("java.lang.Class"))}finally{t.unref(e)}}},class:{enumerable:!0,get(){return this[Symbol.for("class")]}},[Symbol.for("className")]:{enumerable:!1,get(){const e=this.$h;return null===e?this.$n:g.getEnv().getObjectClassName(e)}},$className:{enumerable:!0,get(){return this[Symbol.for("className")]}},[Symbol.for("ownMembers")]:{enumerable:!1,get(){return this.$l.list()}},$ownMembers:{enumerable:!0,get(){return this[Symbol.for("ownMembers")]}},[Symbol.for("super")]:{enumerable:!1,get(){const e=g.getEnv();return new(0,this.$s.$C)(this.$h,2,e)}},$super:{enumerable:!0,get(){return this[Symbol.for("super")]}},[Symbol.for("s")]:{enumerable:!1,get(){const e=Object.getPrototypeOf(this);let t=e.$_s;if(void 0===t){const r=g.getEnv(),o=this.$borrowClassHandle(r);try{const s=r.getSuperclass(o.value);if(s.isNull())t=null;else try{const o=r.getClassName(s),l=e.$f;if(t=l._getUsedClass(o),void 0===t)try{const e=(n=this,function(e){const t=n.$borrowClassHandle(e);try{return e.getSuperclass(t.value)}finally{t.unref(e)}});t=l._make(o,e,r)}finally{l._setUsedClass(o,t)}}finally{r.deleteLocalRef(s)}}finally{o.unref(r)}e.$_s=t}var n;return t}},$s:{get(){return this[Symbol.for("s")]}},[Symbol.for("isSameObject")]:{enumerable:!1,value(e){return g.getEnv().isSameObject(e.$h,this.$h)}},$isSameObject:{value(e){return this[Symbol.for("isSameObject")](e)}},[Symbol.for("getCtor")]:{enumerable:!1,value(e){const t=this.$c;let n=t[0];if(null===n){const e=g.getEnv(),r=this.$borrowClassHandle(e);try{n=function(e,t,n){const{$n:r,$f:o}=t,s=function(e){return e.slice(e.lastIndexOf(".")+1)}(r),l=n.javaLangClass(),a=n.javaLangReflectConstructor(),i=n.vaMethod("pointer",[]),c=n.vaMethod("uint8",[]),u=[],h=[],f=o._getType(r,!1),d=o._getType("void",!1),m=i(n.handle,e,l.getDeclaredConstructors);try{const r=n.getArrayLength(m);if(0!==r)for(let e=0;e!==r;e++){let r,l;const c=n.getObjectArrayElement(m,e);try{r=n.fromReflectedMethod(c),l=i(n.handle,c,a.getGenericParameterTypes)}finally{n.deleteLocalRef(c)}let p;try{p=V(n,l).map((e=>o._getType(e)))}finally{n.deleteLocalRef(l)}u.push(k(s,t,1,r,f,p,n)),h.push(k(s,t,3,r,d,p,n))}else{if(c(n.handle,e,l.isInterface))throw new Error("cannot instantiate an interface");const r=n.javaLangObject(),o=n.getMethodId(r,"<init>","()V");u.push(k(s,t,1,o,f,[],n)),h.push(k(s,t,3,o,d,[],n))}}finally{n.deleteLocalRef(m)}if(0===h.length)throw new Error("no supported overloads");return{allocAndInit:N(u),initOnly:N(h)}}(r.value,this.$w,e),t[0]=n}finally{r.unref(e)}}return n[e]}},$getCtor:{value(e){return this[Symbol.for("getCtor")](e)}},[Symbol.for("borrowClassHandle")]:{enumerable:!1,value(e){const t=this.$n,n=this.$f._classHandles;let r=n.get(t);return void 0===r&&(r=new L(this.$gch(e),e),n.set(t,r,e)),r.ref()}},$borrowClassHandle:{value(e){return this[Symbol.for("borrowClassHandle")](e)}},[Symbol.for("copyClassHandle")]:{enumerable:!1,value(e){const t=this.$borrowClassHandle(e);try{return e.newLocalRef(t.value)}finally{t.unref(e)}}},$copyClassHandle:{value(e){return this[Symbol.for("copyClassHandle")](e)}},[Symbol.for("getHandle")]:{enumerable:!1,value(e){const t=this.$h;if(void 0===t)throw new Error("Wrapper is disposed; perhaps it was borrowed from a hook instead of calling Java.retain() to make a long-lived wrapper?");return t}},$getHandle:{value(e){return this[Symbol.for("getHandle")](e)}},[Symbol.for("list")]:{enumerable:!1,value(){const e=this.$s,t=null!==e?e.$list():[],n=this.$l;return Array.from(new Set(t.concat(n.list())))}},$list:{get(){return this[Symbol.for("list")]}},[Symbol.for("has")]:{enumerable:!1,value(e){if(this.$m.has(e))return!0;if(this.$l.has(e))return!0;const t=this.$s;return!(null===t||!t.$has(e))}},$has:{value(e){return this[Symbol.for("has")](e)}},[Symbol.for("find")]:{enumerable:!1,value(e){const t=this.$m;let n=t.get(e);if(void 0!==n)return n;const r=this.$l.find(e);if(null!==r){const o=g.getEnv(),s=this.$borrowClassHandle(o);try{n=function(e,t,n,r,o){if(t.startsWith("m"))return function(e,t,n,r,o){const{$f:s}=r,l=t.split(":").slice(1),a=o.javaLangReflectMethod(),i=o.vaMethod("pointer",[]),c=o.vaMethod("uint8",[]),u=l.map((t=>{const l="s"===t[0]?2:3,u=ptr(t.substr(1));let h;const f=[],d=o.toReflectedMethod(n,u,2===l?1:0);try{const e=!!c(o.handle,d,a.isVarArgs),t=i(o.handle,d,a.getGenericReturnType);o.throwIfExceptionPending();try{h=s._getType(o.getTypeName(t))}finally{o.deleteLocalRef(t)}const n=i(o.handle,d,a.getParameterTypes);try{const t=o.getArrayLength(n);for(let r=0;r!==t;r++){const l=o.getObjectArrayElement(n,r);let a;try{a=e&&r===t-1?o.getArrayTypeName(l):o.getTypeName(l)}finally{o.deleteLocalRef(l)}const i=s._getType(a);f.push(i)}}finally{o.deleteLocalRef(n)}}catch(e){return null}finally{o.deleteLocalRef(d)}return k(e,r,l,u,h,f,o)})).filter((e=>null!==e));if(0===u.length)throw new Error("No supported overloads");"valueOf"===e&&function(e){const{holder:t,type:n}=e[0];if(e.some((e=>e.type===n&&0===e.argumentTypes.length)))return;e.push(function(e){const t=function(){return this};return Object.setPrototypeOf(t,S),t._p=e,t}([t,n]))}(u);const h=N(u);return function(e){return h}}(e,t,n,r,o);return function(e,t,n,r,o){const s="s"===t[2]?1:2,l=ptr(t.substr(3)),{$f:a}=r;let i;const c=o.toReflectedField(n,l,1===s?1:0);try{i=o.vaMethod("pointer",[])(o.handle,c,o.javaLangReflectField().getGenericType),o.throwIfExceptionPending()}finally{o.deleteLocalRef(c)}let u,h,f;try{u=a._getType(o.getTypeName(i))}finally{o.deleteLocalRef(i)}const d=u.type;1===s?(h=o.getStaticField(d),f=o.setStaticField(d)):(h=o.getField(d),f=o.setField(d));return m=[s,u,l,h,f],function(e){return new x([e].concat(m))};var m}(0,t,n,r,o)}(e,r,s.value,this.$w,o)}finally{s.unref(o)}return t.set(e,n),n}const o=this.$s;return null!==o?o.$find(e):null}},$find:{value(e){return this[Symbol.for("find")](e)}},[Symbol.for("toJSON")]:{enumerable:!1,value(){const e=this.$n;if(null===this.$h)return`<class: ${e}>`;const t=this.$className;return e===t?`<instance: ${e}>`:`<instance: ${e}, $className: ${t}>`}},toJSON:{get(){return this[Symbol.for("toJSON")]}}}),L.prototype.ref=function(){return this.refs++,this},L.prototype.unref=function(e){0==--this.refs&&e.deleteGlobalRef(this.value)},w=Object.create(Function.prototype,{overloads:{enumerable:!0,get(){return this._o}},overload:{value(...e){const t=this._o,n=e.length,r=e.join(":");for(let e=0;e!==t.length;e++){const o=t[e],{argumentTypes:s}=o;if(s.length!==n)continue;if(s.map((e=>e.className)).join(":")===r)return o}P(this.methodName,this.overloads,"specified argument types do not match any of:")}},methodName:{enumerable:!0,get(){return this._o[0].methodName}},holder:{enumerable:!0,get(){return this._o[0].holder}},type:{enumerable:!0,get(){return this._o[0].type}},handle:{enumerable:!0,get(){return H(this),this._o[0].handle}},implementation:{enumerable:!0,get(){return H(this),this._o[0].implementation},set(e){H(this),this._o[0].implementation=e}},returnType:{enumerable:!0,get(){return H(this),this._o[0].returnType}},argumentTypes:{enumerable:!0,get(){return H(this),this._o[0].argumentTypes}},canInvokeWith:{enumerable:!0,get(e){return H(this),this._o[0].canInvokeWith}},clone:{enumerable:!0,value(e){return H(this),this._o[0].clone(e)}},invoke:{value(e,t){const n=this._o,r=null!==e.$h;for(let o=0;o!==n.length;o++){const s=n[o];if(s.canInvokeWith(t)){if(3===s.type&&!r){const t=this.methodName;if("toString"===t)return`<class: ${e.$n}>`;throw new Error(t+": cannot call instance method without an instance")}return s.apply(e,t)}}if("toString"===this.methodName)return`<class: ${e.$n}>`;P(this.methodName,this.overloads,"argument types do not match any of:")}}}),_=Object.create(Function.prototype,{methodName:{enumerable:!0,get(){return this._p[0]}},holder:{enumerable:!0,get(){return this._p[1]}},type:{enumerable:!0,get(){return this._p[2]}},handle:{enumerable:!0,get(){return this._p[3]}},implementation:{enumerable:!0,get(){const e=this._r;return void 0!==e?e:null},set(e){const t=this._p,n=t[1];if(1===t[2])throw new Error("Reimplementing $new is not possible; replace implementation of $init instead");const r=this._r;if(void 0!==r){n.$f._patchedMethods.delete(this);r._m.revert(g),this._r=void 0}if(null!==e){const[r,o,s,l,a,i]=t,c=I(r,o,s,a,i,e,this),u=f(l);c._m=u,this._r=c,u.replace(c,3===s,i,g,b),n.$f._patchedMethods.add(this)}}},returnType:{enumerable:!0,get(){return this._p[4]}},argumentTypes:{enumerable:!0,get(){return this._p[5]}},canInvokeWith:{enumerable:!0,value(e){const t=this._p[5];return e.length===t.length&&t.every(((t,n)=>t.isCompatible(e[n])))}},clone:{enumerable:!0,value(e){return k(...this._p.slice(0,6),null,e)}},invoke:{value(e,t){const n=g.getEnv(),r=this._p,o=r[2],s=r[4],l=r[5],a=this._r,i=3===o,c=t.length,u=2+c;n.pushLocalFrame(u);let h=null;try{let o,u;i?o=e.$getHandle():(h=e.$borrowClassHandle(n),o=h.value);let f=e.$t;if(void 0===a)u=r[3];else{if(u=a._m.resolveTarget(e,i,n,b),v){a._c.has(m())&&(f=2)}}const d=[n.handle,o,u];for(let e=0;e!==c;e++)d.push(l[e].toJni(t[e],n));let p;1===f?p=r[6]:(p=r[7],i&&d.splice(2,0,e.$copyClassHandle(n)));const y=p.apply(null,d);return n.throwIfExceptionPending(),s.fromJni(y,n,!0)}finally{null!==h&&h.unref(n),n.popLocalFrame(NULL)}}},toString:{enumerable:!0,value(){return`function ${this.methodName}(${this.argumentTypes.map((e=>e.className)).join(", ")}): ${this.returnType.className}`}}}),S=Object.create(Function.prototype,{methodName:{enumerable:!0,get:()=>"valueOf"},holder:{enumerable:!0,get(){return this._p[0]}},type:{enumerable:!0,get(){return this._p[1]}},handle:{enumerable:!0,get:()=>NULL},implementation:{enumerable:!0,get:()=>null,set(e){}},returnType:{enumerable:!0,get(){const e=this.holder;return e.$f.use(e.$n)}},argumentTypes:{enumerable:!0,get:()=>[]},canInvokeWith:{enumerable:!0,value:e=>0===e.length},clone:{enumerable:!0,value(e){throw new Error("Invalid operation")}}}),Object.defineProperties(x.prototype,{value:{enumerable:!0,get(){const[e,t,n,r,o]=this._p,s=g.getEnv();s.pushLocalFrame(4);let l=null;try{let a;if(2===t){if(a=e.$getHandle(),null===a)throw new Error("Cannot access an instance field without an instance")}else l=e.$borrowClassHandle(s),a=l.value;const i=o(s.handle,a,r);return s.throwIfExceptionPending(),n.fromJni(i,s,!0)}finally{null!==l&&l.unref(s),s.popLocalFrame(NULL)}},set(e){const[t,n,r,o,,s]=this._p,l=g.getEnv();l.pushLocalFrame(4);let a=null;try{let i;if(2===n){if(i=t.$getHandle(),null===i)throw new Error("Cannot access an instance field without an instance")}else a=t.$borrowClassHandle(l),i=a.value;if(!r.isCompatible(e))throw new Error(`Expected value compatible with ${r.className}`);const c=r.toJni(e,l);s(l.handle,i,o,c),l.throwIfExceptionPending()}finally{null!==a&&a.unref(l),l.popLocalFrame(NULL)}}},holder:{enumerable:!0,get(){return this._p[0]}},fieldType:{enumerable:!0,get(){return this._p[1]}},fieldReturnType:{enumerable:!0,get(){return this._p[2]}},toString:{enumerable:!0,value(){const e=`Java.Field{holder: ${this.holder}, fieldType: ${this.fieldType}, fieldReturnType: ${this.fieldReturnType}, value: ${this.value}}`;if(e.length<200)return e;return`Java.Field{\n\tholder: ${this.holder},\n\tfieldType: ${this.fieldType},\n\tfieldReturnType: ${this.fieldReturnType},\n\tvalue: ${this.value},\n}`.split("\n").map((e=>e.length>200?e.slice(0,e.indexOf(" ")+1)+"...,":e)).join("\n")}}});class A{static fromBuffer(e,t){const n=D(t),r=n.getCanonicalPath().toString(),o=new File(r,"w");return o.write(e.buffer),o.close(),function(e,t){const n=t.use("java.io.File");n.$new(e).setWritable(!1,!1)}(r,t),new A(r,n,t)}constructor(e,t,n){this.path=e,this.file=t,this._factory=n}load(){const{_factory:e}=this,{codeCacheDir:t}=e,n=e.use("dalvik.system.DexClassLoader"),r=e.use("java.io.File");let o=this.file;if(null===o&&(o=e.use("java.io.File").$new(this.path)),!o.exists())throw new Error("File not found");r.$new(t).mkdirs(),e.loader=n.$new(o.getCanonicalPath(),t,null,e.loader),g.preventDetachDueToClassLoader()}getClassNames(){const{_factory:e}=this,t=e.use("dalvik.system.DexFile"),n=D(e),r=[],o=t.loadDex(this.path,n.getCanonicalPath(),0).entries();for(;o.hasMoreElements();)r.push(o.nextElement().toString());return r}}function D(e){const{cacheDir:t,tempFileNaming:n}=e,r=e.use("java.io.File"),o=r.$new(t);return o.mkdirs(),r.createTempFile(n.prefix,n.suffix+".dex",o)}function J(e,t){const{factories:n,loaders:r,Integer:o}=y,s=o.$new(n.indexOf(e));r.put(t,s);for(let e=t.getParent();null!==e&&!r.containsKey(e);e=e.getParent())r.put(e,s)}function G(e){let t=E.get(e);void 0===t&&(t=0),t++,E.set(e,t)}function U(e){let t=E.get(e);if(void 0===t)throw new Error(`Thread ${e} is not ignored`);t--,0===t?E.delete(e):E.set(e,t)}function V(e,t){const n=[],r=e.getArrayLength(t);for(let o=0;o!==r;o++){const r=e.getObjectArrayElement(t,o);try{n.push(e.getTypeName(r))}finally{e.deleteLocalRef(r)}}return n}function W(e){const t=e.split(".");return t[t.length-1]+".java"}
âœ„
{"version":3,"file":"class-model.js","names":["withRunnableArtThread","getArtClassSpec","getArtMethodSpec","getArtFieldSpec","getApi","code","methodQueryPattern","cm","unwrap","Model","static","handle","env","ensureInitialized","object","new","query","api","params","match","Error","classQuery","Memory","allocUtf8String","methodQuery","includeSignature","ignoreCase","skipSystemClasses","modifiers","result","undefined","indexOf","jvmti","json","enumerateMethodsJvm","boolToNative","JSON","parse","readUtf8String","map","group","loaderRef","ptr","loader","isNull","dealloc","vm","thread","enumerateMethodsArt","addGlobalReference","vmHandle","loaderObj","constructor","this","has","member","find","list","str","pointerSize","Process","lockSize","modelsSize","javaApiSize","dataSize","lock","alloc","models","add","javaApi","getDeclaredMethods","getDeclaredFields","javaLangClass","method","javaLangReflectMethod","field","javaLangReflectField","j","NULL","getName","getModifiers","forEach","value","writePointer","artApi","flavor","artClassOffsets","c","offset","ifields","methods","sfields","copiedMethodsOffset","m","f","s","size","accessFlags","writeUInt","artClassLinker","address","getModuleByName","getExportByName","i","CModule","java_api","art_api","reentrantOptions","exceptions","fastOptions","scheduling","NativeFunction","model_new","model_has","model_find","model_list","enumerate_methods_art","enumerate_methods_jvm","compileModule","nullUnwrap","decodeGlobal","fn","makeHandleUnwrapper","val"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"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","ignoreList":[]}
âœ„
import{withRunnableArtThread as n,getArtClassSpec as e,getArtMethodSpec as t,getArtFieldSpec as s,getApi as a}from"./android.js";const r="#include <json-glib/json-glib.h>\n#include <string.h>\n\n#define kAccStatic 0x0008\n#define kAccConstructor 0x00010000\n\ntypedef struct _Model Model;\ntypedef struct _EnumerateMethodsContext EnumerateMethodsContext;\n\ntypedef struct _JavaApi JavaApi;\ntypedef struct _JavaClassApi JavaClassApi;\ntypedef struct _JavaMethodApi JavaMethodApi;\ntypedef struct _JavaFieldApi JavaFieldApi;\n\ntypedef struct _JNIEnv JNIEnv;\ntypedef guint8 jboolean;\ntypedef gint32 jint;\ntypedef jint jsize;\ntypedef gpointer jobject;\ntypedef jobject jclass;\ntypedef jobject jstring;\ntypedef jobject jarray;\ntypedef jarray jobjectArray;\ntypedef gpointer jfieldID;\ntypedef gpointer jmethodID;\n\ntypedef struct _jvmtiEnv jvmtiEnv;\ntypedef enum\n{\n  JVMTI_ERROR_NONE = 0\n} jvmtiError;\n\ntypedef struct _ArtApi ArtApi;\ntypedef guint32 ArtHeapReference;\ntypedef struct _ArtObject ArtObject;\ntypedef struct _ArtClass ArtClass;\ntypedef struct _ArtClassLinker ArtClassLinker;\ntypedef struct _ArtClassVisitor ArtClassVisitor;\ntypedef struct _ArtClassVisitorVTable ArtClassVisitorVTable;\ntypedef struct _ArtMethod ArtMethod;\ntypedef struct _ArtString ArtString;\n\ntypedef union _StdString StdString;\ntypedef struct _StdStringShort StdStringShort;\ntypedef struct _StdStringLong StdStringLong;\n\ntypedef void (* ArtVisitClassesFunc) (ArtClassLinker * linker, ArtClassVisitor * visitor);\ntypedef const char * (* ArtGetClassDescriptorFunc) (ArtClass * klass, StdString * storage);\ntypedef void (* ArtPrettyMethodFunc) (StdString * result, ArtMethod * method, jboolean with_signature);\n\nstruct _Model\n{\n  GHashTable * members;\n};\n\nstruct _EnumerateMethodsContext\n{\n  GPatternSpec * class_query;\n  GPatternSpec * method_query;\n  jboolean include_signature;\n  jboolean ignore_case;\n  jboolean skip_system_classes;\n  GHashTable * groups;\n};\n\nstruct _JavaClassApi\n{\n  jmethodID get_declared_methods;\n  jmethodID get_declared_fields;\n};\n\nstruct _JavaMethodApi\n{\n  jmethodID get_name;\n  jmethodID get_modifiers;\n};\n\nstruct _JavaFieldApi\n{\n  jmethodID get_name;\n  jmethodID get_modifiers;\n};\n\nstruct _JavaApi\n{\n  jvmtiEnv * jvmti;\n  JavaClassApi clazz;\n  JavaMethodApi method;\n  JavaFieldApi field;\n};\n\nstruct _JNIEnv\n{\n  gpointer * functions;\n};\n\nstruct _jvmtiEnv\n{\n  gpointer * functions;\n};\n\nstruct _ArtApi\n{\n  gboolean available;\n\n  guint class_offset_ifields;\n  guint class_offset_methods;\n  guint class_offset_sfields;\n  guint class_offset_copied_methods_offset;\n\n  guint method_size;\n  guint method_offset_access_flags;\n\n  guint field_size;\n  guint field_offset_access_flags;\n\n  guint alignment_padding;\n\n  ArtClassLinker * linker;\n  ArtVisitClassesFunc visit_classes;\n  ArtGetClassDescriptorFunc get_class_descriptor;\n  ArtPrettyMethodFunc pretty_method;\n\n  void (* free) (gpointer mem);\n};\n\nstruct _ArtObject\n{\n  ArtHeapReference klass;\n  ArtHeapReference monitor;\n};\n\nstruct _ArtClass\n{\n  ArtObject parent;\n\n  ArtHeapReference class_loader;\n};\n\nstruct _ArtClassVisitor\n{\n  ArtClassVisitorVTable * vtable;\n  gpointer user_data;\n};\n\nstruct _ArtClassVisitorVTable\n{\n  void (* reserved1) (ArtClassVisitor * self);\n  void (* reserved2) (ArtClassVisitor * self);\n  jboolean (* visit) (ArtClassVisitor * self, ArtClass * klass);\n};\n\nstruct _ArtString\n{\n  ArtObject parent;\n\n  gint32 count;\n  guint32 hash_code;\n\n  union\n  {\n    guint16 value[0];\n    guint8 value_compressed[0];\n  };\n};\n\nstruct _StdStringShort\n{\n  guint8 size;\n  gchar data[(3 * sizeof (gpointer)) - sizeof (guint8)];\n};\n\nstruct _StdStringLong\n{\n  gsize capacity;\n  gsize size;\n  gchar * data;\n};\n\nunion _StdString\n{\n  StdStringShort s;\n  StdStringLong l;\n};\n\nstatic void model_add_method (Model * self, const gchar * name, jmethodID id, jint modifiers);\nstatic void model_add_field (Model * self, const gchar * name, jfieldID id, jint modifiers);\nstatic void model_free (Model * model);\n\nstatic jboolean collect_matching_class_methods (ArtClassVisitor * self, ArtClass * klass);\nstatic gchar * finalize_method_groups_to_json (GHashTable * groups);\nstatic GPatternSpec * make_pattern_spec (const gchar * pattern, jboolean ignore_case);\nstatic gchar * class_name_from_signature (const gchar * signature);\nstatic gchar * format_method_signature (const gchar * name, const gchar * signature);\nstatic void append_type (GString * output, const gchar ** type);\n\nstatic gpointer read_art_array (gpointer object_base, guint field_offset, guint length_size, guint * length);\n\nstatic void std_string_destroy (StdString * str);\nstatic gchar * std_string_c_str (StdString * self);\n\nextern GMutex lock;\nextern GArray * models;\nextern JavaApi java_api;\nextern ArtApi art_api;\n\nvoid\ninit (void)\n{\n  g_mutex_init (&lock);\n  models = g_array_new (FALSE, FALSE, sizeof (Model *));\n}\n\nvoid\nfinalize (void)\n{\n  guint n, i;\n\n  n = models->len;\n  for (i = 0; i != n; i++)\n  {\n    Model * model = g_array_index (models, Model *, i);\n    model_free (model);\n  }\n\n  g_array_unref (models);\n  g_mutex_clear (&lock);\n}\n\nModel *\nmodel_new (jclass class_handle,\n           gpointer class_object,\n           JNIEnv * env)\n{\n  Model * model;\n  GHashTable * members;\n  jvmtiEnv * jvmti = java_api.jvmti;\n  gpointer * funcs = env->functions;\n  jmethodID (* from_reflected_method) (JNIEnv *, jobject) = funcs[7];\n  jfieldID (* from_reflected_field) (JNIEnv *, jobject) = funcs[8];\n  jobject (* to_reflected_method) (JNIEnv *, jclass, jmethodID, jboolean) = funcs[9];\n  jobject (* to_reflected_field) (JNIEnv *, jclass, jfieldID, jboolean) = funcs[12];\n  void (* delete_local_ref) (JNIEnv *, jobject) = funcs[23];\n  jobject (* call_object_method) (JNIEnv *, jobject, jmethodID, ...) = funcs[34];\n  jint (* call_int_method) (JNIEnv *, jobject, jmethodID, ...) = funcs[49];\n  const char * (* get_string_utf_chars) (JNIEnv *, jstring, jboolean *) = funcs[169];\n  void (* release_string_utf_chars) (JNIEnv *, jstring, const char *) = funcs[170];\n  jsize (* get_array_length) (JNIEnv *, jarray) = funcs[171];\n  jobject (* get_object_array_element) (JNIEnv *, jobjectArray, jsize) = funcs[173];\n  jsize n, i;\n\n  model = g_new (Model, 1);\n\n  members = g_hash_table_new_full (g_str_hash, g_str_equal, g_free, g_free);\n  model->members = members;\n\n  if (jvmti != NULL)\n  {\n    gpointer * jf = jvmti->functions - 1;\n    jvmtiError (* deallocate) (jvmtiEnv *, void * mem) = jf[47];\n    jvmtiError (* get_class_methods) (jvmtiEnv *, jclass, jint *, jmethodID **) = jf[52];\n    jvmtiError (* get_class_fields) (jvmtiEnv *, jclass, jint *, jfieldID **) = jf[53];\n    jvmtiError (* get_field_name) (jvmtiEnv *, jclass, jfieldID, char **, char **, char **) = jf[60];\n    jvmtiError (* get_field_modifiers) (jvmtiEnv *, jclass, jfieldID, jint *) = jf[62];\n    jvmtiError (* get_method_name) (jvmtiEnv *, jmethodID, char **, char **, char **) = jf[64];\n    jvmtiError (* get_method_modifiers) (jvmtiEnv *, jmethodID, jint *) = jf[66];\n    jint method_count;\n    jmethodID * methods;\n    jint field_count;\n    jfieldID * fields;\n    char * name;\n    jint modifiers;\n\n    get_class_methods (jvmti, class_handle, &method_count, &methods);\n    for (i = 0; i != method_count; i++)\n    {\n      jmethodID method = methods[i];\n\n      get_method_name (jvmti, method, &name, NULL, NULL);\n      get_method_modifiers (jvmti, method, &modifiers);\n\n      model_add_method (model, name, method, modifiers);\n\n      deallocate (jvmti, name);\n    }\n    deallocate (jvmti, methods);\n\n    get_class_fields (jvmti, class_handle, &field_count, &fields);\n    for (i = 0; i != field_count; i++)\n    {\n      jfieldID field = fields[i];\n\n      get_field_name (jvmti, class_handle, field, &name, NULL, NULL);\n      get_field_modifiers (jvmti, class_handle, field, &modifiers);\n\n      model_add_field (model, name, field, modifiers);\n\n      deallocate (jvmti, name);\n    }\n    deallocate (jvmti, fields);\n  }\n  else if (art_api.available)\n  {\n    gpointer elements;\n    guint n, i;\n    const guint field_arrays[] = {\n      art_api.class_offset_ifields,\n      art_api.class_offset_sfields\n    };\n    guint field_array_cursor;\n    gboolean merged_fields = art_api.class_offset_sfields == 0;\n\n    elements = read_art_array (class_object, art_api.class_offset_methods, sizeof (gsize), NULL);\n    n = *(guint16 *) (class_object + art_api.class_offset_copied_methods_offset);\n    for (i = 0; i != n; i++)\n    {\n      jmethodID id;\n      guint32 access_flags;\n      jboolean is_static;\n      jobject method, name;\n      const char * name_str;\n      jint modifiers;\n\n      id = elements + (i * art_api.method_size);\n\n      access_flags = *(guint32 *) (id + art_api.method_offset_access_flags);\n      if ((access_flags & kAccConstructor) != 0)\n        continue;\n      is_static = (access_flags & kAccStatic) != 0;\n      method = to_reflected_method (env, class_handle, id, is_static);\n      name = call_object_method (env, method, java_api.method.get_name);\n      name_str = get_string_utf_chars (env, name, NULL);\n      modifiers = access_flags & 0xffff;\n\n      model_add_method (model, name_str, id, modifiers);\n\n      release_string_utf_chars (env, name, name_str);\n      delete_local_ref (env, name);\n      delete_local_ref (env, method);\n    }\n\n    for (field_array_cursor = 0; field_array_cursor != G_N_ELEMENTS (field_arrays); field_array_cursor++)\n    {\n      jboolean is_static;\n\n      if (field_arrays[field_array_cursor] == 0)\n        continue;\n\n      if (!merged_fields)\n        is_static = field_array_cursor == 1;\n\n      elements = read_art_array (class_object, field_arrays[field_array_cursor], sizeof (guint32), &n);\n      for (i = 0; i != n; i++)\n      {\n        jfieldID id;\n        guint32 access_flags;\n        jobject field, name;\n        const char * name_str;\n        jint modifiers;\n\n        id = elements + (i * art_api.field_size);\n\n        access_flags = *(guint32 *) (id + art_api.field_offset_access_flags);\n        if (merged_fields)\n          is_static = (access_flags & kAccStatic) != 0;\n        field = to_reflected_field (env, class_handle, id, is_static);\n        name = call_object_method (env, field, java_api.field.get_name);\n        name_str = get_string_utf_chars (env, name, NULL);\n        modifiers = access_flags & 0xffff;\n\n        model_add_field (model, name_str, id, modifiers);\n\n        release_string_utf_chars (env, name, name_str);\n        delete_local_ref (env, name);\n        delete_local_ref (env, field);\n      }\n    }\n  }\n  else\n  {\n    jobject elements;\n\n    elements = call_object_method (env, class_handle, java_api.clazz.get_declared_methods);\n    n = get_array_length (env, elements);\n    for (i = 0; i != n; i++)\n    {\n      jobject method, name;\n      const char * name_str;\n      jmethodID id;\n      jint modifiers;\n\n      method = get_object_array_element (env, elements, i);\n      name = call_object_method (env, method, java_api.method.get_name);\n      name_str = get_string_utf_chars (env, name, NULL);\n      id = from_reflected_method (env, method);\n      modifiers = call_int_method (env, method, java_api.method.get_modifiers);\n\n      model_add_method (model, name_str, id, modifiers);\n\n      release_string_utf_chars (env, name, name_str);\n      delete_local_ref (env, name);\n      delete_local_ref (env, method);\n    }\n    delete_local_ref (env, elements);\n\n    elements = call_object_method (env, class_handle, java_api.clazz.get_declared_fields);\n    n = get_array_length (env, elements);\n    for (i = 0; i != n; i++)\n    {\n      jobject field, name;\n      const char * name_str;\n      jfieldID id;\n      jint modifiers;\n\n      field = get_object_array_element (env, elements, i);\n      name = call_object_method (env, field, java_api.field.get_name);\n      name_str = get_string_utf_chars (env, name, NULL);\n      id = from_reflected_field (env, field);\n      modifiers = call_int_method (env, field, java_api.field.get_modifiers);\n\n      model_add_field (model, name_str, id, modifiers);\n\n      release_string_utf_chars (env, name, name_str);\n      delete_local_ref (env, name);\n      delete_local_ref (env, field);\n    }\n    delete_local_ref (env, elements);\n  }\n\n  g_mutex_lock (&lock);\n  g_array_append_val (models, model);\n  g_mutex_unlock (&lock);\n\n  return model;\n}\n\nstatic void\nmodel_add_method (Model * self,\n                  const gchar * name,\n                  jmethodID id,\n                  jint modifiers)\n{\n  GHashTable * members = self->members;\n  gchar * key, type;\n  const gchar * value;\n\n  if (name[0] == '$')\n    key = g_strdup_printf (\"_%s\", name);\n  else\n    key = g_strdup (name);\n\n  type = (modifiers & kAccStatic) != 0 ? 's' : 'i';\n\n  value = g_hash_table_lookup (members, key);\n  if (value == NULL)\n    g_hash_table_insert (members, key, g_strdup_printf (\"m:%c0x%zx\", type, id));\n  else\n    g_hash_table_insert (members, key, g_strdup_printf (\"%s:%c0x%zx\", value, type, id));\n}\n\nstatic void\nmodel_add_field (Model * self,\n                 const gchar * name,\n                 jfieldID id,\n                 jint modifiers)\n{\n  GHashTable * members = self->members;\n  gchar * key, type;\n\n  if (name[0] == '$')\n    key = g_strdup_printf (\"_%s\", name);\n  else\n    key = g_strdup (name);\n  while (g_hash_table_contains (members, key))\n  {\n    gchar * new_key = g_strdup_printf (\"_%s\", key);\n    g_free (key);\n    key = new_key;\n  }\n\n  type = (modifiers & kAccStatic) != 0 ? 's' : 'i';\n\n  g_hash_table_insert (members, key, g_strdup_printf (\"f:%c0x%zx\", type, id));\n}\n\nstatic void\nmodel_free (Model * model)\n{\n  g_hash_table_unref (model->members);\n\n  g_free (model);\n}\n\ngboolean\nmodel_has (Model * self,\n           const gchar * member)\n{\n  return g_hash_table_contains (self->members, member);\n}\n\nconst gchar *\nmodel_find (Model * self,\n            const gchar * member)\n{\n  return g_hash_table_lookup (self->members, member);\n}\n\ngchar *\nmodel_list (Model * self)\n{\n  GString * result;\n  GHashTableIter iter;\n  guint i;\n  const gchar * name;\n\n  result = g_string_sized_new (128);\n\n  g_string_append_c (result, '[');\n\n  g_hash_table_iter_init (&iter, self->members);\n  for (i = 0; g_hash_table_iter_next (&iter, (gpointer *) &name, NULL); i++)\n  {\n    if (i > 0)\n      g_string_append_c (result, ',');\n\n    g_string_append_c (result, '\"');\n    g_string_append (result, name);\n    g_string_append_c (result, '\"');\n  }\n\n  g_string_append_c (result, ']');\n\n  return g_string_free (result, FALSE);\n}\n\ngchar *\nenumerate_methods_art (const gchar * class_query,\n                       const gchar * method_query,\n                       jboolean include_signature,\n                       jboolean ignore_case,\n                       jboolean skip_system_classes)\n{\n  gchar * result;\n  EnumerateMethodsContext ctx;\n  ArtClassVisitor visitor;\n  ArtClassVisitorVTable visitor_vtable = { NULL, };\n\n  ctx.class_query = make_pattern_spec (class_query, ignore_case);\n  ctx.method_query = make_pattern_spec (method_query, ignore_case);\n  ctx.include_signature = include_signature;\n  ctx.ignore_case = ignore_case;\n  ctx.skip_system_classes = skip_system_classes;\n  ctx.groups = g_hash_table_new_full (NULL, NULL, NULL, NULL);\n\n  visitor.vtable = &visitor_vtable;\n  visitor.user_data = &ctx;\n\n  visitor_vtable.visit = collect_matching_class_methods;\n\n  art_api.visit_classes (art_api.linker, &visitor);\n\n  result = finalize_method_groups_to_json (ctx.groups);\n\n  g_hash_table_unref (ctx.groups);\n  g_pattern_spec_free (ctx.method_query);\n  g_pattern_spec_free (ctx.class_query);\n\n  return result;\n}\n\nstatic jboolean\ncollect_matching_class_methods (ArtClassVisitor * self,\n                                ArtClass * klass)\n{\n  EnumerateMethodsContext * ctx = self->user_data;\n  const char * descriptor;\n  StdString descriptor_storage = { 0, };\n  gchar * class_name = NULL;\n  gchar * class_name_copy = NULL;\n  const gchar * normalized_class_name;\n  JsonBuilder * group;\n  size_t class_name_length;\n  GHashTable * seen_method_names;\n  gpointer elements;\n  guint n, i;\n\n  if (ctx->skip_system_classes && klass->class_loader == 0)\n    goto skip_class;\n\n  descriptor = art_api.get_class_descriptor (klass, &descriptor_storage);\n  if (descriptor[0] != 'L')\n    goto skip_class;\n\n  class_name = class_name_from_signature (descriptor);\n\n  if (ctx->ignore_case)\n  {\n    class_name_copy = g_utf8_strdown (class_name, -1);\n    normalized_class_name = class_name_copy;\n  }\n  else\n  {\n    normalized_class_name = class_name;\n  }\n\n  if (!g_pattern_match_string (ctx->class_query, normalized_class_name))\n    goto skip_class;\n\n  group = NULL;\n  class_name_length = strlen (class_name);\n  seen_method_names = ctx->include_signature ? NULL : g_hash_table_new_full (g_str_hash, g_str_equal, g_free, NULL);\n\n  elements = read_art_array (klass, art_api.class_offset_methods, sizeof (gsize), NULL);\n  n = *(guint16 *) ((gpointer) klass + art_api.class_offset_copied_methods_offset);\n  for (i = 0; i != n; i++)\n  {\n    ArtMethod * method;\n    guint32 access_flags;\n    jboolean is_constructor;\n    StdString method_name = { 0, };\n    const gchar * bare_method_name;\n    gchar * bare_method_name_copy = NULL;\n    const gchar * normalized_method_name;\n    gchar * normalized_method_name_copy = NULL;\n\n    method = elements + (i * art_api.method_size);\n\n    access_flags = *(guint32 *) ((gpointer) method + art_api.method_offset_access_flags);\n    is_constructor = (access_flags & kAccConstructor) != 0;\n\n    art_api.pretty_method (&method_name, method, ctx->include_signature);\n    bare_method_name = std_string_c_str (&method_name);\n    if (ctx->include_signature)\n    {\n      const gchar * return_type_end, * name_begin;\n      GString * name;\n\n      return_type_end = strchr (bare_method_name, ' ');\n      name_begin = return_type_end + 1 + class_name_length + 1;\n      if (is_constructor && g_str_has_prefix (name_begin, \"<clinit>\"))\n        goto skip_method;\n\n      name = g_string_sized_new (64);\n\n      if (is_constructor)\n      {\n        g_string_append (name, \"$init\");\n        g_string_append (name, strchr (name_begin, '>') + 1);\n      }\n      else\n      {\n        g_string_append (name, name_begin);\n      }\n      g_string_append (name, \": \");\n      g_string_append_len (name, bare_method_name, return_type_end - bare_method_name);\n\n      bare_method_name_copy = g_string_free (name, FALSE);\n      bare_method_name = bare_method_name_copy;\n    }\n    else\n    {\n      const gchar * name_begin;\n\n      name_begin = bare_method_name + class_name_length + 1;\n      if (is_constructor && strcmp (name_begin, \"<clinit>\") == 0)\n        goto skip_method;\n\n      if (is_constructor)\n        bare_method_name = \"$init\";\n      else\n        bare_method_name += class_name_length + 1;\n    }\n\n    if (seen_method_names != NULL && g_hash_table_contains (seen_method_names, bare_method_name))\n      goto skip_method;\n\n    if (ctx->ignore_case)\n    {\n      normalized_method_name_copy = g_utf8_strdown (bare_method_name, -1);\n      normalized_method_name = normalized_method_name_copy;\n    }\n    else\n    {\n      normalized_method_name = bare_method_name;\n    }\n\n    if (!g_pattern_match_string (ctx->method_query, normalized_method_name))\n      goto skip_method;\n\n    if (group == NULL)\n    {\n      group = g_hash_table_lookup (ctx->groups, GUINT_TO_POINTER (klass->class_loader));\n      if (group == NULL)\n      {\n        group = json_builder_new_immutable ();\n        g_hash_table_insert (ctx->groups, GUINT_TO_POINTER (klass->class_loader), group);\n\n        json_builder_begin_object (group);\n\n        json_builder_set_member_name (group, \"loader\");\n        json_builder_add_int_value (group, klass->class_loader);\n\n        json_builder_set_member_name (group, \"classes\");\n        json_builder_begin_array (group);\n      }\n\n      json_builder_begin_object (group);\n\n      json_builder_set_member_name (group, \"name\");\n      json_builder_add_string_value (group, class_name);\n\n      json_builder_set_member_name (group, \"methods\");\n      json_builder_begin_array (group);\n    }\n\n    json_builder_add_string_value (group, bare_method_name);\n\n    if (seen_method_names != NULL)\n      g_hash_table_add (seen_method_names, g_strdup (bare_method_name));\n\nskip_method:\n    g_free (normalized_method_name_copy);\n    g_free (bare_method_name_copy);\n    std_string_destroy (&method_name);\n  }\n\n  if (seen_method_names != NULL)\n    g_hash_table_unref (seen_method_names);\n\n  if (group == NULL)\n    goto skip_class;\n\n  json_builder_end_array (group);\n  json_builder_end_object (group);\n\nskip_class:\n  g_free (class_name_copy);\n  g_free (class_name);\n  std_string_destroy (&descriptor_storage);\n\n  return TRUE;\n}\n\ngchar *\nenumerate_methods_jvm (const gchar * class_query,\n                       const gchar * method_query,\n                       jboolean include_signature,\n                       jboolean ignore_case,\n                       jboolean skip_system_classes,\n                       JNIEnv * env)\n{\n  gchar * result;\n  GPatternSpec * class_pattern, * method_pattern;\n  GHashTable * groups;\n  gpointer * ef = env->functions;\n  jobject (* new_global_ref) (JNIEnv *, jobject) = ef[21];\n  void (* delete_local_ref) (JNIEnv *, jobject) = ef[23];\n  jboolean (* is_same_object) (JNIEnv *, jobject, jobject) = ef[24];\n  jvmtiEnv * jvmti = java_api.jvmti;\n  gpointer * jf = jvmti->functions - 1;\n  jvmtiError (* deallocate) (jvmtiEnv *, void * mem) = jf[47];\n  jvmtiError (* get_class_signature) (jvmtiEnv *, jclass, char **, char **) = jf[48];\n  jvmtiError (* get_class_methods) (jvmtiEnv *, jclass, jint *, jmethodID **) = jf[52];\n  jvmtiError (* get_class_loader) (jvmtiEnv *, jclass, jobject *) = jf[57];\n  jvmtiError (* get_method_name) (jvmtiEnv *, jmethodID, char **, char **, char **) = jf[64];\n  jvmtiError (* get_loaded_classes) (jvmtiEnv *, jint *, jclass **) = jf[78];\n  jint class_count, class_index;\n  jclass * classes;\n\n  class_pattern = make_pattern_spec (class_query, ignore_case);\n  method_pattern = make_pattern_spec (method_query, ignore_case);\n  groups = g_hash_table_new_full (NULL, NULL, NULL, NULL);\n\n  if (get_loaded_classes (jvmti, &class_count, &classes) != JVMTI_ERROR_NONE)\n    goto emit_results;\n\n  for (class_index = 0; class_index != class_count; class_index++)\n  {\n    jclass klass = classes[class_index];\n    jobject loader = NULL;\n    gboolean have_loader = FALSE;\n    char * signature = NULL;\n    gchar * class_name = NULL;\n    gchar * class_name_copy = NULL;\n    const gchar * normalized_class_name;\n    jint method_count, method_index;\n    jmethodID * methods = NULL;\n    JsonBuilder * group = NULL;\n    GHashTable * seen_method_names = NULL;\n\n    if (skip_system_classes)\n    {\n      if (get_class_loader (jvmti, klass, &loader) != JVMTI_ERROR_NONE)\n        goto skip_class;\n      have_loader = TRUE;\n\n      if (loader == NULL)\n        goto skip_class;\n    }\n\n    if (get_class_signature (jvmti, klass, &signature, NULL) != JVMTI_ERROR_NONE)\n      goto skip_class;\n\n    class_name = class_name_from_signature (signature);\n\n    if (ignore_case)\n    {\n      class_name_copy = g_utf8_strdown (class_name, -1);\n      normalized_class_name = class_name_copy;\n    }\n    else\n    {\n      normalized_class_name = class_name;\n    }\n\n    if (!g_pattern_match_string (class_pattern, normalized_class_name))\n      goto skip_class;\n\n    if (get_class_methods (jvmti, klass, &method_count, &methods) != JVMTI_ERROR_NONE)\n      goto skip_class;\n\n    if (!include_signature)\n      seen_method_names = g_hash_table_new_full (g_str_hash, g_str_equal, g_free, NULL);\n\n    for (method_index = 0; method_index != method_count; method_index++)\n    {\n      jmethodID method = methods[method_index];\n      const gchar * method_name;\n      char * method_name_value = NULL;\n      char * method_signature_value = NULL;\n      gchar * method_name_copy = NULL;\n      const gchar * normalized_method_name;\n      gchar * normalized_method_name_copy = NULL;\n\n      if (get_method_name (jvmti, method, &method_name_value, include_signature ? &method_signature_value : NULL, NULL) != JVMTI_ERROR_NONE)\n        goto skip_method;\n      method_name = method_name_value;\n\n      if (method_name[0] == '<')\n      {\n        if (strcmp (method_name, \"<init>\") == 0)\n          method_name = \"$init\";\n        else if (strcmp (method_name, \"<clinit>\") == 0)\n          goto skip_method;\n      }\n\n      if (include_signature)\n      {\n        method_name_copy = format_method_signature (method_name, method_signature_value);\n        method_name = method_name_copy;\n      }\n\n      if (seen_method_names != NULL && g_hash_table_contains (seen_method_names, method_name))\n        goto skip_method;\n\n      if (ignore_case)\n      {\n        normalized_method_name_copy = g_utf8_strdown (method_name, -1);\n        normalized_method_name = normalized_method_name_copy;\n      }\n      else\n      {\n        normalized_method_name = method_name;\n      }\n\n      if (!g_pattern_match_string (method_pattern, normalized_method_name))\n        goto skip_method;\n\n      if (group == NULL)\n      {\n        if (!have_loader && get_class_loader (jvmti, klass, &loader) != JVMTI_ERROR_NONE)\n          goto skip_method;\n\n        if (loader == NULL)\n        {\n          group = g_hash_table_lookup (groups, NULL);\n        }\n        else\n        {\n          GHashTableIter iter;\n          jobject cur_loader;\n          JsonBuilder * cur_group;\n\n          g_hash_table_iter_init (&iter, groups);\n          while (g_hash_table_iter_next (&iter, (gpointer *) &cur_loader, (gpointer *) &cur_group))\n          {\n            if (cur_loader != NULL && is_same_object (env, cur_loader, loader))\n            {\n              group = cur_group;\n              break;\n            }\n          }\n        }\n\n        if (group == NULL)\n        {\n          jobject l;\n          gchar * str;\n\n          l = (loader != NULL) ? new_global_ref (env, loader) : NULL;\n\n          group = json_builder_new_immutable ();\n          g_hash_table_insert (groups, l, group);\n\n          json_builder_begin_object (group);\n\n          json_builder_set_member_name (group, \"loader\");\n          str = g_strdup_printf (\"0x%\" G_GSIZE_MODIFIER \"x\", GPOINTER_TO_SIZE (l));\n          json_builder_add_string_value (group, str);\n          g_free (str);\n\n          json_builder_set_member_name (group, \"classes\");\n          json_builder_begin_array (group);\n        }\n\n        json_builder_begin_object (group);\n\n        json_builder_set_member_name (group, \"name\");\n        json_builder_add_string_value (group, class_name);\n\n        json_builder_set_member_name (group, \"methods\");\n        json_builder_begin_array (group);\n      }\n\n      json_builder_add_string_value (group, method_name);\n\n      if (seen_method_names != NULL)\n        g_hash_table_add (seen_method_names, g_strdup (method_name));\n\nskip_method:\n      g_free (normalized_method_name_copy);\n      g_free (method_name_copy);\n      deallocate (jvmti, method_signature_value);\n      deallocate (jvmti, method_name_value);\n    }\n\nskip_class:\n    if (group != NULL)\n    {\n      json_builder_end_array (group);\n      json_builder_end_object (group);\n    }\n\n    if (seen_method_names != NULL)\n      g_hash_table_unref (seen_method_names);\n\n    deallocate (jvmti, methods);\n\n    g_free (class_name_copy);\n    g_free (class_name);\n    deallocate (jvmti, signature);\n\n    if (loader != NULL)\n      delete_local_ref (env, loader);\n\n    delete_local_ref (env, klass);\n  }\n\n  deallocate (jvmti, classes);\n\nemit_results:\n  result = finalize_method_groups_to_json (groups);\n\n  g_hash_table_unref (groups);\n  g_pattern_spec_free (method_pattern);\n  g_pattern_spec_free (class_pattern);\n\n  return result;\n}\n\nstatic gchar *\nfinalize_method_groups_to_json (GHashTable * groups)\n{\n  GString * result;\n  GHashTableIter iter;\n  guint i;\n  JsonBuilder * group;\n\n  result = g_string_sized_new (1024);\n\n  g_string_append_c (result, '[');\n\n  g_hash_table_iter_init (&iter, groups);\n  for (i = 0; g_hash_table_iter_next (&iter, NULL, (gpointer *) &group); i++)\n  {\n    JsonNode * root;\n    gchar * json;\n\n    if (i > 0)\n      g_string_append_c (result, ',');\n\n    json_builder_end_array (group);\n    json_builder_end_object (group);\n\n    root = json_builder_get_root (group);\n    json = json_to_string (root, FALSE);\n    g_string_append (result, json);\n    g_free (json);\n    json_node_unref (root);\n\n    g_object_unref (group);\n  }\n\n  g_string_append_c (result, ']');\n\n  return g_string_free (result, FALSE);\n}\n\nstatic GPatternSpec *\nmake_pattern_spec (const gchar * pattern,\n                   jboolean ignore_case)\n{\n  GPatternSpec * spec;\n\n  if (ignore_case)\n  {\n    gchar * str = g_utf8_strdown (pattern, -1);\n    spec = g_pattern_spec_new (str);\n    g_free (str);\n  }\n  else\n  {\n    spec = g_pattern_spec_new (pattern);\n  }\n\n  return spec;\n}\n\nstatic gchar *\nclass_name_from_signature (const gchar * descriptor)\n{\n  gchar * result, * c;\n\n  result = g_strdup (descriptor + 1);\n\n  for (c = result; *c != '\\0'; c++)\n  {\n    if (*c == '/')\n      *c = '.';\n  }\n\n  c[-1] = '\\0';\n\n  return result;\n}\n\nstatic gchar *\nformat_method_signature (const gchar * name,\n                         const gchar * signature)\n{\n  GString * sig;\n  const gchar * cursor;\n  gint arg_index;\n\n  sig = g_string_sized_new (128);\n\n  g_string_append (sig, name);\n\n  cursor = signature;\n  arg_index = -1;\n  while (TRUE)\n  {\n    const gchar c = *cursor;\n\n    if (c == '(')\n    {\n      g_string_append_c (sig, c);\n      cursor++;\n      arg_index = 0;\n    }\n    else if (c == ')')\n    {\n      g_string_append_c (sig, c);\n      cursor++;\n      break;\n    }\n    else\n    {\n      if (arg_index >= 1)\n        g_string_append (sig, \", \");\n\n      append_type (sig, &cursor);\n\n      if (arg_index != -1)\n        arg_index++;\n    }\n  }\n\n  g_string_append (sig, \": \");\n  append_type (sig, &cursor);\n\n  return g_string_free (sig, FALSE);\n}\n\nstatic void\nappend_type (GString * output,\n             const gchar ** type)\n{\n  const gchar * cursor = *type;\n\n  switch (*cursor)\n  {\n    case 'Z':\n      g_string_append (output, \"boolean\");\n      cursor++;\n      break;\n    case 'B':\n      g_string_append (output, \"byte\");\n      cursor++;\n      break;\n    case 'C':\n      g_string_append (output, \"char\");\n      cursor++;\n      break;\n    case 'S':\n      g_string_append (output, \"short\");\n      cursor++;\n      break;\n    case 'I':\n      g_string_append (output, \"int\");\n      cursor++;\n      break;\n    case 'J':\n      g_string_append (output, \"long\");\n      cursor++;\n      break;\n    case 'F':\n      g_string_append (output, \"float\");\n      cursor++;\n      break;\n    case 'D':\n      g_string_append (output, \"double\");\n      cursor++;\n      break;\n    case 'V':\n      g_string_append (output, \"void\");\n      cursor++;\n      break;\n    case 'L':\n    {\n      gchar ch;\n\n      cursor++;\n      for (; (ch = *cursor) != ';'; cursor++)\n      {\n        g_string_append_c (output, (ch != '/') ? ch : '.');\n      }\n      cursor++;\n\n      break;\n    }\n    case '[':\n      *type = cursor + 1;\n      append_type (output, type);\n      g_string_append (output, \"[]\");\n      return;\n    default:\n      g_string_append (output, \"BUG\");\n      cursor++;\n  }\n\n  *type = cursor;\n}\n\nvoid\ndealloc (gpointer mem)\n{\n  g_free (mem);\n}\n\nstatic gpointer\nread_art_array (gpointer object_base,\n                guint field_offset,\n                guint length_size,\n                guint * length)\n{\n  gpointer result, header;\n  guint n;\n\n  header = GSIZE_TO_POINTER (*(guint64 *) (object_base + field_offset));\n  if (header != NULL)\n  {\n    result = header + length_size;\n    if (length_size == sizeof (guint32))\n      n = *(guint32 *) header;\n    else\n      n = *(guint64 *) header;\n  }\n  else\n  {\n    result = NULL;\n    n = 0;\n  }\n\n  if (length != NULL)\n    *length = n;\n\n  return result;\n}\n\nstatic void\nstd_string_destroy (StdString * str)\n{\n  if ((str->l.capacity & 1) != 0)\n    art_api.free (str->l.data);\n}\n\nstatic gchar *\nstd_string_c_str (StdString * self)\n{\n  if ((self->l.capacity & 1) != 0)\n    return self->l.data;\n\n  return self->s.data;\n}\n",_=/(.+)!([^/]+)\/?([isu]+)?/;let o=null,i=null;export default class l{static build(n,e){return d(e),i(n,e,(t=>new l(o.new(n,t,e))))}static enumerateMethods(e,t,s){d(s);const a=e.match(_);if(null===a)throw new Error("Invalid query; format is: class!method -- see documentation of Java.enumerateMethods(query) for details");const r=Memory.allocUtf8String(a[1]),i=Memory.allocUtf8String(a[2]);let l=!1,c=!1,g=!1;const u=a[3];let f;if(void 0!==u&&(l=-1!==u.indexOf("s"),c=-1!==u.indexOf("i"),g=-1!==u.indexOf("u")),null!==t.jvmti){const n=o.enumerateMethodsJvm(r,i,m(l),m(c),m(g),s);try{f=JSON.parse(n.readUtf8String()).map((n=>{const e=ptr(n.loader);return n.loader=e.isNull()?null:e,n}))}finally{o.dealloc(n)}}else n(s.vm,s,(n=>{const e=o.enumerateMethodsArt(r,i,m(l),m(c),m(g));try{const s=t["art::JavaVMExt::AddGlobalRef"],{vm:a}=t;f=JSON.parse(e.readUtf8String()).map((e=>{const t=e.loader;return e.loader=0!==t?s(a,n,ptr(t)):null,e}))}finally{o.dealloc(e)}}));return f}constructor(n){this.handle=n}has(n){return 0!==o.has(this.handle,Memory.allocUtf8String(n))}find(n){return o.find(this.handle,Memory.allocUtf8String(n)).readUtf8String()}list(){const n=o.list(this.handle);try{return JSON.parse(n.readUtf8String())}finally{o.dealloc(n)}}}function d(_){null===o&&(o=function(n){const _=a(),{jvmti:o=null}=_,{pointerSize:i}=Process,l=8,d=i,c=7*i,m=l+d+c+(40+5*i),g=Memory.alloc(m),u=g.add(l),f=u.add(d),{getDeclaredMethods:h,getDeclaredFields:p}=n.javaLangClass(),j=n.javaLangReflectMethod(),b=n.javaLangReflectField();let v=f;[null!==o?o:NULL,h,p,j.getName,j.getModifiers,b.getName,b.getModifiers].forEach((n=>{v=v.writePointer(n).add(i)}));const y=f.add(c),{vm:L}=n;if("art"===_.flavor){let n;if(null!==o)n=[0,0,0,0];else{const t=e(L).offset;n=[t.ifields,t.methods,t.sfields,t.copiedMethodsOffset]}const a=t(L),r=s(L);let l=y;[1,...n,a.size,a.offset.accessFlags,r.size,r.offset.accessFlags,4294967295].forEach((n=>{l=l.writeUInt(n).add(4)})),[_.artClassLinker.address,_["art::ClassLinker::VisitClasses"],_["art::mirror::Class::GetDescriptor"],_["art::ArtMethod::PrettyMethod"],Process.getModuleByName("libc.so").getExportByName("free")].forEach(((n,e)=>{void 0===n&&(n=NULL),l=l.writePointer(n).add(i)}))}const N=new CModule(r,{lock:g,models:u,java_api:f,art_api:y}),k={exceptions:"propagate"},E={exceptions:"propagate",scheduling:"exclusive"};return{handle:N,new:new NativeFunction(N.model_new,"pointer",["pointer","pointer","pointer"],k),has:new NativeFunction(N.model_has,"bool",["pointer","pointer"],E),find:new NativeFunction(N.model_find,"pointer",["pointer","pointer"],E),list:new NativeFunction(N.model_list,"pointer",["pointer"],E),enumerateMethodsArt:new NativeFunction(N.enumerate_methods_art,"pointer",["pointer","pointer","bool","bool","bool"],k),enumerateMethodsJvm:new NativeFunction(N.enumerate_methods_jvm,"pointer",["pointer","pointer","bool","bool","bool","pointer"],k),dealloc:new NativeFunction(N.dealloc,"void",["pointer"],E)}}(_),i=function(e,t){const s=a();if("art"!==s.flavor)return c;const r=s["art::JavaVMExt::DecodeGlobal"];return function(e,s,a){let _;return n(t,s,(n=>{const s=r(t,n,e);_=a(s)})),_}}(0,_.vm))}function c(n,e,t){return t(NULL)}function m(n){return n?1:0}
âœ„
{"version":3,"file":"env.js","names":["Env","handle","vm","this","pointerSize","Process","callMethodOffset","pointer","uint8","int8","uint16","int16","int32","int64","float","double","void","callNonvirtualMethodOffset","callStaticMethodOffset","getFieldOffset","setFieldOffset","getStaticFieldOffset","setStaticFieldOffset","nativeFunctionOptions","exceptions","cachedVtable","globalRefs","register","globalRef","push","vtable","instance","readPointer","proxy","offset","retType","argTypes","wrapper","impl","NativeFunction","add","args","concat","apply","arguments","dispose","env","forEach","deleteGlobalRef","prototype","getVersion","findClass","name","result","Memory","allocUtf8String","throwIfExceptionPending","throwable","exceptionOccurred","isNull","exceptionClear","newGlobalRef","deleteLocalRef","description","vaMethod","javaLangObject","toString","descriptionStr","stringFromJni","error","Error","$h","Script","bindWeak","perform","makeErrorHandleDestructor","fromReflectedMethod","method","fromReflectedField","toReflectedMethod","klass","methodId","isStatic","getSuperclass","isAssignableFrom","klass1","klass2","toReflectedField","fieldId","throw","obj","exceptionDescribe","pushLocalFrame","capacity","popLocalFrame","localRef","isSameObject","ref1","ref2","newLocalRef","allocObject","clazz","getObjectClass","isInstanceOf","getMethodId","sig","getFieldId","getIntField","getStaticMethodId","getStaticFieldId","getStaticIntField","getStringLength","str","getStringChars","NULL","releaseStringChars","utf","newStringUtf","getStringUtfChars","releaseStringUtfChars","getArrayLength","array","newObjectArray","length","elementClass","initialElement","getObjectArrayElement","index","setObjectArrayElement","value","newBooleanArray","newByteArray","newCharArray","newShortArray","newIntArray","newLongArray","newFloatArray","newDoubleArray","getBooleanArrayElements","getByteArrayElements","getCharArrayElements","getShortArrayElements","getIntArrayElements","getLongArrayElements","getFloatArrayElements","getDoubleArrayElements","releaseBooleanArrayElements","cArray","releaseByteArrayElements","releaseCharArrayElements","releaseShortArrayElements","releaseIntArrayElements","releaseLongArrayElements","releaseFloatArrayElements","releaseDoubleArrayElements","getByteArrayRegion","start","setBooleanArrayRegion","setByteArrayRegion","setCharArrayRegion","setShortArrayRegion","setIntArrayRegion","setLongArrayRegion","setFloatArrayRegion","setDoubleArrayRegion","registerNatives","methods","numMethods","monitorEnter","monitorExit","getDirectBufferAddress","getObjectRefType","ref","cachedMethods","Map","plainMethod","options","getOrMakeMethod","makePlainMethod","makeVaMethod","nonvirtualVaMethod","makeNonvirtualVaMethod","flavor","construct","undefined","key","join","m","get","set","constructor","call","staticVaMethod","getField","fieldType","getStaticField","setField","setStaticField","javaLangClass","bind","getName","getSimpleName","getGenericSuperclass","getDeclaredConstructors","getDeclaredMethods","getDeclaredFields","isArray","isPrimitive","isInterface","getComponentType","getClass","javaLangReflectConstructor","getGenericParameterTypes","javaLangReflectMethod","getParameterTypes","getGenericReturnType","getGenericExceptionTypes","getModifiers","isVarArgs","javaLangReflectField","getType","getGenericType","javaLangReflectTypeVariable","getBounds","getGenericDeclaration","javaLangReflectWildcardType","getLowerBounds","getUpperBounds","javaLangReflectGenericArrayType","getGenericComponentType","javaLangReflectParameterizedType","getActualTypeArguments","getRawType","getOwnerType","javaLangString","getClassName","classHandle","getObjectClassName","objHandle","jklass","getActualTypeArgument","type","actualTypeArguments","getTypeNameFromFirstTypeElement","typeArray","typeArgument0","getTypeName","getGenericsInformation","invokeObjectMethodNoArgs","getArrayTypeName","rawType","componentType","readUtf16String"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"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","ignoreList":[]}
âœ„
export default function t(t,e){this.handle=t,this.vm=e}const e=Process.pointerSize,n={pointer:34,uint8:37,int8:40,uint16:43,int16:46,int32:49,int64:52,float:55,double:58,void:61},r={pointer:64,uint8:67,int8:70,uint16:73,int16:76,int32:79,int64:82,float:85,double:88,void:91},i={pointer:114,uint8:117,int8:120,uint16:123,int16:126,int32:129,int64:132,float:135,double:138,void:141},o={pointer:95,uint8:96,int8:97,uint16:98,int16:99,int32:100,int64:101,float:102,double:103},a={pointer:104,uint8:105,int8:106,uint16:107,int16:108,int32:109,int64:110,float:111,double:112},p={pointer:145,uint8:146,int8:147,uint16:148,int16:149,int32:150,int64:151,float:152,double:153},l={pointer:154,uint8:155,int8:156,uint16:157,int16:158,int32:159,int64:160,float:161,double:162},s={exceptions:"propagate"};let c=null,h=[];function u(t){return h.push(t),t}function f(t){return null===c&&(c=t.handle.readPointer()),c}function d(t,n,r,i){let o=null;return function(){null===o&&(o=new NativeFunction(f(this).add(t*e).readPointer(),n,r,s));let a=[o];return a=a.concat.apply(a,arguments),i.apply(this,a)}}t.dispose=function(t){h.forEach(t.deleteGlobalRef,t),h=[]},t.prototype.getVersion=d(4,"int32",["pointer"],(function(t){return t(this.handle)})),t.prototype.findClass=d(6,"pointer",["pointer","pointer"],(function(t,e){const n=t(this.handle,Memory.allocUtf8String(e));return this.throwIfExceptionPending(),n})),t.prototype.throwIfExceptionPending=function(){const t=this.exceptionOccurred();if(t.isNull())return;this.exceptionClear();const e=this.newGlobalRef(t);this.deleteLocalRef(t);const n=this.vaMethod("pointer",[])(this.handle,e,this.javaLangObject().toString),r=this.stringFromJni(n);this.deleteLocalRef(n);const i=new Error(r);throw i.$h=e,Script.bindWeak(i,function(t,e){return function(){t.perform((t=>{t.deleteGlobalRef(e)}))}}(this.vm,e)),i},t.prototype.fromReflectedMethod=d(7,"pointer",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.fromReflectedField=d(8,"pointer",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.toReflectedMethod=d(9,"pointer",["pointer","pointer","pointer","uint8"],(function(t,e,n,r){return t(this.handle,e,n,r)})),t.prototype.getSuperclass=d(10,"pointer",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.isAssignableFrom=d(11,"uint8",["pointer","pointer","pointer"],(function(t,e,n){return!!t(this.handle,e,n)})),t.prototype.toReflectedField=d(12,"pointer",["pointer","pointer","pointer","uint8"],(function(t,e,n,r){return t(this.handle,e,n,r)})),t.prototype.throw=d(13,"int32",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.exceptionOccurred=d(15,"pointer",["pointer"],(function(t){return t(this.handle)})),t.prototype.exceptionDescribe=d(16,"void",["pointer"],(function(t){t(this.handle)})),t.prototype.exceptionClear=d(17,"void",["pointer"],(function(t){t(this.handle)})),t.prototype.pushLocalFrame=d(19,"int32",["pointer","int32"],(function(t,e){return t(this.handle,e)})),t.prototype.popLocalFrame=d(20,"pointer",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.newGlobalRef=d(21,"pointer",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.deleteGlobalRef=d(22,"void",["pointer","pointer"],(function(t,e){t(this.handle,e)})),t.prototype.deleteLocalRef=d(23,"void",["pointer","pointer"],(function(t,e){t(this.handle,e)})),t.prototype.isSameObject=d(24,"uint8",["pointer","pointer","pointer"],(function(t,e,n){return!!t(this.handle,e,n)})),t.prototype.newLocalRef=d(25,"pointer",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.allocObject=d(27,"pointer",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.getObjectClass=d(31,"pointer",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.isInstanceOf=d(32,"uint8",["pointer","pointer","pointer"],(function(t,e,n){return!!t(this.handle,e,n)})),t.prototype.getMethodId=d(33,"pointer",["pointer","pointer","pointer","pointer"],(function(t,e,n,r){return t(this.handle,e,Memory.allocUtf8String(n),Memory.allocUtf8String(r))})),t.prototype.getFieldId=d(94,"pointer",["pointer","pointer","pointer","pointer"],(function(t,e,n,r){return t(this.handle,e,Memory.allocUtf8String(n),Memory.allocUtf8String(r))})),t.prototype.getIntField=d(100,"int32",["pointer","pointer","pointer"],(function(t,e,n){return t(this.handle,e,n)})),t.prototype.getStaticMethodId=d(113,"pointer",["pointer","pointer","pointer","pointer"],(function(t,e,n,r){return t(this.handle,e,Memory.allocUtf8String(n),Memory.allocUtf8String(r))})),t.prototype.getStaticFieldId=d(144,"pointer",["pointer","pointer","pointer","pointer"],(function(t,e,n,r){return t(this.handle,e,Memory.allocUtf8String(n),Memory.allocUtf8String(r))})),t.prototype.getStaticIntField=d(150,"int32",["pointer","pointer","pointer"],(function(t,e,n){return t(this.handle,e,n)})),t.prototype.getStringLength=d(164,"int32",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.getStringChars=d(165,"pointer",["pointer","pointer","pointer"],(function(t,e){return t(this.handle,e,NULL)})),t.prototype.releaseStringChars=d(166,"void",["pointer","pointer","pointer"],(function(t,e,n){t(this.handle,e,n)})),t.prototype.newStringUtf=d(167,"pointer",["pointer","pointer"],(function(t,e){const n=Memory.allocUtf8String(e);return t(this.handle,n)})),t.prototype.getStringUtfChars=d(169,"pointer",["pointer","pointer","pointer"],(function(t,e){return t(this.handle,e,NULL)})),t.prototype.releaseStringUtfChars=d(170,"void",["pointer","pointer","pointer"],(function(t,e,n){t(this.handle,e,n)})),t.prototype.getArrayLength=d(171,"int32",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.newObjectArray=d(172,"pointer",["pointer","int32","pointer","pointer"],(function(t,e,n,r){return t(this.handle,e,n,r)})),t.prototype.getObjectArrayElement=d(173,"pointer",["pointer","pointer","int32"],(function(t,e,n){return t(this.handle,e,n)})),t.prototype.setObjectArrayElement=d(174,"void",["pointer","pointer","int32","pointer"],(function(t,e,n,r){t(this.handle,e,n,r)})),t.prototype.newBooleanArray=d(175,"pointer",["pointer","int32"],(function(t,e){return t(this.handle,e)})),t.prototype.newByteArray=d(176,"pointer",["pointer","int32"],(function(t,e){return t(this.handle,e)})),t.prototype.newCharArray=d(177,"pointer",["pointer","int32"],(function(t,e){return t(this.handle,e)})),t.prototype.newShortArray=d(178,"pointer",["pointer","int32"],(function(t,e){return t(this.handle,e)})),t.prototype.newIntArray=d(179,"pointer",["pointer","int32"],(function(t,e){return t(this.handle,e)})),t.prototype.newLongArray=d(180,"pointer",["pointer","int32"],(function(t,e){return t(this.handle,e)})),t.prototype.newFloatArray=d(181,"pointer",["pointer","int32"],(function(t,e){return t(this.handle,e)})),t.prototype.newDoubleArray=d(182,"pointer",["pointer","int32"],(function(t,e){return t(this.handle,e)})),t.prototype.getBooleanArrayElements=d(183,"pointer",["pointer","pointer","pointer"],(function(t,e){return t(this.handle,e,NULL)})),t.prototype.getByteArrayElements=d(184,"pointer",["pointer","pointer","pointer"],(function(t,e){return t(this.handle,e,NULL)})),t.prototype.getCharArrayElements=d(185,"pointer",["pointer","pointer","pointer"],(function(t,e){return t(this.handle,e,NULL)})),t.prototype.getShortArrayElements=d(186,"pointer",["pointer","pointer","pointer"],(function(t,e){return t(this.handle,e,NULL)})),t.prototype.getIntArrayElements=d(187,"pointer",["pointer","pointer","pointer"],(function(t,e){return t(this.handle,e,NULL)})),t.prototype.getLongArrayElements=d(188,"pointer",["pointer","pointer","pointer"],(function(t,e){return t(this.handle,e,NULL)})),t.prototype.getFloatArrayElements=d(189,"pointer",["pointer","pointer","pointer"],(function(t,e){return t(this.handle,e,NULL)})),t.prototype.getDoubleArrayElements=d(190,"pointer",["pointer","pointer","pointer"],(function(t,e){return t(this.handle,e,NULL)})),t.prototype.releaseBooleanArrayElements=d(191,"pointer",["pointer","pointer","pointer","int32"],(function(t,e,n){t(this.handle,e,n,2)})),t.prototype.releaseByteArrayElements=d(192,"pointer",["pointer","pointer","pointer","int32"],(function(t,e,n){t(this.handle,e,n,2)})),t.prototype.releaseCharArrayElements=d(193,"pointer",["pointer","pointer","pointer","int32"],(function(t,e,n){t(this.handle,e,n,2)})),t.prototype.releaseShortArrayElements=d(194,"pointer",["pointer","pointer","pointer","int32"],(function(t,e,n){t(this.handle,e,n,2)})),t.prototype.releaseIntArrayElements=d(195,"pointer",["pointer","pointer","pointer","int32"],(function(t,e,n){t(this.handle,e,n,2)})),t.prototype.releaseLongArrayElements=d(196,"pointer",["pointer","pointer","pointer","int32"],(function(t,e,n){t(this.handle,e,n,2)})),t.prototype.releaseFloatArrayElements=d(197,"pointer",["pointer","pointer","pointer","int32"],(function(t,e,n){t(this.handle,e,n,2)})),t.prototype.releaseDoubleArrayElements=d(198,"pointer",["pointer","pointer","pointer","int32"],(function(t,e,n){t(this.handle,e,n,2)})),t.prototype.getByteArrayRegion=d(200,"void",["pointer","pointer","int","int","pointer"],(function(t,e,n,r,i){t(this.handle,e,n,r,i)})),t.prototype.setBooleanArrayRegion=d(207,"void",["pointer","pointer","int32","int32","pointer"],(function(t,e,n,r,i){t(this.handle,e,n,r,i)})),t.prototype.setByteArrayRegion=d(208,"void",["pointer","pointer","int32","int32","pointer"],(function(t,e,n,r,i){t(this.handle,e,n,r,i)})),t.prototype.setCharArrayRegion=d(209,"void",["pointer","pointer","int32","int32","pointer"],(function(t,e,n,r,i){t(this.handle,e,n,r,i)})),t.prototype.setShortArrayRegion=d(210,"void",["pointer","pointer","int32","int32","pointer"],(function(t,e,n,r,i){t(this.handle,e,n,r,i)})),t.prototype.setIntArrayRegion=d(211,"void",["pointer","pointer","int32","int32","pointer"],(function(t,e,n,r,i){t(this.handle,e,n,r,i)})),t.prototype.setLongArrayRegion=d(212,"void",["pointer","pointer","int32","int32","pointer"],(function(t,e,n,r,i){t(this.handle,e,n,r,i)})),t.prototype.setFloatArrayRegion=d(213,"void",["pointer","pointer","int32","int32","pointer"],(function(t,e,n,r,i){t(this.handle,e,n,r,i)})),t.prototype.setDoubleArrayRegion=d(214,"void",["pointer","pointer","int32","int32","pointer"],(function(t,e,n,r,i){t(this.handle,e,n,r,i)})),t.prototype.registerNatives=d(215,"int32",["pointer","pointer","pointer","int32"],(function(t,e,n,r){return t(this.handle,e,n,r)})),t.prototype.monitorEnter=d(217,"int32",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.monitorExit=d(218,"int32",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.getDirectBufferAddress=d(230,"pointer",["pointer","pointer"],(function(t,e){return t(this.handle,e)})),t.prototype.getObjectRefType=d(232,"int32",["pointer","pointer"],(function(t,e){return t(this.handle,e)}));const y=new Map;function g(t,e,n,r){return m(this,"p",j,t,e,n,r)}function v(t,e,n,r){return m(this,"v",T,t,e,n,r)}function L(t,e,n,r){return m(this,"n",R,t,e,n,r)}function m(t,e,n,r,i,o,a){if(void 0!==a)return n(t,r,i,o,a);const p=[r,e,i].concat(o).join("|");let l=y.get(p);return void 0===l&&(l=n(t,r,i,o,s),y.set(p,l)),l}function j(t,n,r,i,o){return new NativeFunction(f(t).add(n*e).readPointer(),r,["pointer","pointer","pointer"].concat(i),o)}function T(t,n,r,i,o){return new NativeFunction(f(t).add(n*e).readPointer(),r,["pointer","pointer","pointer","..."].concat(i),o)}function R(t,n,r,i,o){return new NativeFunction(f(t).add(n*e).readPointer(),r,["pointer","pointer","pointer","pointer","..."].concat(i),o)}t.prototype.constructor=function(t,e){return v.call(this,28,"pointer",t,e)},t.prototype.vaMethod=function(t,e,r){const i=n[t];if(void 0===i)throw new Error("Unsupported type: "+t);return v.call(this,i,t,e,r)},t.prototype.nonvirtualVaMethod=function(t,e,n){const i=r[t];if(void 0===i)throw new Error("Unsupported type: "+t);return L.call(this,i,t,e,n)},t.prototype.staticVaMethod=function(t,e,n){const r=i[t];if(void 0===r)throw new Error("Unsupported type: "+t);return v.call(this,r,t,e,n)},t.prototype.getField=function(t){const e=o[t];if(void 0===e)throw new Error("Unsupported type: "+t);return g.call(this,e,t,[])},t.prototype.getStaticField=function(t){const e=p[t];if(void 0===e)throw new Error("Unsupported type: "+t);return g.call(this,e,t,[])},t.prototype.setField=function(t){const e=a[t];if(void 0===e)throw new Error("Unsupported type: "+t);return g.call(this,e,"void",[t])},t.prototype.setStaticField=function(t){const e=l[t];if(void 0===e)throw new Error("Unsupported type: "+t);return g.call(this,e,"void",[t])};let A=null;t.prototype.javaLangClass=function(){if(null===A){const t=this.findClass("java/lang/Class");try{const e=this.getMethodId.bind(this,t);A={handle:u(this.newGlobalRef(t)),getName:e("getName","()Ljava/lang/String;"),getSimpleName:e("getSimpleName","()Ljava/lang/String;"),getGenericSuperclass:e("getGenericSuperclass","()Ljava/lang/reflect/Type;"),getDeclaredConstructors:e("getDeclaredConstructors","()[Ljava/lang/reflect/Constructor;"),getDeclaredMethods:e("getDeclaredMethods","()[Ljava/lang/reflect/Method;"),getDeclaredFields:e("getDeclaredFields","()[Ljava/lang/reflect/Field;"),isArray:e("isArray","()Z"),isPrimitive:e("isPrimitive","()Z"),isInterface:e("isInterface","()Z"),getComponentType:e("getComponentType","()Ljava/lang/Class;")}}finally{this.deleteLocalRef(t)}}return A};let w=null;t.prototype.javaLangObject=function(){if(null===w){const t=this.findClass("java/lang/Object");try{const e=this.getMethodId.bind(this,t);w={handle:u(this.newGlobalRef(t)),toString:e("toString","()Ljava/lang/String;"),getClass:e("getClass","()Ljava/lang/Class;")}}finally{this.deleteLocalRef(t)}}return w};let b=null;t.prototype.javaLangReflectConstructor=function(){if(null===b){const t=this.findClass("java/lang/reflect/Constructor");try{b={getGenericParameterTypes:this.getMethodId(t,"getGenericParameterTypes","()[Ljava/lang/reflect/Type;")}}finally{this.deleteLocalRef(t)}}return b};let C=null;t.prototype.javaLangReflectMethod=function(){if(null===C){const t=this.findClass("java/lang/reflect/Method");try{const e=this.getMethodId.bind(this,t);C={getName:e("getName","()Ljava/lang/String;"),getGenericParameterTypes:e("getGenericParameterTypes","()[Ljava/lang/reflect/Type;"),getParameterTypes:e("getParameterTypes","()[Ljava/lang/Class;"),getGenericReturnType:e("getGenericReturnType","()Ljava/lang/reflect/Type;"),getGenericExceptionTypes:e("getGenericExceptionTypes","()[Ljava/lang/reflect/Type;"),getModifiers:e("getModifiers","()I"),isVarArgs:e("isVarArgs","()Z")}}finally{this.deleteLocalRef(t)}}return C};let S=null;t.prototype.javaLangReflectField=function(){if(null===S){const t=this.findClass("java/lang/reflect/Field");try{const e=this.getMethodId.bind(this,t);S={getName:e("getName","()Ljava/lang/String;"),getType:e("getType","()Ljava/lang/Class;"),getGenericType:e("getGenericType","()Ljava/lang/reflect/Type;"),getModifiers:e("getModifiers","()I"),toString:e("toString","()Ljava/lang/String;")}}finally{this.deleteLocalRef(t)}}return S};let N=null;t.prototype.javaLangReflectTypeVariable=function(){if(null===N){const t=this.findClass("java/lang/reflect/TypeVariable");try{const e=this.getMethodId.bind(this,t);N={handle:u(this.newGlobalRef(t)),getName:e("getName","()Ljava/lang/String;"),getBounds:e("getBounds","()[Ljava/lang/reflect/Type;"),getGenericDeclaration:e("getGenericDeclaration","()Ljava/lang/reflect/GenericDeclaration;")}}finally{this.deleteLocalRef(t)}}return N};let M=null;t.prototype.javaLangReflectWildcardType=function(){if(null===M){const t=this.findClass("java/lang/reflect/WildcardType");try{const e=this.getMethodId.bind(this,t);M={handle:u(this.newGlobalRef(t)),getLowerBounds:e("getLowerBounds","()[Ljava/lang/reflect/Type;"),getUpperBounds:e("getUpperBounds","()[Ljava/lang/reflect/Type;")}}finally{this.deleteLocalRef(t)}}return M};let E=null;t.prototype.javaLangReflectGenericArrayType=function(){if(null===E){const t=this.findClass("java/lang/reflect/GenericArrayType");try{E={handle:u(this.newGlobalRef(t)),getGenericComponentType:this.getMethodId(t,"getGenericComponentType","()Ljava/lang/reflect/Type;")}}finally{this.deleteLocalRef(t)}}return E};let I=null;t.prototype.javaLangReflectParameterizedType=function(){if(null===I){const t=this.findClass("java/lang/reflect/ParameterizedType");try{const e=this.getMethodId.bind(this,t);I={handle:u(this.newGlobalRef(t)),getActualTypeArguments:e("getActualTypeArguments","()[Ljava/lang/reflect/Type;"),getRawType:e("getRawType","()Ljava/lang/reflect/Type;"),getOwnerType:e("getOwnerType","()Ljava/lang/reflect/Type;")}}finally{this.deleteLocalRef(t)}}return I};let G=null;t.prototype.javaLangString=function(){if(null===G){const t=this.findClass("java/lang/String");try{G={handle:u(this.newGlobalRef(t))}}finally{this.deleteLocalRef(t)}}return G},t.prototype.getClassName=function(t){const e=this.vaMethod("pointer",[])(this.handle,t,this.javaLangClass().getName);try{return this.stringFromJni(e)}finally{this.deleteLocalRef(e)}},t.prototype.getObjectClassName=function(t){const e=this.getObjectClass(t);try{return this.getClassName(e)}finally{this.deleteLocalRef(e)}},t.prototype.getActualTypeArgument=function(t){const e=this.vaMethod("pointer",[])(this.handle,t,this.javaLangReflectParameterizedType().getActualTypeArguments);if(this.throwIfExceptionPending(),!e.isNull())try{return this.getTypeNameFromFirstTypeElement(e)}finally{this.deleteLocalRef(e)}},t.prototype.getTypeNameFromFirstTypeElement=function(t){if(!(this.getArrayLength(t)>0))return"java.lang.Object";{const e=this.getObjectArrayElement(t,0);try{return this.getTypeName(e)}finally{this.deleteLocalRef(e)}}},t.prototype.getTypeName=function(t,e){const n=this.vaMethod("pointer",[]);if(this.isInstanceOf(t,this.javaLangClass().handle))return this.getClassName(t);if(this.isInstanceOf(t,this.javaLangReflectGenericArrayType().handle))return this.getArrayTypeName(t);if(this.isInstanceOf(t,this.javaLangReflectParameterizedType().handle)){const r=n(this.handle,t,this.javaLangReflectParameterizedType().getRawType);let i;this.throwIfExceptionPending();try{i=this.getTypeName(r)}finally{this.deleteLocalRef(r)}return e&&(i+="<"+this.getActualTypeArgument(t)+">"),i}return this.isInstanceOf(t,this.javaLangReflectTypeVariable().handle)||this.isInstanceOf(t,this.javaLangReflectWildcardType().handle),"java.lang.Object"},t.prototype.getArrayTypeName=function(t){const e=this.vaMethod("pointer",[]);if(this.isInstanceOf(t,this.javaLangClass().handle))return this.getClassName(t);if(!this.isInstanceOf(t,this.javaLangReflectGenericArrayType().handle))return"[Ljava.lang.Object;";{const n=e(this.handle,t,this.javaLangReflectGenericArrayType().getGenericComponentType);this.throwIfExceptionPending();try{return"[L"+this.getTypeName(n)+";"}finally{this.deleteLocalRef(n)}}},t.prototype.stringFromJni=function(t){const e=this.getStringChars(t);if(e.isNull())throw new Error("Unable to access string");try{const n=this.getStringLength(t);return e.readUtf16String(n)}finally{this.releaseStringChars(t,e)}};
âœ„
{"version":3,"file":"jvm.js","names":["jvmtiVersion","jvmtiCapabilities","EnvJvmti","parseInstructionsAt","memoize","checkJniResult","VM","pointerSize","Process","nativeFunctionOptions","exceptions","getJvmMethodSpec","api","getApi","version","adapterHandlerLocation","methodSize","adapterInMethodEarlyOffset","adapterInMethodEarlySize","accessFlagsOffset","vtableIndexOffset","i2iEntryOffset","adapterInMethodLateOffset","adapterInMethodOffset","stackmapDataOffset","adapterInConstMethodOffset","adapterInConstMethodSize","constMethodSizeOffset","getAdapterPointer","method","constMethod","add","size","constMethodOffset","methodDataOffset","methodCountersOffset","nativeFunctionOffset","signatureHandlerOffset","constantPoolOffset","sizeOffset","methodIdnumOffset","constantPool","cacheOffset","instanceKlassOffset","getJvmInstanceKlassSpec","jvmVersion","createNewDefaultVtableIndices","tryParse","vtableOffsetParsers","arch","undefined","Error","vtableOffset","limit","methodsOffset","memberNamesOffset","oopMapCacheOffset","getJvmThreadSpec","vtableRedefineClasses","redefineClassesDoIt","redefineClassesDoItPrologue","redefineClassesDoItEpilogue","redefineClassesOnError","redefineClassesAllow","redefineClassesDispose0","redefineClassesDispose1","execute","vtablePtr","vtableSize","vtable","Memory","dup","emptyCallback","NativeCallback","doItOffset","prologueOffset","epilogueOffset","offset","element","value","readPointer","equals","writePointer","cachedApi","manglersScheduled","replaceManglers","Map","revertManglers","vmModules","enumerateModules","filter","m","test","name","length","vmModule","temporaryApi","flavor","pending","platform","module","functions","JNI_GetCreatedJavaVMs","JVM_Sleep","variables","address","this","traversals","shouldSweep","optionals","_ZN6Method4sizeEb","_ZN6Method19set_native_functionEPhb","_ZN6Method21clear_native_functionEv","_ZN6Method24restore_unshareable_infoEP10JavaThread","_ZN6Method24restore_unshareable_infoEP6Thread","_ZN6Method11link_methodERK12methodHandleP10JavaThread","_ZN6Method10jmethod_idEv","_ZN6Method10clear_codeEv","clearCode","NativeFunction","thisPtr","_ZN6Method10clear_codeEb","lock","_ZN18VM_RedefineClasses19mark_dependent_codeEP13InstanceKlass","_ZN18VM_RedefineClasses20flush_dependent_codeEv","_ZN18VM_RedefineClasses20flush_dependent_codeEP13InstanceKlassP6Thread","_ZN18VM_RedefineClasses20flush_dependent_codeE19instanceKlassHandleP6Thread","_ZN19ResolvedMethodTable21adjust_method_entriesEPb","_ZN15MemberNameTable21adjust_method_entriesEP13InstanceKlassPb","_ZN17ConstantPoolCache21adjust_method_entriesEPb","adjustMethod","holderPtr","tracePtr","_ZN17ConstantPoolCache21adjust_method_entriesEP13InstanceKlassPb","_ZN20ClassLoaderDataGraph10classes_doEP12KlassClosure","_ZN20ClassLoaderDataGraph22clean_deallocate_listsEb","_ZN10JavaThread27thread_from_jni_environmentEP7JNIEnv_","_ZN8VMThread7executeEP12VM_Operation","_ZN11OopMapCache22flush_obsolete_entriesEv","_ZN14NMethodSweeper11force_sweepEv","_ZN14NMethodSweeper16sweep_code_cacheEv","_ZN14NMethodSweeper17sweep_in_progressEv","_ZN18VM_RedefineClasses14_the_class_oopE","redefineClass","_ZN18VM_RedefineClasses10_the_classE","_ZN18VM_RedefineClasses25AdjustCpoolCacheAndVtable8do_klassEP5Klass","doKlass","_ZN18VM_RedefineClasses22AdjustAndCleanMetadata8do_klassEP5Klass","_ZTV18VM_RedefineClasses","_ZN18VM_RedefineClasses4doitEv","_ZN18VM_RedefineClasses13doit_prologueEv","_ZN18VM_RedefineClasses13doit_epilogueEv","_ZN18VM_RedefineClassesD0Ev","_ZN18VM_RedefineClassesD1Ev","_ZNK18VM_RedefineClasses26allow_nested_vm_operationsEv","_ZNK18VM_RedefineClasses14print_on_errorEP12outputStream","_ZN13InstanceKlass33create_new_default_vtable_indicesEiP10JavaThread","_ZN13InstanceKlass33create_new_default_vtable_indicesEiP6Thread","_ZN19Abstract_VM_Version19jre_release_versionEv","versionS","getVersion","readCString","startsWith","parseInt","slice","_ZN14NMethodSweeper11_traversalsE","_ZN14NMethodSweeper21_sweep_fractions_leftE","fractions","_ZN14NMethodSweeper13_should_sweepE","missing","forEach","Set","tmp","enumerateExports","reduce","result","exp","exportByName","enumerateSymbols","Object","keys","signature","call","has","push","join","vms","alloc","vmCount","readInt","vm","allocatorFunctions","$new","$delete","rawName","retType","argTypes","entries","Module","findGlobalExportByName","DebugSymbol","fromName","isNull","jvmti","env","perform","handle","tryGetEnvHandle","v1_0","capaBuf","writeU64","canTagObjects","addCapabilities","getEnvJvmti","threadOffsetParsers","findClassImpl","makeThreadFromJniHelper","_getApi","x64","insn","mnemonic","base","disp","operands","ensureClassInitialized","classRef","JvmMethodMangler","constructor","methodId","originalMethod","newMethod","resolved","impl","key","toString","replace","isInstanceMethod","mangler","get","delete","set","ensureManglersScheduled","revert","resolveTarget","wrapper","oldMethod","vtableIndexPtr","writeS32","jmethodID","Script","nextTick","doManglers","localReplaceManglers","localRevertManglers","clear","thread","force","withJvmThread","fetchJvmMethod","constPtr","const","flags","accessFlags","accessFlagsPtr","writeU32","signatureHandler","NULL","adapter","i2iEntry","dataPtr","countersPtr","stackmapPtr","methodHandle","nativeJvmMethod","installJvmMethod","old","vtableIndex","revertJvmMethod","sweep","inProgress","sleep","Thread","trav","readS64","endTrav","readU8","forceSweep","fn","fnPrologue","fnEpilogue","vtableDup","vmOperation","doIt","prologue","epilogue","makeMethodMangler","methodsArray","methodIndex","flushObs","oopMapCache","mark","flush","instanceKlass","traceNamePrinted","writeU8","cache","klassClosure","doKlassPtr","rmtAdjustMethodEntries","memberNames","mntAdjustMethodEntries","clean","spec","constMethodSize","readS32","newConstMethod","copy","readJvmMethod","readU32","instanceKlassSpec","methods","methodsCount","readU16","constSize","dst","type","dstValue","scale","deoptimizeEverything"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"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","ignoreList":[]}
âœ„
import{jvmtiVersion as e,jvmtiCapabilities as t,EnvJvmti as o}from"./jvmti.js";import{parseInstructionsAt as s}from"./machine-code.js";import n from"./memoize.js";import{checkJniResult as a}from"./result.js";import i from"./vm.js";const{pointerSize:r}=Process,d={exceptions:"propagate"},l=n((function(){const e=getApi(),{version:t}=e;let o;o=t>=17?"method:early":t>=9&&t<=16?"const-method":"method:late";const s=e["Method::size"](1)*r,n=4*r,a="method:early"===o?r:0,i=n+a,d=i+4,l=d+4+8,c=l+r,_=0!==a?n:c,h=8+r,f=h+r,u="const-method"===o?r:0,p=f+u;return{getAdapterPointer:0!==u?function(e,t){return t.add(f)}:function(e,t){return e.add(_)},method:{size:s,constMethodOffset:r,methodDataOffset:2*r,methodCountersOffset:3*r,accessFlagsOffset:i,vtableIndexOffset:d,i2iEntryOffset:l,nativeFunctionOffset:s-2*r,signatureHandlerOffset:s-r},constMethod:{constantPoolOffset:8,stackmapDataOffset:h,sizeOffset:p,methodIdnumOffset:p+14},constantPool:{cacheOffset:2*r,instanceKlassOffset:3*r}}})),c=n((function(){const{version:e,createNewDefaultVtableIndices:t}=getApi(),o=E[Process.arch];if(void 0===o)throw new Error(`Missing vtable offset parser for ${Process.arch}`);const n=s(t,o,{limit:32});if(null===n)throw new Error("Unable to deduce vtable offset");return{vtableOffset:n,methodsOffset:n-7*r,memberNamesOffset:n-17*r,oopMapCacheOffset:n-(e>=10&&e<=11||e>=15?17:18)*r}})),_=n((function(){const{vtableRedefineClasses:e,redefineClassesDoIt:t,redefineClassesDoItPrologue:o,redefineClassesDoItEpilogue:s,redefineClassesOnError:n,redefineClassesAllow:a,redefineClassesDispose0:i,redefineClassesDispose1:d,"VMThread::execute":l}=getApi(),c=e.add(2*r),_=15*r,h=Memory.dup(c,_),f=new NativeCallback((()=>{}),"void",["pointer"]);let u,p,v;for(let e=0;e!==_;e+=r){const r=h.add(e),l=r.readPointer();void 0!==n&&l.equals(n)||void 0!==i&&l.equals(i)||void 0!==d&&l.equals(d)?r.writePointer(f):l.equals(t)?u=e:l.equals(o)?(p=e,r.writePointer(a)):l.equals(s)&&(v=e,r.writePointer(f))}return{execute:l,emptyCallback:f,vtable:h,vtableSize:_,doItOffset:u,prologueOffset:p,epilogueOffset:v}}));let h=null,f=!1;const u=new Map,p=new Map;export function getApi(){return null===h&&(h=function(){const n=Process.enumerateModules().filter((e=>/jvm.(dll|dylib|so)$/.test(e.name)));if(0===n.length)return null;const l=n[0],c={flavor:"jvm"},_="windows"===Process.platform?[{module:l,functions:{JNI_GetCreatedJavaVMs:["JNI_GetCreatedJavaVMs","int",["pointer","int","pointer"]],JVM_Sleep:["JVM_Sleep","void",["pointer","pointer","long"]],"VMThread::execute":["VMThread::execute","void",["pointer"]],"Method::size":["Method::size","int",["int"]],"Method::set_native_function":["Method::set_native_function","void",["pointer","pointer","int"]],"Method::clear_native_function":["Method::clear_native_function","void",["pointer"]],"Method::jmethod_id":["Method::jmethod_id","pointer",["pointer"]],"ClassLoaderDataGraph::classes_do":["ClassLoaderDataGraph::classes_do","void",["pointer"]],"NMethodSweeper::sweep_code_cache":["NMethodSweeper::sweep_code_cache","void",[]],"OopMapCache::flush_obsolete_entries":["OopMapCache::flush_obsolete_entries","void",["pointer"]]},variables:{"VM_RedefineClasses::`vftable'":function(e){this.vtableRedefineClasses=e},"VM_RedefineClasses::doit":function(e){this.redefineClassesDoIt=e},"VM_RedefineClasses::doit_prologue":function(e){this.redefineClassesDoItPrologue=e},"VM_RedefineClasses::doit_epilogue":function(e){this.redefineClassesDoItEpilogue=e},"VM_RedefineClasses::allow_nested_vm_operations":function(e){this.redefineClassesAllow=e},"NMethodSweeper::_traversals":function(e){this.traversals=e},"NMethodSweeper::_should_sweep":function(e){this.shouldSweep=e}},optionals:[]}]:[{module:l,functions:{JNI_GetCreatedJavaVMs:["JNI_GetCreatedJavaVMs","int",["pointer","int","pointer"]],_ZN6Method4sizeEb:["Method::size","int",["int"]],_ZN6Method19set_native_functionEPhb:["Method::set_native_function","void",["pointer","pointer","int"]],_ZN6Method21clear_native_functionEv:["Method::clear_native_function","void",["pointer"]],_ZN6Method24restore_unshareable_infoEP10JavaThread:["Method::restore_unshareable_info","void",["pointer","pointer"]],_ZN6Method24restore_unshareable_infoEP6Thread:["Method::restore_unshareable_info","void",["pointer","pointer"]],_ZN6Method11link_methodERK12methodHandleP10JavaThread:["Method::link_method","void",["pointer","pointer","pointer"]],_ZN6Method10jmethod_idEv:["Method::jmethod_id","pointer",["pointer"]],_ZN6Method10clear_codeEv:function(e){const t=new NativeFunction(e,"void",["pointer"],d);this["Method::clear_code"]=function(e){t(e)}},_ZN6Method10clear_codeEb:function(e){const t=new NativeFunction(e,"void",["pointer","int"],d),o=0;this["Method::clear_code"]=function(e){t(e,o)}},_ZN18VM_RedefineClasses19mark_dependent_codeEP13InstanceKlass:["VM_RedefineClasses::mark_dependent_code","void",["pointer","pointer"]],_ZN18VM_RedefineClasses20flush_dependent_codeEv:["VM_RedefineClasses::flush_dependent_code","void",[]],_ZN18VM_RedefineClasses20flush_dependent_codeEP13InstanceKlassP6Thread:["VM_RedefineClasses::flush_dependent_code","void",["pointer","pointer","pointer"]],_ZN18VM_RedefineClasses20flush_dependent_codeE19instanceKlassHandleP6Thread:["VM_RedefineClasses::flush_dependent_code","void",["pointer","pointer","pointer"]],_ZN19ResolvedMethodTable21adjust_method_entriesEPb:["ResolvedMethodTable::adjust_method_entries","void",["pointer"]],_ZN15MemberNameTable21adjust_method_entriesEP13InstanceKlassPb:["MemberNameTable::adjust_method_entries","void",["pointer","pointer","pointer"]],_ZN17ConstantPoolCache21adjust_method_entriesEPb:function(e){const t=new NativeFunction(e,"void",["pointer","pointer"],d);this["ConstantPoolCache::adjust_method_entries"]=function(e,o,s){t(e,s)}},_ZN17ConstantPoolCache21adjust_method_entriesEP13InstanceKlassPb:function(e){const t=new NativeFunction(e,"void",["pointer","pointer","pointer"],d);this["ConstantPoolCache::adjust_method_entries"]=function(e,o,s){t(e,o,s)}},_ZN20ClassLoaderDataGraph10classes_doEP12KlassClosure:["ClassLoaderDataGraph::classes_do","void",["pointer"]],_ZN20ClassLoaderDataGraph22clean_deallocate_listsEb:["ClassLoaderDataGraph::clean_deallocate_lists","void",["int"]],_ZN10JavaThread27thread_from_jni_environmentEP7JNIEnv_:["JavaThread::thread_from_jni_environment","pointer",["pointer"]],_ZN8VMThread7executeEP12VM_Operation:["VMThread::execute","void",["pointer"]],_ZN11OopMapCache22flush_obsolete_entriesEv:["OopMapCache::flush_obsolete_entries","void",["pointer"]],_ZN14NMethodSweeper11force_sweepEv:["NMethodSweeper::force_sweep","void",[]],_ZN14NMethodSweeper16sweep_code_cacheEv:["NMethodSweeper::sweep_code_cache","void",[]],_ZN14NMethodSweeper17sweep_in_progressEv:["NMethodSweeper::sweep_in_progress","bool",[]],JVM_Sleep:["JVM_Sleep","void",["pointer","pointer","long"]]},variables:{_ZN18VM_RedefineClasses14_the_class_oopE:function(e){this.redefineClass=e},_ZN18VM_RedefineClasses10_the_classE:function(e){this.redefineClass=e},_ZN18VM_RedefineClasses25AdjustCpoolCacheAndVtable8do_klassEP5Klass:function(e){this.doKlass=e},_ZN18VM_RedefineClasses22AdjustAndCleanMetadata8do_klassEP5Klass:function(e){this.doKlass=e},_ZTV18VM_RedefineClasses:function(e){this.vtableRedefineClasses=e},_ZN18VM_RedefineClasses4doitEv:function(e){this.redefineClassesDoIt=e},_ZN18VM_RedefineClasses13doit_prologueEv:function(e){this.redefineClassesDoItPrologue=e},_ZN18VM_RedefineClasses13doit_epilogueEv:function(e){this.redefineClassesDoItEpilogue=e},_ZN18VM_RedefineClassesD0Ev:function(e){this.redefineClassesDispose0=e},_ZN18VM_RedefineClassesD1Ev:function(e){this.redefineClassesDispose1=e},_ZNK18VM_RedefineClasses26allow_nested_vm_operationsEv:function(e){this.redefineClassesAllow=e},_ZNK18VM_RedefineClasses14print_on_errorEP12outputStream:function(e){this.redefineClassesOnError=e},_ZN13InstanceKlass33create_new_default_vtable_indicesEiP10JavaThread:function(e){this.createNewDefaultVtableIndices=e},_ZN13InstanceKlass33create_new_default_vtable_indicesEiP6Thread:function(e){this.createNewDefaultVtableIndices=e},_ZN19Abstract_VM_Version19jre_release_versionEv:function(e){const t=new NativeFunction(e,"pointer",[],d)().readCString();this.version=t.startsWith("1.8")?8:t.startsWith("9.")?9:parseInt(t.slice(0,2),10),this.versionS=t},_ZN14NMethodSweeper11_traversalsE:function(e){this.traversals=e},_ZN14NMethodSweeper21_sweep_fractions_leftE:function(e){this.fractions=e},_ZN14NMethodSweeper13_should_sweepE:function(e){this.shouldSweep=e}},optionals:["_ZN6Method24restore_unshareable_infoEP10JavaThread","_ZN6Method24restore_unshareable_infoEP6Thread","_ZN6Method11link_methodERK12methodHandleP10JavaThread","_ZN6Method10clear_codeEv","_ZN6Method10clear_codeEb","_ZN18VM_RedefineClasses19mark_dependent_codeEP13InstanceKlass","_ZN18VM_RedefineClasses20flush_dependent_codeEv","_ZN18VM_RedefineClasses20flush_dependent_codeEP13InstanceKlassP6Thread","_ZN18VM_RedefineClasses20flush_dependent_codeE19instanceKlassHandleP6Thread","_ZN19ResolvedMethodTable21adjust_method_entriesEPb","_ZN15MemberNameTable21adjust_method_entriesEP13InstanceKlassPb","_ZN17ConstantPoolCache21adjust_method_entriesEPb","_ZN17ConstantPoolCache21adjust_method_entriesEP13InstanceKlassPb","_ZN20ClassLoaderDataGraph22clean_deallocate_listsEb","_ZN10JavaThread27thread_from_jni_environmentEP7JNIEnv_","_ZN14NMethodSweeper11force_sweepEv","_ZN14NMethodSweeper17sweep_in_progressEv","_ZN18VM_RedefineClasses14_the_class_oopE","_ZN18VM_RedefineClasses10_the_classE","_ZN18VM_RedefineClasses25AdjustCpoolCacheAndVtable8do_klassEP5Klass","_ZN18VM_RedefineClasses22AdjustAndCleanMetadata8do_klassEP5Klass","_ZN18VM_RedefineClassesD0Ev","_ZN18VM_RedefineClassesD1Ev","_ZNK18VM_RedefineClasses14print_on_errorEP12outputStream","_ZN13InstanceKlass33create_new_default_vtable_indicesEiP10JavaThread","_ZN13InstanceKlass33create_new_default_vtable_indicesEiP6Thread","_ZN14NMethodSweeper21_sweep_fractions_leftE"]}],h=[];if(_.forEach((function(e){const t=e.module,o=e.functions||{},s=e.variables||{},n=new Set(e.optionals||[]),a=t.enumerateExports().reduce((function(e,t){return e[t.name]=t,e}),{}),i=t.enumerateSymbols().reduce((function(e,t){return e[t.name]=t,e}),a);Object.keys(o).forEach((function(e){const t=i[e];if(void 0!==t){const s=o[e];"function"==typeof s?s.call(c,t.address):c[s[0]]=new NativeFunction(t.address,s[1],s[2],d)}else n.has(e)||h.push(e)})),Object.keys(s).forEach((function(e){const t=i[e];if(void 0!==t){s[e].call(c,t.address)}else n.has(e)||h.push(e)}))})),h.length>0)throw new Error("Java API only partially available; please file a bug. Missing: "+h.join(", "));const f=Memory.alloc(r),u=Memory.alloc(4);if(a("JNI_GetCreatedJavaVMs",c.JNI_GetCreatedJavaVMs(f,1,u)),0===u.readInt())return null;c.vm=f.readPointer();const p="windows"===Process.platform?{$new:["??2@YAPEAX_K@Z","pointer",["ulong"]],$delete:["??3@YAXPEAX@Z","void",["pointer"]]}:{$new:["_Znwm","pointer",["ulong"]],$delete:["_ZdlPv","void",["pointer"]]};for(const[e,[t,o,s]]of Object.entries(p)){let n=Module.findGlobalExportByName(t);if(null===n&&(n=DebugSymbol.fromName(t).address,n.isNull()))throw new Error(`unable to find C++ allocator API, missing: '${t}'`);c[e]=new NativeFunction(n,o,s,d)}c.jvmti=function(s){const n=new i(s);let r;return n.perform((()=>{const s=n.tryGetEnvHandle(e.v1_0);if(null===s)throw new Error("JVMTI not available");r=new o(s,n);const i=Memory.alloc(8);i.writeU64(t.canTagObjects);const d=r.addCapabilities(i);a("getEnvJvmti::AddCapabilities",d)})),r}(c),void 0===c["JavaThread::thread_from_jni_environment"]&&(c["JavaThread::thread_from_jni_environment"]=function(e){let t=null;const o=v[Process.arch];if(void 0!==o){const n=new i(e).perform((e=>e.handle.readPointer().add(6*r).readPointer()));t=s(n,o,{limit:11})}if(null===t)return()=>{throw new Error("Unable to make thread_from_jni_environment() helper for the current architecture")};return e=>e.add(t)}(c));return c}()),h}const v={x64:function(e){if("lea"!==e.mnemonic)return null;const{base:t,disp:o}=e.operands[1].value;if(!("rdi"===t&&o<0))return null;return o}};export function ensureClassInitialized(e,t){}class m{constructor(e){this.methodId=e,this.method=e.readPointer(),this.originalMethod=null,this.newMethod=null,this.resolved=null,this.impl=null,this.key=e.toString(16)}replace(e,t,o,s,n){const{key:a}=this,i=p.get(a);void 0!==i&&(p.delete(a),this.method=i.method,this.originalMethod=i.originalMethod,this.newMethod=i.newMethod,this.resolved=i.resolved),this.impl=e,u.set(a,this),M(s)}revert(e){const{key:t}=this;u.delete(t),p.set(t,this),M(e)}resolveTarget(e,t,o,s){const{resolved:n,originalMethod:a,methodId:i}=this;if(null!==n)return n;if(null===a)return i;a.oldMethod.vtableIndexPtr.writeS32(-2);const d=Memory.alloc(r);return d.writePointer(this.method),this.resolved=d,d}}function M(e){f||(f=!0,Script.nextTick(N,e))}function N(e){const t=new Map(u),o=new Map(p);u.clear(),p.clear(),f=!1,e.perform((e=>{const s=getApi(),n=s["JavaThread::thread_from_jni_environment"](e.handle);let a=!1;w((()=>{t.forEach((e=>{const{method:t,originalMethod:o,impl:a,methodId:i,newMethod:d}=e;null===o?(e.originalMethod=C(t),e.newMethod=function(e,t,o){const s=getApi(),n=C(e);n.constPtr.writePointer(n.const);const a=(234881280|n.accessFlags)>>>0;if(n.accessFlagsPtr.writeU32(a),n.signatureHandler.writePointer(NULL),n.adapter.writePointer(NULL),n.i2iEntry.writePointer(NULL),s["Method::clear_code"](n.method),n.dataPtr.writePointer(NULL),n.countersPtr.writePointer(NULL),n.stackmapPtr.writePointer(NULL),s["Method::clear_native_function"](n.method),s["Method::set_native_function"](n.method,t,0),s["Method::restore_unshareable_info"](n.method,o),s.version>=17){const e=Memory.alloc(2*r);e.writePointer(n.method),e.add(r).writePointer(o),s["Method::link_method"](n.method,e,o)}return n}(t,a,n),P(e.newMethod,i,n)):s["Method::set_native_function"](d.method,a,0)})),o.forEach((e=>{const{originalMethod:t,methodId:o,newMethod:s}=e;if(null!==t){!function(e){const{oldMethod:t}=e;t.accessFlagsPtr.writeU32(t.accessFlags),t.vtableIndexPtr.writeS32(t.vtableIndex)}(t);const e=t.oldMethod;e.oldMethod=s,P(e,o,n),a=!0}}))})),a&&function(e){const{fractions:t,shouldSweep:o,traversals:s,"NMethodSweeper::sweep_code_cache":n,"NMethodSweeper::sweep_in_progress":a,"NMethodSweeper::force_sweep":i,JVM_Sleep:r}=getApi();if(void 0!==i)Thread.sleep(.05),i(),Thread.sleep(.05),i();else{let i=s.readS64();const d=i+2;for(;d>i;){t.writeS32(1),r(e,NULL,50),a()||w((()=>{Thread.sleep(.05)}));0===o.readU8()&&(t.writeS32(1),n()),i=s.readS64()}}}(e.handle)}))}function w(e,t,o){const{execute:s,vtable:n,vtableSize:a,doItOffset:i,prologueOffset:d,epilogueOffset:l}=_(),c=Memory.dup(n,a),h=Memory.alloc(25*r);h.writePointer(c);const f=new NativeCallback(e,"void",["pointer"]);c.add(i).writePointer(f);let u=null;void 0!==t&&(u=new NativeCallback(t,"int",["pointer"]),c.add(d).writePointer(u));let p=null;void 0!==o&&(p=new NativeCallback(o,"void",["pointer"]),c.add(l).writePointer(p)),s(h)}export function makeMethodMangler(e){return new m(e)}function P(e,t,o){const{method:s,oldMethod:n}=e,a=getApi();e.methodsArray.add(e.methodIndex*r).writePointer(s),e.vtableIndex>=0&&e.vtable.add(e.vtableIndex*r).writePointer(s),t.writePointer(s),n.accessFlagsPtr.writeU32((196608|n.accessFlags)>>>0);const i=a["OopMapCache::flush_obsolete_entries"];if(void 0!==i){const{oopMapCache:t}=e;t.isNull()||i(t)}const d=a["VM_RedefineClasses::mark_dependent_code"],l=a["VM_RedefineClasses::flush_dependent_code"];void 0!==d?(d(NULL,e.instanceKlass),l()):l(NULL,e.instanceKlass,o);const c=Memory.alloc(1);c.writeU8(1),a["ConstantPoolCache::adjust_method_entries"](e.cache,e.instanceKlass,c);const _=Memory.alloc(3*r),h=Memory.alloc(r);h.writePointer(a.doKlass),_.writePointer(h),_.add(r).writePointer(o),_.add(2*r).writePointer(o),void 0!==a.redefineClass&&a.redefineClass.writePointer(e.instanceKlass),a["ClassLoaderDataGraph::classes_do"](_);const f=a["ResolvedMethodTable::adjust_method_entries"];if(void 0!==f)f(c);else{const{memberNames:t}=e;if(!t.isNull()){const o=a["MemberNameTable::adjust_method_entries"];void 0!==o&&o(t,e.instanceKlass,c)}}const u=a["ClassLoaderDataGraph::clean_deallocate_lists"];void 0!==u&&u(0)}function C(e){const t=l(),o=e.add(t.method.constMethodOffset).readPointer(),s=o.add(t.constMethod.sizeOffset).readS32()*r,n=Memory.alloc(s+t.method.size);Memory.copy(n,o,s);const a=n.add(s);Memory.copy(a,e,t.method.size);const i=b(a,n,s),d=b(e,o,s);return i.oldMethod=d,i}function b(e,t,o){const s=getApi(),n=l(),a=e.add(n.method.constMethodOffset),i=e.add(n.method.methodDataOffset),d=e.add(n.method.methodCountersOffset),_=e.add(n.method.accessFlagsOffset),h=_.readU32(),f=n.getAdapterPointer(e,t),u=e.add(n.method.i2iEntryOffset),p=e.add(n.method.signatureHandlerOffset),v=t.add(n.constMethod.constantPoolOffset).readPointer(),m=t.add(n.constMethod.stackmapDataOffset),M=v.add(n.constantPool.instanceKlassOffset).readPointer(),N=v.add(n.constantPool.cacheOffset).readPointer(),w=c(),P=M.add(w.methodsOffset).readPointer(),C=P.readS32(),b=P.add(r),E=t.add(n.constMethod.methodIdnumOffset).readU16(),Z=e.add(n.method.vtableIndexOffset),g=Z.readS32(),V=M.add(w.vtableOffset),I=M.add(w.oopMapCacheOffset).readPointer(),O=s.version>=10?M.add(w.memberNamesOffset).readPointer():NULL;return{method:e,methodSize:n.method.size,const:t,constSize:o,constPtr:a,dataPtr:i,countersPtr:d,stackmapPtr:m,instanceKlass:M,methodsArray:b,methodsCount:C,methodIndex:E,vtableIndex:g,vtableIndexPtr:Z,vtable:V,accessFlags:h,accessFlagsPtr:_,adapter:f,i2iEntry:u,signatureHandler:p,memberNames:O,cache:N,oopMapCache:I}}const E={x64:function(e){if("mov"!==e.mnemonic)return null;const t=e.operands[0];if("mem"!==t.type)return null;const{value:o}=t;if(1!==o.scale)return null;const{disp:s}=o;if(s<256)return null;return s+16}};export function deoptimizeEverything(e,t){}
âœ„
{"version":3,"file":"jvmti.js","names":["checkJniResult","jvmtiVersion","v1_0","v1_2","jvmtiCapabilities","canTagObjects","pointerSize","Process","nativeFunctionOptions","exceptions","EnvJvmti","handle","vm","this","vtable","readPointer","proxy","offset","retType","argTypes","wrapper","impl","NativeFunction","add","args","concat","apply","arguments","prototype","deallocate","mem","getLoadedClasses","classCountPtr","classesPtr","result","iterateOverInstancesOfClass","klass","objectFilter","heapObjectCallback","userData","getObjectsWithTags","tagCount","tags","countPtr","objectResultPtr","tagResultPtr","addCapabilities","capabilitiesPtr"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"yBAASA,MAAsB,qBAExB,MAAMC,aAAe,CAC1BC,KAAM,UACNC,KAAM,kBAGD,MAAMC,kBAAoB,CAC/BC,cAAe,GAGjB,MAAMC,YAAEA,GAAgBC,QAClBC,EAAwB,CAC5BC,WAAY,oBAGP,SAASC,SAAUC,EAAQC,GAChCC,KAAKF,OAASA,EACdE,KAAKD,GAAKA,EACVC,KAAKC,OAASH,EAAOI,aACvB,CAyBA,SAASC,EAAOC,EAAQC,EAASC,EAAUC,GACzC,IAAIC,EAAO,KACX,OAAO,WACQ,OAATA,IACFA,EAAO,IAAIC,eAAeT,KAAKC,OAAOS,KAAKN,EAAS,GAAKX,GAAaS,cAAeG,EAASC,EAAUX,IAE1G,IAAIgB,EAAO,CAACH,GAEZ,OADAG,EAAOA,EAAKC,OAAOC,MAAMF,EAAMG,WACxBP,EAAQM,MAAMb,KAAMW,EAC7B,CACF,CAjCAd,SAASkB,UAAUC,WAAab,EAAM,GAAI,QAAS,CAAC,UAAW,YAAY,SAAUK,EAAMS,GACzF,OAAOT,EAAKR,KAAKF,OAAQmB,EAC3B,IAEApB,SAASkB,UAAUG,iBAAmBf,EAAM,GAAI,QAAS,CAAC,UAAW,UAAW,YAAY,SAAUK,EAAMW,EAAeC,GACzH,MAAMC,EAASb,EAAKR,KAAKF,OAAQqB,EAAeC,GAChDjC,EAAe,6BAA8BkC,EAC/C,IAEAxB,SAASkB,UAAUO,4BAA8BnB,EAAM,IAAK,QAAS,CAAC,UAAW,UAAW,MAAO,UAAW,YAAY,SAAUK,EAAMe,EAAOC,EAAcC,EAAoBC,GACjL,MAAML,EAASb,EAAKR,KAAKF,OAAQyB,EAAOC,EAAcC,EAAoBC,GAC1EvC,EAAe,wCAAyCkC,EAC1D,IAEAxB,SAASkB,UAAUY,mBAAqBxB,EAAM,IAAK,QAAS,CAAC,UAAW,MAAO,UAAW,UAAW,UAAW,YAAY,SAAUK,EAAMoB,EAAUC,EAAMC,EAAUC,EAAiBC,GACrL,MAAMX,EAASb,EAAKR,KAAKF,OAAQ8B,EAAUC,EAAMC,EAAUC,EAAiBC,GAC5E7C,EAAe,+BAAgCkC,EACjD,IAEAxB,SAASkB,UAAUkB,gBAAkB9B,EAAM,IAAK,QAAS,CAAC,UAAW,YAAY,SAAUK,EAAM0B,GAC/F,OAAO1B,EAAKR,KAAKF,OAAQoC,EAC3B","ignoreList":[]}
âœ„
import{checkJniResult as t}from"./result.js";export const jvmtiVersion={v1_0:805371904,v1_2:805372416};export const jvmtiCapabilities={canTagObjects:1};const{pointerSize:n}=Process,e={exceptions:"propagate"};export function EnvJvmti(t,n){this.handle=t,this.vm=n,this.vtable=t.readPointer()}function i(t,i,o,r){let s=null;return function(){null===s&&(s=new NativeFunction(this.vtable.add((t-1)*n).readPointer(),i,o,e));let p=[s];return p=p.concat.apply(p,arguments),r.apply(this,p)}}EnvJvmti.prototype.deallocate=i(47,"int32",["pointer","pointer"],(function(t,n){return t(this.handle,n)})),EnvJvmti.prototype.getLoadedClasses=i(78,"int32",["pointer","pointer","pointer"],(function(n,e,i){const o=n(this.handle,e,i);t("EnvJvmti::getLoadedClasses",o)})),EnvJvmti.prototype.iterateOverInstancesOfClass=i(112,"int32",["pointer","pointer","int","pointer","pointer"],(function(n,e,i,o,r){const s=n(this.handle,e,i,o,r);t("EnvJvmti::iterateOverInstancesOfClass",s)})),EnvJvmti.prototype.getObjectsWithTags=i(114,"int32",["pointer","int","pointer","pointer","pointer","pointer"],(function(n,e,i,o,r,s){const p=n(this.handle,e,i,o,r,s);t("EnvJvmti::getObjectsWithTags",p)})),EnvJvmti.prototype.addCapabilities=i(142,"int32",["pointer","pointer"],(function(t,n){return t(this.handle,n)}));
âœ„
{"version":3,"file":"lru.js","names":["LRU","constructor","capacity","destroy","this","items","Map","dispose","env","forEach","val","clear","get","key","item","undefined","delete","set","existingVal","size","oldestKey","keys","next","value","oldestVal"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"eAEe,MAAMA,EACnBC,YAAaC,EAAUC,GACrBC,KAAKC,MAAQ,IAAIC,IACjBF,KAAKF,SAAWA,EAChBE,KAAKD,QAAUA,CACjB,CAEAI,QAASC,GACP,MAAMH,MAAEA,EAAKF,QAAEA,GAAYC,KAC3BC,EAAMI,SAAQC,IAASP,EAAQO,EAAKF,EAAI,IACxCH,EAAMM,OACR,CAEAC,IAAKC,GACH,MAAMR,MAAEA,GAAUD,KAEZU,EAAOT,EAAMO,IAAIC,GAMvB,YALaE,IAATD,IACFT,EAAMW,OAAOH,GACbR,EAAMY,IAAIJ,EAAKC,IAGVA,CACT,CAEAG,IAAKJ,EAAKH,EAAKF,GACb,MAAMH,MAAEA,GAAUD,KAEZc,EAAcb,EAAMO,IAAIC,GAC9B,QAAoBE,IAAhBG,EACFb,EAAMW,OAAOH,GACbT,KAAKD,QAAQe,EAAaV,QACrB,GAAIH,EAAMc,OAASf,KAAKF,SAAU,CACvC,MAAMkB,EAAYf,EAAMgB,OAAOC,OAAOC,MAChCC,EAAYnB,EAAMO,IAAIQ,GAC5Bf,EAAMW,OAAOI,GACbhB,KAAKD,QAAQqB,EAAWhB,EAC1B,CAEAH,EAAMY,IAAIJ,EAAKH,EACjB","ignoreList":[]}
âœ„
export default class t{constructor(t,e){this.items=new Map,this.capacity=t,this.destroy=e}dispose(t){const{items:e,destroy:s}=this;e.forEach((e=>{s(e,t)})),e.clear()}get(t){const{items:e}=this,s=e.get(t);return void 0!==s&&(e.delete(t),e.set(t,s)),s}set(t,e,s){const{items:i}=this,o=i.get(t);if(void 0!==o)i.delete(t),this.destroy(o,s);else if(i.size===this.capacity){const t=i.keys().next().value,e=i.get(t);i.delete(t),this.destroy(e,s)}i.set(t,e)}}
âœ„
{"version":3,"file":"machine-code.js","names":["parseInstructionsAt","address","tryParse","limit","cursor","prevInsn","i","insn","Instruction","parse","value","next"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"OAAO,SAASA,oBAAqBC,EAASC,GAAUC,MAAEA,IACxD,IAAIC,EAASH,EACTI,EAAW,KAEf,IAAK,IAAIC,EAAI,EAAGA,IAAMH,EAAOG,IAAK,CAChC,MAAMC,EAAOC,YAAYC,MAAML,GAEzBM,EAAQR,EAASK,EAAMF,GAC7B,GAAc,OAAVK,EACF,OAAOA,EAGTN,EAASG,EAAKI,KACdN,EAAWE,CACb,CAEA,OAAO,IACT","ignoreList":[]}
âœ„
export function parseInstructionsAt(t,n,{limit:r}){let l=t,e=null;for(let t=0;t!==r;t++){const t=Instruction.parse(l),r=n(t,e);if(null!==r)return r;l=t.next,e=t}return null}
âœ„
{"version":3,"file":"memoize.js","names":["memoize","compute","value","computed","args"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"eAAe,SAASA,EAASC,GAC/B,IAAIC,EAAQ,KACRC,GAAW,EAEf,OAAO,YAAaC,GAMlB,OALKD,IACHD,EAAQD,KAAWG,GACnBD,GAAW,GAGND,CACT,CACF","ignoreList":[]}
âœ„
export default function n(n){let t=null,u=!1;return function(...e){return u||(t=n(...e),u=!0),t}}
âœ„
{"version":3,"file":"mkdex.js","names":["Buffer","VISIBILITY_SYSTEM","kDefaultConstructorDebugInfo","from","kNullTerminator","mkdex","spec","builder","DexBuilder","fullSpec","Object","assign","addClass","build","constructor","this","classes","push","model","strings","Set","types","protos","fields","methods","throwsAnnotations","javaConstructors","superConstructors","addProto","retType","argTypes","signature","concat","id","join","undefined","add","forEach","argType","shorty","map","typeToShorty","klass","name","superClass","sourceFileName","interfaces","iface","field","fieldName","fieldType","some","methodName","unshift","method","thrownTypes","accessFlags","protoId","throwsAnnotationId","length","typesNormalized","slice","sort","throwsAnnotation","type","superConstructorId","has","stringItems","Array","stringToIndex","reduce","result","string","index","typeItems","compareNumbers","typeToIndex","stringIndex","typeIndex","literalProtoItems","keys","compareProtoItems","parameters","protoItems","item","params","argTypesSig","offset","protoToIndex","parameterItems","fieldItems","compareFieldItems","methodItems","annotationsId","compareMethodItems","throwsAnnotationItems","value","annotationSetItems","items","annotationSetIdToIndex","interfaceLists","annotationDirectories","classItems","classIndex","superClassIndex","ifaceList","ifaces","ifacesId","sourceFileIndex","classMethods","holder","protoIndex","annotationsDirectory","methodAnnotations","filter","instanceFields","constructorNameIndex","constructorMethods","superConstructor","numMethodItems","i","methodClass","methodProto","kAccPublic","virtualMethods","previousIndex","elementIndex","compressClassMethodIndexes","classData","interfaceItems","annotationSets","computeModel","stringIdsOffset","stringIdsSize","typeIdsOffset","typeIdsSize","protoIdsOffset","protoIdsSize","fieldIdsOffset","fieldIdsSize","methodIdsOffset","methodIdsSize","classDefsOffset","classDefsSize","dataOffset","annotationSetOffsets","set","setOffset","javaCodeItems","dir","interfaceOffsets","align","ifaceOffset","parameterOffsets","param","paramOffset","stringChunks","stringOffsets","str","strOffset","header","createUleb128","data","chunk","debugInfoOffsets","codeItem","debugOffset","throwsAnnotationBlobs","annotation","blob","makeThrowsAnnotation","classDataBlobs","staticFieldsSize","indexDiff","codeOffset","makeClassData","mapOffset","typeListLength","mapNumItems","dataSize","fileSize","dex","alloc","write","writeUInt32LE","proto","shortyIndex","returnTypeIndex","protoOffset","nameIndex","fieldOffset","writeUInt16LE","methodOffset","interfacesOffset","annotationsOffset","classOffset","dirOffset","annotatedMethodsSize","entryOffset","methodIndex","annotationSet","copy","debugInfoOffset","annotationBlob","classDataBlob","mapItems","size","itemOffset","hash","Checksum","update","signatureOffset","getDigest","buffer","a","b","adler32","aRetType","aArgTypes","bRetType","bArgTypes","aArgTypesSig","bArgTypesSig","aClass","aType","aName","bClass","bType","bName","aProto","bProto","firstCharacter","moreSlicesNeeded","alignment","alignmentDelta"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"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","ignoreList":[]}
âœ„
import{Buffer as t}from"buffer";const n=2,e=t.from([3,0,7,14,0]),s=t.from([0]);function o(t){const n=new r,e=Object.assign({},t);return n.addClass(e),n.build()}class r{constructor(){this.classes=[]}addClass(t){this.classes.push(t)}build(){const o=function(t){const n=new Set,e=new Set,s={},o=[],r=[],l={},u=new Set,d=new Set;function E(t,o){const r=[t].concat(o),c=r.join("|");if(void 0!==s[c])return c;n.add(t),e.add(t),o.forEach((t=>{n.add(t),e.add(t)}));const a=r.map(f).join("");return n.add(a),s[c]=[c,a,t,o],c}t.forEach((t=>{const{name:s,superClass:c,sourceFileName:a}=t;n.add("this"),n.add(s),e.add(s),n.add(c),e.add(c),n.add(a),t.interfaces.forEach((t=>{n.add(t),e.add(t)})),t.fields.forEach((s=>{const[r,c]=s;n.add(r),n.add(c),e.add(c),o.push([t.name,c,r])})),t.methods.some((([t])=>"<init>"===t))||(t.methods.unshift(["<init>","V",[]]),u.add(s)),t.methods.forEach((o=>{const[a,i,h,f=[],p]=o;n.add(a);const w=E(i,h);let L=null;if(f.length>0){const t=f.slice();t.sort(),L=t.join("|");let s=l[L];void 0===s&&(s={id:L,types:t},l[L]=s),n.add("Ldalvik/annotation/Throws;"),e.add("Ldalvik/annotation/Throws;"),f.forEach((t=>{n.add(t),e.add(t)})),n.add("value")}if(r.push([t.name,w,a,L,p]),"<init>"===a){d.add(s+"|"+w);const t=c+"|"+w;u.has(s)&&!d.has(t)&&(r.push([c,w,a,null,0]),d.add(t))}}))}));const p=Array.from(n);p.sort();const w=p.reduce(((t,n,e)=>(t[n]=e,t)),{}),L=Array.from(e).map((t=>w[t]));L.sort(c);const I=L.reduce(((t,n,e)=>(t[p[n]]=e,t)),{}),U=Object.keys(s).map((t=>s[t]));U.sort(a);const g={},m=U.map((t=>{const[,n,e,s]=t;let o;if(s.length>0){const t=s.join("|");o=g[t],void 0===o&&(o={types:s.map((t=>I[t])),offset:-1},g[t]=o)}else o=null;return[w[n],I[e],o]})),y=U.reduce(((t,n,e)=>{const[s]=n;return t[s]=e,t}),{}),v=Object.keys(g).map((t=>g[t])),j=o.map((t=>{const[n,e,s]=t;return[I[n],I[e],w[s]]}));j.sort(i);const D=r.map((t=>{const[n,e,s,o,r]=t;return[I[n],y[e],w[s],o,r]}));D.sort(h);const b=Object.keys(l).map((t=>l[t])).map((t=>({id:t.id,type:I["Ldalvik/annotation/Throws;"],value:w.value,thrownTypes:t.types.map((t=>I[t])),offset:-1}))),k=b.map((t=>({id:t.id,items:[t],offset:-1}))),C=k.reduce(((t,n,e)=>(t[n.id]=e,t)),{}),x={},F=[],S=t.map((t=>{const n=I[t.name],e=1,s=I[t.superClass];let o;const r=t.interfaces.map((t=>I[t]));if(r.length>0){r.sort(c);const t=r.join("|");o=x[t],void 0===o&&(o={types:r,offset:-1},x[t]=o)}else o=null;const a=w[t.sourceFileName],i=D.reduce(((t,e,s)=>{const[o,r,c,a,i]=e;return o===n&&t.push([s,c,a,r,i]),t}),[]);let h=null;const f=i.filter((([,,t])=>null!==t)).map((([t,,n])=>[t,k[C[n]]]));f.length>0&&(h={methods:f,offset:-1},F.push(h));const l=j.reduce(((t,e,s)=>{const[o]=e;return o===n&&t.push([s>0?1:0,1]),t}),[]),d=w["<init>"],E=i.filter((([,t])=>t===d)).map((([n,,,e])=>{if(u.has(t.name)){let t=-1;const o=D.length;for(let n=0;n!==o;n++){const[o,r,c]=D[n];if(o===s&&c===d&&r===e){t=n;break}}return[n,65537,t]}return[n,65793,-1]})),p=function(t){let n=0;return t.map((([t,e],s)=>{let o;return o=0===s?[t,e]:[t-n,e],n=t,o}))}(i.filter((([,t])=>t!==d)).map((([t,,,,n])=>[t,257|n])));return{index:n,accessFlags:e,superClassIndex:s,interfaces:o,sourceFileIndex:a,annotationsDirectory:h,classData:{instanceFields:l,constructorMethods:E,virtualMethods:p,offset:-1}}})),M=Object.keys(x).map((t=>x[t]));return{classes:S,interfaces:M,fields:j,methods:D,protos:m,parameters:v,annotationDirectories:F,annotationSets:k,throwsAnnotations:b,types:L,strings:p}}(this.classes),{classes:r,interfaces:d,fields:E,methods:p,protos:w,parameters:L,annotationDirectories:I,annotationSets:U,throwsAnnotations:g,types:m,strings:y}=o;let v=0;v+=112;const j=v,D=4*y.length;v+=D;const b=v,k=4*m.length;v+=k;const C=v,x=12*w.length;v+=x;const F=v,S=8*E.length;v+=S;const M=v,O=8*p.length;v+=O;const T=v,A=32*r.length;v+=A;const N=v,V=U.map((t=>{const n=v;return t.offset=n,v+=4+4*t.items.length,n})),q=r.reduce(((t,n)=>(n.classData.constructorMethods.forEach((n=>{const[,e,s]=n;0==(256&e)&&s>=0&&(n.push(v),t.push({offset:v,superConstructor:s}),v+=24)})),t)),[]);I.forEach((t=>{t.offset=v,v+=16+8*t.methods.length}));const z=d.map((t=>{v=u(v,4);const n=v;return t.offset=n,v+=4+2*t.types.length,n})),B=L.map((t=>{v=u(v,4);const n=v;return t.offset=n,v+=4+2*t.types.length,n})),G=[],H=y.map((n=>{const e=v,o=t.from(l(n.length)),r=t.from(n,"utf8"),c=t.concat([o,r,s]);return G.push(c),v+=c.length,e})),J=q.map((t=>{const n=v;return v+=e.length,n})),K=g.map((e=>{const s=function(e){const{thrownTypes:s}=e;return t.from([n].concat(l(e.type)).concat([1]).concat(l(e.value)).concat([28,s.length]).concat(s.reduce(((t,n)=>(t.push(24,n),t)),[])))}(e);return e.offset=v,v+=s.length,s})),P=r.map(((n,e)=>{n.classData.offset=v;const s=function(n){const{instanceFields:e,constructorMethods:s,virtualMethods:o}=n.classData,r=0;return t.from([r].concat(l(e.length)).concat(l(s.length)).concat(l(o.length)).concat(e.reduce(((t,[n,e])=>t.concat(l(n)).concat(l(e))),[])).concat(s.reduce(((t,[n,e,,s])=>t.concat(l(n)).concat(l(e)).concat(l(s||0))),[])).concat(o.reduce(((t,[n,e])=>{const s=0;return t.concat(l(n)).concat(l(e)).concat([s])}),[])))}(n);return v+=s.length,s}));v=u(v,4);const Q=v,R=d.length+L.length,W=4+(E.length>0?1:0)+2+U.length+q.length+I.length+(R>0?1:0)+1+J.length+g.length+r.length+1;v+=4+12*W;const X=v-N,Y=v,Z=t.alloc(Y);Z.write("dex\n035"),Z.writeUInt32LE(Y,32),Z.writeUInt32LE(112,36),Z.writeUInt32LE(305419896,40),Z.writeUInt32LE(0,44),Z.writeUInt32LE(0,48),Z.writeUInt32LE(Q,52),Z.writeUInt32LE(y.length,56),Z.writeUInt32LE(j,60),Z.writeUInt32LE(m.length,64),Z.writeUInt32LE(b,68),Z.writeUInt32LE(w.length,72),Z.writeUInt32LE(C,76),Z.writeUInt32LE(E.length,80),Z.writeUInt32LE(E.length>0?F:0,84),Z.writeUInt32LE(p.length,88),Z.writeUInt32LE(M,92),Z.writeUInt32LE(r.length,96),Z.writeUInt32LE(T,100),Z.writeUInt32LE(X,104),Z.writeUInt32LE(N,108),H.forEach(((t,n)=>{Z.writeUInt32LE(t,j+4*n)})),m.forEach(((t,n)=>{Z.writeUInt32LE(t,b+4*n)})),w.forEach(((t,n)=>{const[e,s,o]=t,r=C+12*n;Z.writeUInt32LE(e,r),Z.writeUInt32LE(s,r+4),Z.writeUInt32LE(null!==o?o.offset:0,r+8)})),E.forEach(((t,n)=>{const[e,s,o]=t,r=F+8*n;Z.writeUInt16LE(e,r),Z.writeUInt16LE(s,r+2),Z.writeUInt32LE(o,r+4)})),p.forEach(((t,n)=>{const[e,s,o]=t,r=M+8*n;Z.writeUInt16LE(e,r),Z.writeUInt16LE(s,r+2),Z.writeUInt32LE(o,r+4)})),r.forEach(((t,n)=>{const{interfaces:e,annotationsDirectory:s}=t,o=null!==e?e.offset:0,r=null!==s?s.offset:0,c=T+32*n;Z.writeUInt32LE(t.index,c),Z.writeUInt32LE(t.accessFlags,c+4),Z.writeUInt32LE(t.superClassIndex,c+8),Z.writeUInt32LE(o,c+12),Z.writeUInt32LE(t.sourceFileIndex,c+16),Z.writeUInt32LE(r,c+20),Z.writeUInt32LE(t.classData.offset,c+24),Z.writeUInt32LE(0,c+28)})),U.forEach(((t,n)=>{const{items:e}=t,s=V[n];Z.writeUInt32LE(e.length,s),e.forEach(((t,n)=>{Z.writeUInt32LE(t.offset,s+4+4*n)}))})),q.forEach(((t,n)=>{const{offset:e,superConstructor:s}=t;Z.writeUInt16LE(1,e),Z.writeUInt16LE(1,e+2),Z.writeUInt16LE(1,e+4),Z.writeUInt16LE(0,e+6),Z.writeUInt32LE(J[n],e+8),Z.writeUInt32LE(4,e+12),Z.writeUInt16LE(4208,e+16),Z.writeUInt16LE(s,e+18),Z.writeUInt16LE(0,e+20),Z.writeUInt16LE(14,e+22)})),I.forEach((t=>{const n=t.offset,e=t.methods.length;Z.writeUInt32LE(0,n),Z.writeUInt32LE(0,n+4),Z.writeUInt32LE(e,n+8),Z.writeUInt32LE(0,n+12),t.methods.forEach(((t,e)=>{const s=n+16+8*e,[o,r]=t;Z.writeUInt32LE(o,s),Z.writeUInt32LE(r.offset,s+4)}))})),d.forEach(((t,n)=>{const e=z[n];Z.writeUInt32LE(t.types.length,e),t.types.forEach(((t,n)=>{Z.writeUInt16LE(t,e+4+2*n)}))})),L.forEach(((t,n)=>{const e=B[n];Z.writeUInt32LE(t.types.length,e),t.types.forEach(((t,n)=>{Z.writeUInt16LE(t,e+4+2*n)}))})),G.forEach(((t,n)=>{t.copy(Z,H[n])})),J.forEach((t=>{e.copy(Z,t)})),K.forEach(((t,n)=>{t.copy(Z,g[n].offset)})),P.forEach(((t,n)=>{t.copy(Z,r[n].classData.offset)})),Z.writeUInt32LE(W,Q);const $=[[0,1,0],[1,y.length,j],[2,m.length,b],[3,w.length,C]];E.length>0&&$.push([4,E.length,F]),$.push([5,p.length,M]),$.push([6,r.length,T]),U.forEach(((t,n)=>{$.push([4099,t.items.length,V[n]])})),q.forEach((t=>{$.push([8193,1,t.offset])})),I.forEach((t=>{$.push([8198,1,t.offset])})),R>0&&$.push([4097,R,z.concat(B)[0]]),$.push([8194,y.length,H[0]]),J.forEach((t=>{$.push([8195,1,t])})),g.forEach((t=>{$.push([8196,1,t.offset])})),r.forEach((t=>{$.push([8192,1,t.classData.offset])})),$.push([4096,1,Q]),$.forEach(((t,n)=>{const[e,s,o]=t,r=Q+4+12*n;Z.writeUInt16LE(e,r),Z.writeUInt32LE(s,r+4),Z.writeUInt32LE(o,r+8)}));const _=new Checksum("sha1");return _.update(Z.slice(32)),t.from(_.getDigest()).copy(Z,12),Z.writeUInt32LE(function(t,n){let e=1,s=0;const o=t.length;for(let r=n;r<o;r++)e=(e+t[r])%65521,s=(s+e)%65521;return(s<<16|e)>>>0}(Z,12),8),Z}}function c(t,n){return t-n}function a(t,n){const[,,e,s]=t,[,,o,r]=n;if(e<o)return-1;if(e>o)return 1;const c=s.join("|"),a=r.join("|");return c<a?-1:c>a?1:0}function i(t,n){const[e,s,o]=t,[r,c,a]=n;return e!==r?e-r:o!==a?o-a:s-c}function h(t,n){const[e,s,o]=t,[r,c,a]=n;return e!==r?e-r:o!==a?o-a:s-c}function f(t){const n=t[0];return"L"===n||"["===n?"L":t}function l(t){if(t<=127)return[t];const n=[];let e=!1;do{let s=127&t;e=0!==(t>>=7),e&&(s|=128),n.push(s)}while(e);return n}function u(t,n){const e=t%n;return 0===e?t:t+n-e}export default o;
âœ„
{"version":3,"file":"result.js","names":["JNI_OK","checkJniResult","name","result","Error"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"OAAO,MAAMA,OAAS,SAEf,SAASC,eAAgBC,EAAMC,GACpC,GAHoB,IAGhBA,EACF,MAAM,IAAIC,MAAMF,EAAO,YAAcC,EAEzC","ignoreList":[]}
âœ„
export const JNI_OK=0;export function checkJniResult(e,o){if(0!==o)throw new Error(e+" failed: "+o)}
âœ„
{"version":3,"file":"types.js","names":["Env","vm","primitiveArrayHandler","initialize","_vm","getType","typeName","unbox","factory","type","getPrimitiveType","indexOf","getArrayType","length","substring","cache","_types","undefined","name","size","defaultValue","NULL","isCompatible","v","$h","NativePointer","fromJni","h","env","owned","isNull","cast","use","toJni","o","newStringUtf","getJavaLangObjectType","cachedClass","cachedIsInstance","cachedIsDefaultString","getClass","class","isInstance","klass","overload","call","typeIsDefaultString","x","isAssignableFrom","makeJniObjectTypeName","stringFromJni","toString","this","getAnyObjectType","getObjectType","Object","assign","className","primitiveTypes","boolean","byteSize","read","address","readU8","write","value","writeU8","byte","Number","isInteger","identity","readS8","writeS8","char","code","charCodeAt","c","String","fromCharCode","s","readU16","writeU16","short","readS16","writeS16","int","readS32","writeS32","long","Int64","readS64","writeS64","float","readFloat","writeFloat","double","readDouble","writeDouble","void","primitiveTypesNames","Set","values","map","t","result","primitiveArrayTypes","reduce","shorty","envProto","prototype","nameTitled","str","charAt","toUpperCase","slice","spec","newArray","setRegion","getElements","releaseElements","PrimitiveArray","$s","elementType","Array","every","element","isCompatiblePrimitiveArray","arr","getArrayLength","fromJniPrimitiveArray","handle","Error","elementSize","writeElement","unparseElementValue","elements","Memory","alloc","index","add","throwIfExceptionPending","toJniPrimitiveArray","makePrimitiveArrayType","primitiveType","elementTypeName","numInternalArrays","end","internalElementTypeName","replace","has","repeat","internalTypeName","n","i","getObjectArrayElement","push","deleteLocalRef","$w","e","newInstance","$dispose","disposeObjectArray","wrapper","classHandle","$borrowClassHandle","newObjectArray","setObjectArrayElement","getObjectRefType","unref","obj","dispose","newGlobalRef","$r","Script","bindWeak","makeHandleDestructor","$t","Proxy","target","property","tryParseIndex","get","receiver","readElement","set","ownKeys","keys","key","getOwnPropertyDescriptor","writable","configurable","enumerable","defineProperties","ref","unbindWeak","$clone","rawIndex","parseInt","isNaN","withElements","getEnv","perform","toJSON"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"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","ignoreList":[]}
âœ„
import e from"./env.js";let t=null,n=null;export function initialize(e){t=e}export function getType(e,t,n){let r=getPrimitiveType(e);return null===r&&(0===e.indexOf("[")?r=getArrayType(e,t,n):("L"===e[0]&&";"===e[e.length-1]&&(e=e.substring(1,e.length-1)),r=function(e,t,n){const r=n._types[t?1:0];let i=r[e];if(void 0!==i)return i;i="java.lang.Object"===e?function(e){return{name:"Ljava/lang/Object;",type:"pointer",size:1,defaultValue:NULL,isCompatible(e){if(null===e)return!0;if(void 0===e)return!1;return!!(e.$h instanceof NativePointer)||"string"==typeof e},fromJni:(t,n,r)=>t.isNull()?null:e.cast(t,e.use("java.lang.Object"),r),toJni:(e,t)=>null===e?NULL:"string"==typeof e?t.newStringUtf(e):e.$h}}(n):function(e,t,n){let r=null,i=null,o=null;function l(){return null===r&&(r=n.use(e).class),r}function a(e){const t=l();return null===i&&(i=t.isInstance.overload("java.lang.Object")),i.call(t,e)}function s(){if(null===o){const e=l();o=n.use("java.lang.String").class.isAssignableFrom(e)}return o}return{name:makeJniObjectTypeName(e),type:"pointer",size:1,defaultValue:NULL,isCompatible(e){if(null===e)return!0;if(void 0===e)return!1;return e.$h instanceof NativePointer?a(e):"string"==typeof e&&s()},fromJni:(r,i,o)=>r.isNull()?null:s()&&t?i.stringFromJni(r):n.cast(r,n.use(e),o),toJni:(e,t)=>null===e?NULL:"string"==typeof e?t.newStringUtf(e):e.$h,toString(){return this.name}}}(e,t,n);return r[e]=i,i}(e,t,n))),Object.assign({className:e},r)}const r={boolean:{name:"Z",type:"uint8",size:1,byteSize:1,defaultValue:!1,isCompatible:e=>"boolean"==typeof e,fromJni:e=>!!e,toJni:e=>e?1:0,read:e=>e.readU8(),write(e,t){e.writeU8(t)},toString(){return this.name}},byte:{name:"B",type:"int8",size:1,byteSize:1,defaultValue:0,isCompatible:e=>Number.isInteger(e)&&e>=-128&&e<=127,fromJni:s,toJni:s,read:e=>e.readS8(),write(e,t){e.writeS8(t)},toString(){return this.name}},char:{name:"C",type:"uint16",size:1,byteSize:2,defaultValue:0,isCompatible(e){if("string"!=typeof e||1!==e.length)return!1;const t=e.charCodeAt(0);return t>=0&&t<=65535},fromJni:e=>String.fromCharCode(e),toJni:e=>e.charCodeAt(0),read:e=>e.readU16(),write(e,t){e.writeU16(t)},toString(){return this.name}},short:{name:"S",type:"int16",size:1,byteSize:2,defaultValue:0,isCompatible:e=>Number.isInteger(e)&&e>=-32768&&e<=32767,fromJni:s,toJni:s,read:e=>e.readS16(),write(e,t){e.writeS16(t)},toString(){return this.name}},int:{name:"I",type:"int32",size:1,byteSize:4,defaultValue:0,isCompatible:e=>Number.isInteger(e)&&e>=-2147483648&&e<=2147483647,fromJni:s,toJni:s,read:e=>e.readS32(),write(e,t){e.writeS32(t)},toString(){return this.name}},long:{name:"J",type:"int64",size:2,byteSize:8,defaultValue:0,isCompatible:e=>"number"==typeof e||e instanceof Int64,fromJni:s,toJni:s,read:e=>e.readS64(),write(e,t){e.writeS64(t)},toString(){return this.name}},float:{name:"F",type:"float",size:1,byteSize:4,defaultValue:0,isCompatible:e=>"number"==typeof e,fromJni:s,toJni:s,read:e=>e.readFloat(),write(e,t){e.writeFloat(t)},toString(){return this.name}},double:{name:"D",type:"double",size:2,byteSize:8,defaultValue:0,isCompatible:e=>"number"==typeof e,fromJni:s,toJni:s,read:e=>e.readDouble(),write(e,t){e.writeDouble(t)},toString(){return this.name}},void:{name:"V",type:"void",size:0,byteSize:0,defaultValue:void 0,isCompatible:e=>void 0===e,fromJni(){},toJni:()=>NULL,toString(){return this.name}}},i=new Set(Object.values(r).map((e=>e.name)));export function getPrimitiveType(e){const t=r[e];return void 0!==t?t:null}const o=[["Z","boolean"],["B","byte"],["C","char"],["D","double"],["F","float"],["I","int"],["J","long"],["S","short"]].reduce(((t,[n,r])=>(t["["+n]=function(t,n){const r=e.prototype,i=(l=n,l.charAt(0).toUpperCase()+l.slice(1)),o={typeName:n,newArray:r["new"+i+"Array"],setRegion:r["set"+i+"ArrayRegion"],getElements:r["get"+i+"ArrayElements"],releaseElements:r["release"+i+"ArrayElements"]};var l;return{name:t,type:"pointer",size:1,defaultValue:NULL,isCompatible:e=>function(e,t){if(null===e)return!0;if(e instanceof a)return e.$s.typeName===t;if("object"!=typeof e||void 0===e.length)return!1;const n=getPrimitiveType(t);return Array.prototype.every.call(e,(e=>n.isCompatible(e)))}(e,n),fromJni:(e,t,n)=>function(e,t,n,r){if(e.isNull())return null;const i=getPrimitiveType(t.typeName),o=n.getArrayLength(e);return new a(e,t,i,o,n,r)}(e,o,t,n),toJni:(e,t)=>function(e,t,n){if(null===e)return NULL;const r=e.$h;if(void 0!==r)return r;const i=e.length,o=getPrimitiveType(t.typeName),l=t.newArray.call(n,i);if(l.isNull())throw new Error("Unable to construct array");if(i>0){const r=o.byteSize,a=o.write,s=o.toJni,u=Memory.alloc(i*o.byteSize);for(let t=0;t!==i;t++)a(u.add(t*r),s(e[t]));t.setRegion.call(n,l,0,i,u),n.throwIfExceptionPending()}return l}(e,o,t)}}("["+n,r),t)),{});export function getArrayType(e,t,n){const r=o[e];if(void 0!==r)return r;if(0!==e.indexOf("["))throw new Error("Unsupported type: "+e);let a=e.substring(1);const s=getType(a,t,n);let u=0;const c=a.length;for(;u!==c&&"["===a[u];)u++;a=a.substring(u),"L"===a[0]&&";"===a[a.length-1]&&(a=a.substring(1,a.length-1));let f=a.replace(/\./g,"/");f=i.has(f)?"[".repeat(u)+f:"[".repeat(u)+"L"+f+";";const p="["+f;return a="[".repeat(u)+a,{name:e.replace(/\./g,"/"),type:"pointer",size:1,defaultValue:NULL,isCompatible:e=>null===e||"object"==typeof e&&void 0!==e.length&&e.every((function(e){return s.isCompatible(e)})),fromJni(e,t,r){if(e.isNull())return null;const i=[],o=t.getArrayLength(e);for(let n=0;n!==o;n++){const r=t.getObjectArrayElement(e,n);try{i.push(s.fromJni(r,t))}finally{t.deleteLocalRef(r)}}try{i.$w=n.cast(e,n.use(p),r)}catch(t){n.use("java.lang.reflect.Array").newInstance(n.use(a).class,0),i.$w=n.cast(e,n.use(p),r)}return i.$dispose=l,i},toJni(e,t){if(null===e)return NULL;if(!(e instanceof Array))throw new Error("Expected an array");const r=e.$w;if(void 0!==r)return r.$h;const i=e.length,o=n.use(a).$borrowClassHandle(t);try{const n=t.newObjectArray(i,o.value,NULL);t.throwIfExceptionPending();for(let r=0;r!==i;r++){const i=s.toJni(e[r],t);try{t.setObjectArrayElement(n,r,i)}finally{"pointer"===s.type&&1===t.getObjectRefType(i)&&t.deleteLocalRef(i)}t.throwIfExceptionPending()}return n}finally{o.unref(t)}}}}function l(){const e=this.length;for(let t=0;t!==e;t++){const e=this[t];if(null===e)continue;const n=e.$dispose;if(void 0===n)break;n.call(e)}this.$w.$dispose()}function a(e,t,r,i,o,l=!0){if(l){const t=o.newGlobalRef(e);this.$h=t,this.$r=Script.bindWeak(this,o.vm.makeHandleDestructor(t))}else this.$h=e,this.$r=null;return this.$s=t,this.$t=r,this.length=i,new Proxy(this,n)}n={has:(e,t)=>t in e||null!==e.tryParseIndex(t),get(e,t,n){const r=e.tryParseIndex(t);return null===r?e[t]:e.readElement(r)},set(e,t,n,r){const i=e.tryParseIndex(t);return null===i?(e[t]=n,!0):(e.writeElement(i,n),!0)},ownKeys(e){const t=[],{length:n}=e;for(let e=0;e!==n;e++){const n=e.toString();t.push(n)}return t.push("length"),t},getOwnPropertyDescriptor:(e,t)=>null!==e.tryParseIndex(t)?{writable:!0,configurable:!0,enumerable:!0}:Object.getOwnPropertyDescriptor(e,t)},Object.defineProperties(a.prototype,{$dispose:{enumerable:!0,value(){const e=this.$r;null!==e&&(this.$r=null,Script.unbindWeak(e))}},$clone:{value(e){return new a(this.$h,this.$s,this.$t,this.length,e)}},tryParseIndex:{value(e){if("symbol"==typeof e)return null;const t=parseInt(e);return isNaN(t)||t<0||t>=this.length?null:t}},readElement:{value(e){return this.withElements((t=>{const n=this.$t;return n.fromJni(n.read(t.add(e*n.byteSize)))}))}},writeElement:{value(e,n){const{$h:r,$s:i,$t:o}=this,l=t.getEnv(),a=Memory.alloc(o.byteSize);o.write(a,o.toJni(n)),i.setRegion.call(l,r,e,1,a)}},withElements:{value(e){const{$h:n,$s:r}=this,i=t.getEnv(),o=r.getElements.call(i,n);if(o.isNull())throw new Error("Unable to get array elements");try{return e(o)}finally{r.releaseElements.call(i,n,o)}}},toJSON:{value(){const{length:e,$t:t}=this,{byteSize:n,fromJni:r,read:i}=t;return this.withElements((t=>{const o=[];for(let l=0;l!==e;l++){const e=r(i(t.add(l*n)));o.push(e)}return o}))}},toString:{value(){return this.toJSON().toString()}}});export function makeJniObjectTypeName(e){return"L"+e.replace(/\./g,"/")+";"}function s(e){return e}
âœ„
{"version":3,"file":"vm.js","names":["Env","JNI_OK","checkJniResult","pointerSize","Process","jsThreadID","getCurrentThreadId","attachedThreads","Map","activeEnvs","VM","api","handle","vm","attachCurrentThread","detachCurrentThread","getEnv","tryGetCachedEnv","threadId","entry","get","undefined","this","perform","fn","cachedEnv","env","_tryGetEnv","alreadyAttached","set","link","isJsThread","unlink","allowedToDetach","delete","envBuf","Memory","alloc","NULL","readPointer","preventDetachDueToClassLoader","has","result","Error","tryGetEnv","h","tryGetEnvHandle","version","makeHandleDestructor","deleteGlobalRef","tid","vtable","options","exceptions","NativeFunction","add","call","dispose"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/node_modules/frida-java-bridge/lib/","sources":[""],"mappings":"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","ignoreList":[]}
âœ„
import t from"./env.js";import{JNI_OK as e,checkJniResult as n}from"./result.js";const r=Process.pointerSize,o=Process.getCurrentThreadId(),i=new Map,s=new Map;export default function a(a){const c=a.vm;let u=null,l=null,h=null;function d(t){const e=s.get(t);return void 0===e?null:e[0]}this.handle=c,this.perform=function(t){const e=Process.getCurrentThreadId(),n=d(e);if(null!==n)return t(n);let r=this._tryGetEnv();const s=null!==r;s||(r=this.attachCurrentThread(),i.set(e,!0)),this.link(e,r);try{return t(r)}finally{const t=e===o;if(t||this.unlink(e),!s&&!t){const t=i.get(e);i.delete(e),t&&this.detachCurrentThread()}}},this.attachCurrentThread=function(){const e=Memory.alloc(r);return n("VM::AttachCurrentThread",u(c,e,NULL)),new t(e.readPointer(),this)},this.detachCurrentThread=function(){n("VM::DetachCurrentThread",l(c))},this.preventDetachDueToClassLoader=function(){const t=Process.getCurrentThreadId();i.has(t)&&i.set(t,!1)},this.getEnv=function(){const e=d(Process.getCurrentThreadId());if(null!==e)return e;const o=Memory.alloc(r),i=h(c,o,65542);if(-2===i)throw new Error("Current thread is not attached to the Java VM; please move this code inside a Java.perform() callback");return n("VM::GetEnv",i),new t(o.readPointer(),this)},this.tryGetEnv=function(){const t=d(Process.getCurrentThreadId());return null!==t?t:this._tryGetEnv()},this._tryGetEnv=function(){const e=this.tryGetEnvHandle(65542);return null===e?null:new t(e,this)},this.tryGetEnvHandle=function(t){const n=Memory.alloc(r);return h(c,n,t)!==e?null:n.readPointer()},this.makeHandleDestructor=function(t){return()=>{this.perform((e=>{e.deleteGlobalRef(t)}))}},this.link=function(t,e){const n=s.get(t);void 0===n?s.set(t,[e,1]):n[1]++},this.unlink=function(t){const e=s.get(t);1===e[1]?s.delete(t):e[1]--},function(){const t=c.readPointer(),e={exceptions:"propagate"};u=new NativeFunction(t.add(4*r).readPointer(),"int32",["pointer","pointer","pointer"],e),l=new NativeFunction(t.add(5*r).readPointer(),"int32",["pointer"],e),h=new NativeFunction(t.add(6*r).readPointer(),"int32",["pointer","pointer","int32"],e)}.call(this)}a.dispose=function(t){!0===i.get(o)&&(i.delete(o),t.detachCurrentThread())};
âœ„
{"version":3,"file":"constants.js","names":["DEX_MAGIC","CDEX_MAGIC","CDEX_MAGIC_BYTES","DEX_MAGIC_BYTES","DEX_HEADER_SIZE","DEX_ENDIAN_CONSTANT","DEX_REVERSE_ENDIAN","DEX_FILE_SIZE_OFFSET","DEX_HEADER_SIZE_OFFSET","DEX_ENDIAN_TAG_OFFSET","MAX_DEX_SIZE","MIN_DEX_SIZE","CHUNK_SIZE","SCAN_BATCH_SIZE","SCAN_DELAY_MS","OFFSET_SEARCH_MAX","OFFSET_SEARCH_STEP","STRATEGY_NAMES","ART_WALK","OPEN_COMMON_HOOK","MEMORY_SCAN","COOKIE","CLASSLOADER_HOOK","MMAP_HOOK","OAT_EXTRACT","FART_DUMP","DEXFILE_CONSTRUCTOR"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/config/","sources":["constants.ts"],"mappings":"OAAO,MAAMA,UAAY,iBAClB,MAAMC,WAAa,kBACnB,MAAMC,iBAAmB,qBACzB,MAAMC,gBAAkB,qBAExB,MAAMC,gBAAkB,WACxB,MAAMC,oBAAsB,iBAC5B,MAAMC,mBAAqB,kBAE3B,MAAMC,qBAAuB,UAC7B,MAAMC,uBAAyB,UAC/B,MAAMC,sBAAwB,UAE9B,MAAMC,aAAe,iBACrB,MAAMC,aAAe,WAErB,MAAMC,WAAa,eACnB,MAAMC,gBAAkB,UACxB,MAAMC,cAAgB,UAEtB,MAAMC,kBAAoB,YAC1B,MAAMC,mBAAqB,SAE3B,MAAMC,eAAiB,CAC1BC,SAAU,WACVC,iBAAkB,mBAClBC,YAAa,cACbC,OAAQ,SACRC,iBAAkB,mBAClBC,UAAW,YACXC,YAAa,cACbC,UAAW,YACXC,oBAAqB","ignoreList":[]}
âœ„
export const DEX_MAGIC=175662436;export const CDEX_MAGIC=2019910755;export const CDEX_MAGIC_BYTES="63 64 65 78";export const DEX_MAGIC_BYTES="64 65 78 0a";export const DEX_HEADER_SIZE=112;export const DEX_ENDIAN_CONSTANT=305419896;export const DEX_REVERSE_ENDIAN=2018915346;export const DEX_FILE_SIZE_OFFSET=32;export const DEX_HEADER_SIZE_OFFSET=36;export const DEX_ENDIAN_TAG_OFFSET=40;export const MAX_DEX_SIZE=104857600;export const MIN_DEX_SIZE=112;export const CHUNK_SIZE=4194304;export const SCAN_BATCH_SIZE=50;export const SCAN_DELAY_MS=10;export const OFFSET_SEARCH_MAX=1024;export const OFFSET_SEARCH_STEP=4;export const STRATEGY_NAMES={ART_WALK:"art_walk",OPEN_COMMON_HOOK:"open_common_hook",MEMORY_SCAN:"memory_scan",COOKIE:"cookie",CLASSLOADER_HOOK:"classloader_hook",MMAP_HOOK:"mmap_hook",OAT_EXTRACT:"oat_extract",FART_DUMP:"fart_dump",DEXFILE_CONSTRUCTOR:"dexfile_constructor"};
âœ„
{"version":3,"file":"offsets.js","names":["STATIC_OFFSETS_ARM64","cookieFirstDexOffset","STATIC_OFFSETS_ARM32","ART_ACCESSOR_SYMBOLS","getClassLinker","getJavaVM","getHeap","runtimeInstance"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/config/","sources":["offsets.ts"],"mappings":"OAsCO,MAAMA,qBAA4D,CACrE,GAAI,CAAEC,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,WAGzB,MAAMC,qBAA4D,CACrE,GAAI,CAAED,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,GAC5B,GAAI,CAAEA,qBAAsB,WAIzB,MAAME,qBAAuB,CAChCC,eAAgB,qCAChBC,UAAW,gCACXC,QAAS,6BACTC,gBAAiB","ignoreList":[]}
âœ„
export const STATIC_OFFSETS_ARM64={26:{cookieFirstDexOffset:1},27:{cookieFirstDexOffset:1},28:{cookieFirstDexOffset:1},29:{cookieFirstDexOffset:1},30:{cookieFirstDexOffset:1},31:{cookieFirstDexOffset:1},32:{cookieFirstDexOffset:1},33:{cookieFirstDexOffset:1},34:{cookieFirstDexOffset:1},35:{cookieFirstDexOffset:1}};export const STATIC_OFFSETS_ARM32={26:{cookieFirstDexOffset:1},27:{cookieFirstDexOffset:1},28:{cookieFirstDexOffset:1},29:{cookieFirstDexOffset:1},30:{cookieFirstDexOffset:1},31:{cookieFirstDexOffset:1},32:{cookieFirstDexOffset:1},33:{cookieFirstDexOffset:1},34:{cookieFirstDexOffset:1},35:{cookieFirstDexOffset:1}};export const ART_ACCESSOR_SYMBOLS={getClassLinker:"_ZNK3art7Runtime14GetClassLinkerEv",getJavaVM:"_ZNK3art7Runtime10GetJavaVMEv",getHeap:"_ZNK3art7Runtime7GetHeapEv",runtimeInstance:"_ZN3art7Runtime9instance_E"};
âœ„
{"version":3,"file":"androidVersion.js","names":["Java","logger","cachedInfo","cachedNativeInfo","getAndroidInfoNative","apiLevel","release","getProp","NativeFunction","Process","findModuleByName","getExportByName","nameBuf","Memory","allocUtf8String","valBuf","alloc","sdkStr","readCString","parseInt","e","warn","arch","pointerSize","info","getAndroidInfo","Build","use","SDK_INT","value","RELEASE","isAtLeast","level"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/core/","sources":["androidVersion.ts"],"mappings":"OAAOA,MAAU,qCACRC,MAAc,qBASvB,IAAIC,EAAiC,KACjCC,EAAuC,YAKrC,SAAUC,uBACZ,GAAID,EAAkB,OAAOA,EAE7B,IAAIE,EAAW,EACXC,EAAU,UAEd,IACI,MAAMC,EAAU,IAAIC,eAChBC,QAAQC,iBAAiB,WAAYC,gBAAgB,yBACrD,MACA,CAAC,UAAW,YAEVC,EAAUC,OAAOC,gBAAgB,wBACjCC,EAASF,OAAOG,MAAM,IAC5BT,EAAQK,EAASG,GACjB,MAAME,EAASF,EAAOG,cAClBD,IAAQZ,EAAWc,SAASF,EAAQ,KAAO,GAG/CV,EADoBM,OAAOC,gBAAgB,4BACtBC,GACrBT,EAAUS,EAAOG,eAAiB,S,CACpC,MAAOE,GACLnB,EAAOoB,KAAK,UAAW,gCAAgCD,I,CAW3D,OARAjB,EAAmB,CACfE,WACAC,UACAgB,KAAMb,QAAQa,KACdC,YAAad,QAAQc,aAGzBtB,EAAOuB,KAAK,UAAW,WAAWlB,UAAgBD,aAAoBI,QAAQa,QACvEnB,CACX,QAKM,SAAUsB,iBACZ,GAAIvB,EAAY,OAAOA,EAEvB,IAAIG,EAAW,EACXC,EAAU,UAEd,IACI,MAAMoB,EAAQ1B,EAAK2B,IAAI,4BACvBtB,EAAWqB,EAAME,QAAQC,MACzBvB,EAAUoB,EAAMI,QAAQD,K,CAC1B,MAAOT,GAGL,OAFAnB,EAAOoB,KAAK,UAAW,iCAAiCD,KAEjDhB,sB,CAWX,OARAF,EAAa,CACTG,WACAC,UACAgB,KAAMb,QAAQa,KACdC,YAAad,QAAQc,aAGzBtB,EAAOuB,KAAK,UAAW,WAAWlB,UAAgBD,aAAoBI,QAAQa,QACvEpB,CACX,QAEM,SAAU6B,UAAUC,GACtB,OAAO5B,uBAAuBC,UAAY2B,CAC9C","ignoreList":[]}
âœ„
import e from"frida-java-bridge";import{logger as r}from"../utils/logger.js";let o=null,n=null;export function getAndroidInfoNative(){if(n)return n;let e=0,o="unknown";try{const r=new NativeFunction(Process.findModuleByName("libc.so").getExportByName("__system_property_get"),"int",["pointer","pointer"]),n=Memory.allocUtf8String("ro.build.version.sdk"),t=Memory.alloc(92);r(n,t);const i=t.readCString();i&&(e=parseInt(i,10)||0);r(Memory.allocUtf8String("ro.build.version.release"),t),o=t.readCString()||"unknown"}catch(e){r.warn("VERSION",`Native property read failed: ${e}`)}return n={apiLevel:e,release:o,arch:Process.arch,pointerSize:Process.pointerSize},r.info("VERSION",`Android ${o} (API ${e}), arch: ${Process.arch}`),n}export function getAndroidInfo(){if(o)return o;let n=0,t="unknown";try{const r=e.use("android.os.Build$VERSION");n=r.SDK_INT.value,t=r.RELEASE.value}catch(e){return r.warn("VERSION",`Failed to read Build.VERSION: ${e}`),getAndroidInfoNative()}return o={apiLevel:n,release:t,arch:Process.arch,pointerSize:Process.pointerSize},r.info("VERSION",`Android ${t} (API ${n}), arch: ${Process.arch}`),o}export function isAtLeast(e){return getAndroidInfoNative().apiLevel>=e}
âœ„
{"version":3,"file":"antiFrida.js","names":["logger","TAG","SIG_DFL","ptr","PROTECTED_SIGNALS","installAntiFridaBypass","info","bypassed","libc","Process","findModuleByName","patched","sigactionAddr","findExportByName","Interceptor","attach","onEnter","args","signum","toInt32","includes","debug","actPtr","isNull","writePointer","flagsOffset","arch","flags","add","readU32","writeU32","e","signalAddr","patchSignalHandlers","fridaPatterns","isMapsPath","path","test","readAddr","writeAddr","closeAddr","lseekAddr","warn","readNative","NativeFunction","writeNative","closeNative","lseekNative","filenoAddr","fdopenAddr","fcloseAddr","filenoNative","fdopenNative","fcloseNative","memfdCreateFn","memfdName","Memory","allocUtf8String","memfdLibcAddr","nf","syscallAddr","SYS_memfd_create","rMode","readAllFromFd","fd","BUF_SIZE","buf","alloc","content","n","readUtf8String","createFilteredMemfd","filtered","split","filter","line","length","lower","toLowerCase","some","p","join","memfd","filteredBuf","byteLen","readU8","written","w","replaceFdRetval","retval","realFd","replace","openHookAddr","readCString","this","isMaps","onLeave","openatHookAddr","fopenHookAddr","newFile","patchProcMaps","suspiciousModules","pthreadCreateAddr","noopFunc","noop","pageSize","protect","cacheflushAddr","cacheflush","startRoutine","mod","findModuleByAddress","s","name","patchPthreadCreate"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/core/","sources":["antiFrida.ts"],"mappings":"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","ignoreList":[]}
âœ„
import{logger as t}from"../utils/logger.js";const n="ANTI-FRIDA",e=ptr(0),i=[4,5];export function installAntiFridaBypass(){t.info(n,"Installing anti-frida bypass...");let o=0;o+=function(){const o=Process.findModuleByName("libc.so");if(!o)return 0;let r=0;const a=o.findExportByName("sigaction");if(a)try{Interceptor.attach(a,{onEnter(o){const r=o[0].toInt32();if(i.includes(r)){t.debug(n,`Blocked sigaction for signal ${r}`);const i=o[1];if(!i.isNull())try{i.writePointer(e);const t="arm64"===Process.arch?136:4;try{const n=i.add(t).readU32();i.add(t).writeU32(-5&n)}catch{}}catch{}}}}),r++,t.debug(n,"Hooked sigaction")}catch(e){t.debug(n,`Failed to hook sigaction: ${e}`)}const c=o.findExportByName("signal");if(c)try{Interceptor.attach(c,{onEnter(o){const r=o[0].toInt32();i.includes(r)&&(t.debug(n,`Blocked signal() for signal ${r}`),o[1]=e)}}),r++,t.debug(n,"Hooked signal()")}catch(e){t.debug(n,`Failed to hook signal: ${e}`)}return r}(),o+=function(){const e=Process.findModuleByName("libc.so");if(!e)return 0;let i=0;const o=["frida","gmain","gdbus","gum-js-loop","linjector"],r=t=>/\/proc\/(self|\d+)\/(maps|smaps)/.test(t),a=e.findExportByName("read"),c=e.findExportByName("write"),s=e.findExportByName("close"),l=e.findExportByName("lseek");if(!(a&&c&&s&&l))return t.warn(n,"Missing libc functions for maps filtering"),0;const d=new NativeFunction(a,"int",["int","pointer","int"]),f=new NativeFunction(c,"int",["int","pointer","int"]),u=new NativeFunction(s,"int",["int"]),p=new NativeFunction(l,"int",["int","int","int"]),m=e.findExportByName("fileno"),g=e.findExportByName("fdopen"),h=e.findExportByName("fclose"),y=m?new NativeFunction(m,"int",["pointer"]):null,N=g?new NativeFunction(g,"pointer",["int","pointer"]):null,b=h?new NativeFunction(h,"int",["pointer"]):null;let B=null;const E=Memory.allocUtf8String("m"),w=e.findExportByName("memfd_create");if(w){const e=new NativeFunction(w,"int",["pointer","uint"]);B=()=>e(E,0),t.debug(n,"Using memfd_create libc wrapper")}else{const i=e.findExportByName("syscall");if(i){const e="arm64"===Process.arch?279:385,o=new NativeFunction(i,"int",["int","pointer","uint"]);B=()=>o(e,E,0),t.debug(n,"Using memfd_create via syscall")}}if(!B)return t.warn(n,"memfd_create unavailable, maps filtering disabled"),0;const F=Memory.allocUtf8String("r");function v(t){const n=262144,e=Memory.alloc(n);let i="";for(;;){const o=d(t,e,n);if(o<=0)break;i+=e.readUtf8String(o)}return i}function x(t){const n=t.split("\n").filter((t=>{if(0===t.length)return!0;const n=t.toLowerCase();return!o.some((t=>n.includes(t)))})).join("\n"),e=B();if(e<0)return-1;if(n.length>0){const t=Memory.allocUtf8String(n);let i=0;for(;i<4*n.length&&0!==t.add(i).readU8();)i++;let o=0;for(;o<i;){const n=f(e,t.add(o),i-o);if(n<=0)break;o+=n}}return p(e,0,0),e}function M(t){const n=t.toInt32();if(!(n<0))try{const e=x(v(n));e>=0?(u(n),t.replace(ptr(e))):p(n,0,0)}catch{try{p(n,0,0)}catch{}}}const k=e.findExportByName("open");if(k)try{Interceptor.attach(k,{onEnter(t){try{const n=t[0].readCString();n&&r(n)&&(this.isMaps=!0)}catch{}},onLeave(t){this.isMaps&&M(t)}}),i++}catch(e){t.debug(n,`Failed to hook open: ${e}`)}const I=e.findExportByName("openat");if(I)try{Interceptor.attach(I,{onEnter(t){try{const n=t[1].readCString();n&&r(n)&&(this.isMaps=!0)}catch{}},onLeave(t){this.isMaps&&M(t)}}),i++}catch(e){t.debug(n,`Failed to hook openat: ${e}`)}if(y&&N&&b){const o=e.findExportByName("fopen");if(o)try{Interceptor.attach(o,{onEnter(t){try{const n=t[0].readCString();n&&r(n)&&(this.isMaps=!0)}catch{}},onLeave(t){if(this.isMaps&&!t.isNull())try{const n=y(t);if(n<0)return;const e=x(v(n));if(e<0)return void p(n,0,0);const i=N(e,F);if(i.isNull())return u(e),void p(n,0,0);b(t),t.replace(i)}catch{try{const n=y(t);n>=0&&p(n,0,0)}catch{}}}}),i++}catch(e){t.debug(n,`Failed to hook fopen: ${e}`)}}i>0&&t.debug(n,`Maps filtering active (${i} hooks, memfd-based)`);return i}(),o+=function(){const e=Process.findModuleByName("libc.so");if(!e)return 0;const i=["libcoldstart.so","libliger.so","libsec.so","libprotect.so"],o=e.findExportByName("pthread_create");if(!o)return 0;let r=null;try{const t=Memory.alloc(Process.pageSize);"arm64"===Process.arch?t.writeU32(3596551104):"arm"===Process.arch&&t.writeU32(3778019102),Memory.protect(t,Process.pageSize,"r-x");const n=e.findExportByName("cacheflush");if(n){new NativeFunction(n,"int",["pointer","pointer","int"])(t,t.add(4),0)}r=t}catch(e){return t.debug(n,`Failed to create noop function: ${e}`),0}try{return Interceptor.attach(o,{onEnter(e){const o=e[2];if(!o.isNull())try{const a=Process.findModuleByAddress(o);a&&i.some((t=>a.name.includes(t)))&&(t.info(n,`Neutralized watchdog thread from ${a.name}`),r&&(e[2]=r))}catch{}}}),t.debug(n,"Hooked pthread_create"),1}catch(e){return t.debug(n,`Failed to hook pthread_create: ${e}`),0}}(),t.info(n,`Anti-frida bypass installed (${o} patches)`)}
âœ„
{"version":3,"file":"deduplicator.js","names":["Deduplicator","seen","Set","_count","_totalBytes","isDuplicate","dexBytes","hash","this","computeHash","has","add","byteLength","count","totalBytes","hashes","Array","from","data","view","Uint8Array","len","length","h1","h2","headSize","Math","min","i","imul","midStart","floor","midEnd","max","toString"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/core/","sources":["deduplicator.ts"],"mappings":"OAMM,MAAOA,aACDC,KAAoB,IAAIC,IACxBC,OAAS,EACTC,YAAc,EAOtBC,YAAYC,GACR,MAAMC,EAAOC,KAAKC,YAAYH,GAC9B,QAAIE,KAAKP,KAAKS,IAAIH,KAGlBC,KAAKP,KAAKU,IAAIJ,GACdC,KAAKL,SACLK,KAAKJ,aAAeE,EAASM,YACtB,EACX,CAGIC,YACA,OAAOL,KAAKL,MAChB,CAGIW,iBACA,OAAON,KAAKJ,WAChB,CAGIW,aACA,OAAOC,MAAMC,KAAKT,KAAKP,KAC3B,CAQQQ,YAAYS,GAChB,MAAMC,EAAO,IAAIC,WAAWF,GACtBG,EAAMF,EAAKG,OAGjB,IAAIC,EAAK,KACLC,EAAK,WAGT,MAAMC,EAAWC,KAAKC,IAAI,IAAKN,GAC/B,IAAK,IAAIO,EAAI,EAAGA,EAAIH,EAAUG,IAC1BL,GAAOA,GAAM,GAAKA,EAAKJ,EAAKS,KAAQ,EACpCJ,EAAKE,KAAKG,KAAKL,EAAKL,EAAKS,GAAI,YAAgB,EAIjD,GAAIP,EAAM,KAAM,CACZ,MAAMS,EAAWJ,KAAKK,MAAMV,EAAM,GAAK,IACjCW,EAASN,KAAKC,IAAIG,EAAW,IAAKT,GACxC,IAAK,IAAIO,EAAIE,EAAUF,EAAII,EAAQJ,IAC/BL,GAAOA,GAAM,GAAKA,EAAKJ,EAAKS,KAAQ,EACpCJ,EAAKE,KAAKG,KAAKL,EAAKL,EAAKS,GAAI,YAAgB,C,CAMrD,IAAK,IAAIA,EADSF,KAAKO,IAAIR,EAAUJ,EAAM,KACnBO,EAAIP,EAAKO,IAC7BL,GAAOA,GAAM,GAAKA,EAAKJ,EAAKS,KAAQ,EACpCJ,EAAKE,KAAKG,KAAKL,EAAKL,EAAKS,GAAI,YAAgB,EAOjD,OAHAL,GAAOA,GAAM,GAAKA,EAAKF,IAAS,EAChCG,EAAKE,KAAKG,KAAKL,EAAY,IAANH,EAAa,YAAgB,EAE3C,GAAGE,EAAGW,SAAS,OAAOV,EAAGU,SAAS,OAAOb,GACpD","ignoreList":[]}
âœ„
export class Deduplicator{seen=new Set;_count=0;_totalBytes=0;isDuplicate(t){const e=this.computeHash(t);return!!this.seen.has(e)||(this.seen.add(e),this._count++,this._totalBytes+=t.byteLength,!1)}get count(){return this._count}get totalBytes(){return this._totalBytes}get hashes(){return Array.from(this.seen)}computeHash(t){const e=new Uint8Array(t),s=e.length;let n=5381,o=2166136261;const a=Math.min(512,s);for(let t=0;t<a;t++)n=(n<<5)+n+e[t]>>>0,o=Math.imul(o^e[t],16777619)>>>0;if(s>1024){const t=Math.floor(s/2)-256,a=Math.min(t+512,s);for(let s=t;s<a;s++)n=(n<<5)+n+e[s]>>>0,o=Math.imul(o^e[s],16777619)>>>0}for(let t=Math.max(a,s-512);t<s;t++)n=(n<<5)+n+e[t]>>>0,o=Math.imul(o^e[t],16777619)>>>0;return n=(n<<5)+n+s>>>0,o=Math.imul(o^255&s,16777619)>>>0,`${n.toString(16)}_${o.toString(16)}_${s}`}}
âœ„
{"version":3,"file":"dexDumper.js","names":["sendDexFound","validateDexHeader","readDexBytes","logger","DexDumper","dedup","constructor","this","dumpFromAddress","address","strategy","extra","fileSize","dexBytes","isDuplicate","debug","info","toString","warn","dumpBytes","byteLength","uniqueCount","count","totalBytes"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/core/","sources":["dexDumper.ts"],"mappings":"uBAESA,MAAoB,wDACpBC,kBAAmBC,MAAoB,2CACvCC,MAAc,4BAMjB,MAAOC,UACDC,MAERC,YAAYD,GACRE,KAAKF,MAAQA,CACjB,CAMAG,gBACIC,EACAC,EACAC,GAEA,MAAMC,EAAWX,EAAkBQ,GACnC,GAAiB,IAAbG,EAAgB,OAAO,EAE3B,MAAMC,EAAWX,EAAaO,EAASG,GACvC,OAAKC,EAKDN,KAAKF,MAAMS,YAAYD,IACvBV,EAAOY,MAAM,OAAQ,oBAAoBN,MAAYG,aAC9C,IAGXT,EAAOa,KAAK,OAAQ,kBAAkBJ,cAAqBH,MAAYC,MACvEV,EAAaU,EAAUG,EAAU,CAC7BJ,QAASA,EAAQQ,cACdN,KAGA,IAfHR,EAAOe,KAAK,OAAQ,kBAAkBN,cAAqBH,MACpD,EAef,CAMAU,UACIN,EACAH,EACAC,GAEA,OAAIJ,KAAKF,MAAMS,YAAYD,KAI3BV,EAAOa,KAAK,OAAQ,kBAAkBH,EAASO,qBAAqBV,MACpEV,EAAaU,EAAUG,EAAUF,IAE1B,EACX,CAGIU,kBACA,OAAOd,KAAKF,MAAMiB,KACtB,CAGIC,iBACA,OAAOhB,KAAKF,MAAMkB,UACtB","ignoreList":[]}
âœ„
import{sendDexFound as t}from"../utils/messageSender.js";import{validateDexHeader as e,readDexBytes as s}from"../utils/memoryUtils.js";import{logger as r}from"../utils/logger.js";export class DexDumper{dedup;constructor(t){this.dedup=t}dumpFromAddress(u,d,o){const i=e(u);if(0===i)return!1;const n=s(u,i);return n?this.dedup.isDuplicate(n)?(r.debug("DUMP",`Duplicate DEX at ${u} (${i} bytes)`),!1):(r.info("DUMP",`New DEX found: ${i} bytes at ${u} [${d}]`),t(d,n,{address:u.toString(),...o}),!0):(r.warn("DUMP",`Failed to read ${i} bytes at ${u}`),!1)}dumpBytes(e,s,u){return!this.dedup.isDuplicate(e)&&(r.info("DUMP",`New DEX found: ${e.byteLength} bytes [${s}]`),t(s,e,u),!0)}get uniqueCount(){return this.dedup.count}get totalBytes(){return this.dedup.totalBytes}}
âœ„
{"version":3,"file":"offsetResolver.js","names":["ART_ACCESSOR_SYMBOLS","STATIC_OFFSETS_ARM64","STATIC_OFFSETS_ARM32","logger","safeReadPointer","isValidPointer","validateDexHeader","DEX_MAGIC","DEX_MAGIC_BYTES","OffsetResolver","arch","pointerSize","libart","constructor","this","Process","findModuleByName","resolve","apiLevel","info","fromAccessors","resolveFromAccessors","undefined","runtimeClassLinkerOffset","runtimePtr","getRuntimeInstance","heuristic","findClassLinkerHeuristic","classLinkerOffset","toString","dexFileBeginOffset","verifyViaJNI","fromProbing","resolveFromDexMagic","combined","combineOffsets","staticOffsets","merged","warn","result","found","resolveOffsetFromAccessor","getClassLinker","debug","heapOffset","getHeap","funcName","func","findExportByName","match","enumerateSymbols","find","s","name","address","i","insn","add","readU32","e","libBase","base","libEnd","size","candidates","offset","val","readPointer","isNull","compare","ptr","vtable","push","length","clPtr","beginOffset","verifyClassLinkerAndFindBeginOffset","off","begin","end","elemCount","sub","toInt32","firstElem","dOff","candidate","sym","runtimeInstance","javaVmOffset","getJavaVM","javaVm","fnTable","dexInfo","findDexInMemory","fileSize","ptrPattern","pointerToScanPattern","ranges","enumerateRanges","range","matches","Memory","scanSync","m","readU64","toNumber","candidateBase","probed","probeDexFileOffsets","fileExts","path","file","some","ext","endsWith","p","buf","alloc","writePointer","parts","readU8","padStart","join","nativeDexFilePtr","a","b","classLinkerDexCachesOffset","classLinkerBootClassPathOffset","dexCacheDataDexFileOffset","dexCacheDataSize","dexFileSizeOffset","dexFileLocationOffset","cookieFirstDexOffset"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/core/","sources":["offsetResolver.ts"],"mappings":"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","ignoreList":[]}
âœ„
import{ART_ACCESSOR_SYMBOLS as e,STATIC_OFFSETS_ARM64 as t,STATIC_OFFSETS_ARM32 as i}from"../config/offsets.js";import{logger as s}from"../utils/logger.js";import{safeReadPointer as n,isValidPointer as r,validateDexHeader as o}from"../utils/memoryUtils.js";import{DEX_MAGIC as f,DEX_MAGIC_BYTES as a}from"../config/constants.js";export class OffsetResolver{arch;pointerSize;libart=null;constructor(){this.arch=Process.arch,this.pointerSize=Process.pointerSize,this.libart=Process.findModuleByName("libart.so")}resolve(e){s.info("OFFSETS","Resolving ART structure offsets...");let n=this.resolveFromAccessors();if(!n||void 0===n.runtimeClassLinkerOffset){const e=this.getRuntimeInstance();if(e){const t=this.findClassLinkerHeuristic(e);t&&(s.info("OFFSETS",`Found ClassLinker via heuristic at Runtime+0x${t.classLinkerOffset.toString(16)}, begin_ at DexFile+0x${t.dexFileBeginOffset.toString(16)}`),n||(n={}),n.runtimeClassLinkerOffset=t.classLinkerOffset,n.dexFileBeginOffset=t.dexFileBeginOffset)}}if(void 0!==n?.runtimeClassLinkerOffset){const e=this.getRuntimeInstance();if(e){this.verifyViaJNI(e)&&s.info("OFFSETS","Offsets verified via JNI anchoring")}}const r=this.resolveFromDexMagic(),o=this.combineOffsets(n,r);if(o)return s.info("OFFSETS","Offsets resolved via dynamic analysis"),o;const f=("arm64"===this.arch?t:i)[e];if(f){s.info("OFFSETS",`Using static offset table for API ${e}`);const t=this.combineOffsets(n,f);if(t)return t}return s.warn("OFFSETS","Could not resolve ART offsets â€” ART Walk strategy will be skipped"),null}resolveFromAccessors(){const t={};let i=!1;const n=this.resolveOffsetFromAccessor(e.getClassLinker);null!==n&&(t.runtimeClassLinkerOffset=n,s.debug("OFFSETS",`GetClassLinker offset: 0x${n.toString(16)}`),i=!0);const r=this.resolveOffsetFromAccessor(e.getHeap);return null!==r&&s.debug("OFFSETS",`GetHeap offset: 0x${r.toString(16)}`),i?t:null}resolveOffsetFromAccessor(e){if(!this.libart)return null;let t=this.libart.findExportByName(e);if(!t){const i=this.libart.enumerateSymbols().find((t=>t.name===e));i&&(t=i.address)}if(!t)return s.debug("OFFSETS",`Symbol not found: ${e}`),null;try{if("arm64"===this.arch)for(let e=0;e<4;e++){const i=t.add(4*e).readU32();if(3573752863!=(4294967071&i)&&3573752639!=(4294963200&i)){if(4181721088==(4290772992&i))return 8*(i>>10&4095);break}}else if("arm"===this.arch){const e=t.readU32();if(93323264==(258998272&e))return 4095&e;if(84934656==(258998272&e))return-(4095&e)}}catch(t){s.debug("OFFSETS",`Failed to disassemble ${e}: ${t}`)}return null}findClassLinkerHeuristic(e){if(!this.libart)return null;const t=this.libart.base,i=t.add(this.libart.size),n=[];for(let s=0;s<2048;s+=this.pointerSize)try{const r=e.add(s).readPointer();if(r.isNull()||r.compare(ptr(4096))<=0)continue;const o=r.readPointer();o.compare(t)>=0&&o.compare(i)<0&&n.push({offset:s,ptr:r})}catch{continue}s.debug("OFFSETS",`Found ${n.length} ClassLinker candidates in Runtime struct`);for(const{offset:e,ptr:t}of n){const i=this.verifyClassLinkerAndFindBeginOffset(t);if(null!==i)return{classLinkerOffset:e,dexFileBeginOffset:i}}return null}verifyClassLinkerAndFindBeginOffset(e){for(let t=0;t<1024;t+=this.pointerSize)try{const i=e.add(t).readPointer(),n=e.add(t+this.pointerSize).readPointer();if(i.isNull()||n.isNull())continue;if(i.compare(n)>=0)continue;const r=n.sub(i).toInt32()/this.pointerSize;if(r<1||r>500)continue;const o=i.readPointer();if(o.isNull())continue;for(let e=0;e<64;e+=this.pointerSize)try{const i=o.add(e).readPointer();if(i.isNull())continue;if(i.readU32()===f)return s.debug("OFFSETS",`ClassLinker verified: boot_class_path_ at CL+0x${t.toString(16)}, DexFile::begin_ at +0x${e.toString(16)}`),e}catch{continue}}catch{continue}return null}getRuntimeInstance(){if(!this.libart)return s.debug("OFFSETS","libart.so not found"),null;const t=this.libart.findExportByName(e.runtimeInstance);if(!t)return s.debug("OFFSETS","Runtime::instance_ not found"),null;try{const e=t.readPointer();if(r(e))return e}catch(e){s.debug("OFFSETS",`Failed to read Runtime::instance_: ${e}`)}return null}verifyViaJNI(t){try{const i=this.resolveOffsetFromAccessor(e.getJavaVM);if(null!==i){const e=n(t.add(i));if(e&&r(e))try{const t=e.readPointer();if(r(t))return s.debug("OFFSETS",`Verified java_vm_ at Runtime+0x${i.toString(16)}`),!0}catch{}}}catch(e){s.debug("OFFSETS",`JNI verification failed: ${e}`)}return!1}resolveFromDexMagic(){s.debug("OFFSETS","Level 3: Probing for DexFile::begin_ via memory scan...");const e=this.findDexInMemory();if(!e)return s.debug("OFFSETS","Level 3: No standard DEX files found in memory"),null;s.debug("OFFSETS",`Level 3: Found DEX at ${e.address} (${e.fileSize} bytes)`);const t=this.pointerToScanPattern(e.address),i=Process.enumerateRanges("r--");for(const n of i){if(n.size<4*this.pointerSize||n.size>67108864)continue;let i;try{i=Memory.scanSync(n.base,n.size,t)}catch{continue}for(const t of i){try{if((8===this.pointerSize?t.address.add(this.pointerSize).readU64().toNumber():t.address.add(this.pointerSize).readU32())!==e.fileSize)continue}catch{continue}for(let e=this.pointerSize;e<=64;e+=this.pointerSize)try{const i=t.address.sub(e),n=this.probeDexFileOffsets(i);if(n&&n.dexFileBeginOffset===e)return s.info("OFFSETS",`Level 3: DexFile::begin_ at +0x${e.toString(16)}`),n}catch{continue}}}return s.debug("OFFSETS","Level 3: Could not determine DexFile::begin_ offset"),null}findDexInMemory(){const e=Process.enumerateRanges("r--"),t=[".apk",".jar",".vdex",".oat"];for(const i of e){if(i.size<112||i.size>67108864)continue;const e=i.file?.path;if(e&&t.some((t=>e.endsWith(t))))try{const e=Memory.scanSync(i.base,i.size,a);for(const t of e){const e=o(t.address);if(e>0)return{address:t.address,fileSize:e}}}catch{continue}}for(const t of e)if(!(t.size<112||t.size>8388608||t.file?.path))try{const e=Memory.scanSync(t.base,t.size,a);for(const t of e){const e=o(t.address);if(e>0)return{address:t.address,fileSize:e}}}catch{continue}return null}pointerToScanPattern(e){const t=Memory.alloc(this.pointerSize);t.writePointer(e);const i=[];for(let e=0;e<this.pointerSize;e++)i.push(t.add(e).readU8().toString(16).padStart(2,"0"));return i.join(" ")}probeDexFileOffsets(e){const t={};for(let i=0;i<256;i+=this.pointerSize)try{const n=e.add(i).readPointer();if(n.isNull())continue;if(n.readU32()===f)return t.dexFileBeginOffset=i,s.debug("OFFSETS",`Found DexFile::begin_ at offset 0x${i.toString(16)}`),t}catch{continue}return null}combineOffsets(e,t){if(!e&&!t)return null;const i={...t,...e};return void 0!==i.runtimeClassLinkerOffset&&void 0!==i.dexFileBeginOffset?{runtimeClassLinkerOffset:i.runtimeClassLinkerOffset,classLinkerDexCachesOffset:i.classLinkerDexCachesOffset??0,classLinkerBootClassPathOffset:i.classLinkerBootClassPathOffset??0,dexCacheDataDexFileOffset:i.dexCacheDataDexFileOffset??0,dexCacheDataSize:i.dexCacheDataSize??4*this.pointerSize,dexFileBeginOffset:i.dexFileBeginOffset,dexFileSizeOffset:i.dexFileSizeOffset??i.dexFileBeginOffset+this.pointerSize,dexFileLocationOffset:i.dexFileLocationOffset??0,cookieFirstDexOffset:i.cookieFirstDexOffset??1}:null}}
âœ„
{"version":3,"file":"artWalker.js","names":["STRATEGY_NAMES","DEX_MAGIC","sendStrategyStatus","safeReadPointer","isValidPointer","validateDexHeader","logger","TAG","ART_WALK","runArtWalker","dumper","offsetResolver","offsets","strategy","found","runtimePtr","getRuntimeInstance","strategyError","info","classLinker","add","runtimeClassLinkerOffset","classLinkerBootClassPathOffset","walkDexFileVector","classLinkerDexCachesOffset","vectorAddr","begin","end","Process","pointerSize","totalBytes","sub","toInt32","entrySize","dexCacheDataSize","count","Math","floor","i","entry","dexFilePtr","dexCacheDataDexFileOffset","dumpFromDexFilePtr","e","debug","walkDexCaches","probeRange","off","p1","readPointer","p2","compare","size","dexCount","min","entryPtr","fieldOff","candidateBegin","isNull","readU32","toString","probeClassLinker","label","beginPtr","dexFileBeginOffset","location","dexFileLocationOffset","locBase","firstByte","readU8","ssoLen","readUtf8String","undefined","dataPtr","readCString","dumpFromAddress","candidate"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/strategies/","sources":["artWalker.ts"],"mappings":"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","ignoreList":[]}
âœ„
import{STRATEGY_NAMES as e,DEX_MAGIC as t}from"../config/constants.js";import{sendStrategyStatus as r}from"../utils/messageSender.js";import{safeReadPointer as n,isValidPointer as o,validateDexHeader as i}from"../utils/memoryUtils.js";import{logger as s}from"../utils/logger.js";const a=e.ART_WALK;export function runArtWalker(e,i,f){s.strategy(a,"Starting ART structure walk..."),r(a,"active","Walking ART Runtime structures");let l=0;try{const u=i.getRuntimeInstance();if(!u)return s.strategyError(a,"Cannot find Runtime::instance_"),void r(a,"error","Runtime::instance_ not found");s.info(a,`Runtime instance: ${u}`);const p=n(u.add(f.runtimeClassLinkerOffset));if(!p||!o(p))return s.strategyError(a,"Cannot read ClassLinker pointer"),void r(a,"error","ClassLinker not found");s.info(a,`ClassLinker: ${p}`),f.classLinkerBootClassPathOffset>0&&(l+=c(e,p.add(f.classLinkerBootClassPathOffset),f,"boot_class_path")),f.classLinkerDexCachesOffset>0&&(l+=function(e,t,r){let i=0;try{const c=n(t),f=n(t.add(Process.pointerSize));if(!(c&&f&&o(c)&&o(f)))return 0;const l=f.sub(c).toInt32(),u=r.dexCacheDataSize;if(u<=0||l<=0||l>1e6)return 0;const p=Math.floor(l/u);s.info(a,`dex_caches: ${p} entries (entry size: ${u})`);for(let t=0;t<p;t++){const s=c.add(t*u),a=n(s.add(r.dexCacheDataDexFileOffset));a&&o(a)&&(i+=d(e,a,r))}}catch(e){s.debug(a,`dex_caches walk error: ${e}`)}return i}(e,p.add(f.classLinkerDexCachesOffset),f)),0===l&&(s.info(a,"No DEX found via known offsets, probing ClassLinker..."),l+=function(e,r,i){let d=0;const f=2048;for(let l=0;l<f;l+=Process.pointerSize)try{const f=r.add(l).readPointer(),u=r.add(l+Process.pointerSize).readPointer();if(!o(f)||!o(u))continue;if(u.compare(f)<0)continue;const p=u.sub(f).toInt32();if(p<=0||p>1e5||p%Process.pointerSize!=0)continue;const m=p/Process.pointerSize;if(m>1e3)continue;let g=0;for(let e=0;e<Math.min(m,5);e++){const r=n(f.add(e*Process.pointerSize));if(r&&o(r))for(let e=0;e<64;e+=Process.pointerSize)try{const n=r.add(e).readPointer();if(!n.isNull()&&n.readU32()===t){g++;break}}catch{continue}}g>=Math.min(m,3)&&(s.info(a,`Found probable DexFile vector at ClassLinker+0x${l.toString(16)} (${m} entries)`),d+=c(e,r.add(l),i,`probe_0x${l.toString(16)}`))}catch{continue}return d}(e,p,f)),s.strategy(a,`ART walk complete: ${l} DEX files`),r(a,"complete",`Found ${l} DEX files`)}catch(e){s.strategyError(a,`ART walk failed: ${e}`),r(a,"error",`${e}`)}}function c(e,t,r,i){let c=0;try{const f=n(t),l=n(t.add(Process.pointerSize));if(!(f&&l&&o(f)&&o(l)))return s.debug(a,`${i}: invalid vector pointers`),0;const u=l.sub(f).toInt32()/Process.pointerSize;if(u<=0||u>1e4)return s.debug(a,`${i}: suspicious count ${u}`),0;s.info(a,`${i}: ${u} entries`);for(let t=0;t<u;t++){const i=n(f.add(t*Process.pointerSize));i&&o(i)&&(c+=d(e,i,r))}}catch(e){s.debug(a,`${i} walk error: ${e}`)}return c}function d(r,o,s){const a=n(o.add(s.dexFileBeginOffset));if(a&&!a.isNull()){if(i(a)>0){let t;if(s.dexFileLocationOffset>0)try{const e=o.add(s.dexFileLocationOffset),r=e.readU8();if(0==(1&r)){const n=r>>1;n>0&&n<23&&(t=e.add(1).readUtf8String(n)??void 0)}else{const r=e.add(2*Process.pointerSize).readPointer();r.isNull()||(t=r.readCString()??void 0)}}catch{}return r.dumpFromAddress(a,e.ART_WALK,{location:t})?1:0}}for(let n=0;n<128;n+=Process.pointerSize)try{const i=o.add(n).readPointer();if(i.isNull())continue;if(i.readU32()===t&&r.dumpFromAddress(i,e.ART_WALK))return 1}catch{continue}return 0}
âœ„
{"version":3,"file":"classLoaderHook.js","names":["Java","STRATEGY_NAMES","DEX_MAGIC","sendStrategyStatus","sendClassLoaded","logger","TAG","CLASSLOADER_HOOK","runClassLoaderHooks","dumper","strategy","use","loadClass","overload","implementation","name","resolve","result","this","toString","info","e","warn","$init","dexPath","optimizedDirectory","librarySearchPath","parent","BaseDexClassLoader","pathList","cast","value","dexElements","i","length","dexFile","cookie","mCookie","ReflectArray","arrLen","getLength","j","longVal","getLong","nativePtr","ptr","isNull","off","Process","pointerSize","begin","add","readPointer","readU32","dumpFromAddress","loader","path","debug","buffers","buf","ByteBuffer","castBuf","pos","position","size","limit","isDirect","address","baseAddr","tmpBuf","duplicate","javaBytes","array","Array","fill","get","nativeBuf","Memory","alloc","env","vm","getEnv","javaArr","$handle","getByteArrayRegion","call","k","writeS8","bytes","readByteArray","dumpBytes","buffer","lim","DexFile","loadDex","sourcePathName","outputPathName","flags"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/strategies/","sources":["classLoaderHook.ts"],"mappings":"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","ignoreList":[]}
âœ„
import e from"frida-java-bridge";import{STRATEGY_NAMES as a,DEX_MAGIC as t}from"../config/constants.js";import{sendStrategyStatus as o,sendClassLoaded as s}from"../utils/messageSender.js";import{logger as r}from"../utils/logger.js";const i=a.CLASSLOADER_HOOK;export function runClassLoaderHooks(a){r.strategy(i,"Setting up ClassLoader hooks..."),o(i,"active","Monitoring class loading");try{e.use("java.lang.ClassLoader").loadClass.overload("java.lang.String","boolean").implementation=function(e,a){const t=this.loadClass(e,a);return s(e,this.toString(),i),t},r.info(i,"Hooked ClassLoader.loadClass")}catch(e){r.warn(i,`Failed to hook ClassLoader.loadClass: ${e}`)}try{e.use("dalvik.system.DexClassLoader").$init.implementation=function(o,n,l,d){r.info(i,`DexClassLoader created: ${o}`),s(`[DexClassLoader] ${o}`,this.toString(),i),this.$init(o,n,l,d);try{const s=e.use("dalvik.system.BaseDexClassLoader"),r=e.cast(this,s).pathList.value;if(r){const s=r.dexElements.value;if(s)for(let r=0;r<s.length;r++){const n=s[r].dexFile.value;if(!n)continue;const l=n.mCookie.value;if(!l)continue;const d=e.use("java.lang.reflect.Array"),c=d.getLength(l);if(!(c<2))for(let e=1;e<c;e++){const s=d.getLong(l,e),r=ptr(s.toString());if(!r.isNull())for(let e=0;e<128;e+=Process.pointerSize)try{const s=r.add(e).readPointer();if(!s.isNull()&&s.readU32()===t){a.dumpFromAddress(s,i,{loader:`DexClassLoader:${o}`,path:o});break}}catch{continue}}}}}catch(e){r.debug(i,`Failed to dump after DexClassLoader creation: ${e}`)}},r.info(i,"Hooked DexClassLoader.$init")}catch(e){r.warn(i,`Failed to hook DexClassLoader: ${e}`)}try{e.use("dalvik.system.InMemoryDexClassLoader").$init.overload("[Ljava.nio.ByteBuffer;","java.lang.String","java.lang.ClassLoader").implementation=function(t,o,s){r.info(i,`InMemoryDexClassLoader created with ${t.length} buffers`);for(let o=0;o<t.length;o++)try{const s=t[o];if(null===s)continue;const n=e.use("java.nio.ByteBuffer"),l=e.cast(s,n),d=l.position(),c=l.limit()-d;if(c>0){if(l.isDirect())try{const e=l.address.value;if(e){const t=ptr(e).add(d);a.dumpFromAddress(t,i,{loader:"InMemoryDexClassLoader"})}}catch{}try{const t=l.duplicate();t.position(d);const o=e.array("byte",new Array(c).fill(0));t.get(o);const s=Memory.alloc(c),r=e.vm.getEnv(),n=o.$handle;if(n){const e=r.getByteArrayRegion;if(e)e.call(r,n,0,c,s);else for(let e=0;e<c;e++)s.add(e).writeS8(o[e])}else for(let e=0;e<c;e++)s.add(e).writeS8(o[e]);const f=s.readByteArray(c);f&&a.dumpBytes(f,i,{loader:"InMemoryDexClassLoader"})}catch(e){r.debug(i,`Failed to read ByteBuffer: ${e}`)}}}catch(e){r.debug(i,`ByteBuffer extraction error: ${e}`)}return this.$init(t,o,s)},r.info(i,"Hooked InMemoryDexClassLoader.$init (ByteBuffer[])")}catch(e){r.debug(i,`InMemoryDexClassLoader (ByteBuffer[]) not available: ${e}`)}try{e.use("dalvik.system.InMemoryDexClassLoader").$init.overload("java.nio.ByteBuffer","java.lang.ClassLoader").implementation=function(t,o){r.info(i,"InMemoryDexClassLoader created with single buffer");try{if(null!==t){const o=e.use("java.nio.ByteBuffer"),s=e.cast(t,o),r=s.position(),n=s.limit();if(n-r>0&&s.isDirect())try{const e=s.address.value;e&&a.dumpFromAddress(ptr(e).add(r),i,{loader:"InMemoryDexClassLoader"})}catch{}}}catch(e){r.debug(i,`ByteBuffer extraction error: ${e}`)}return this.$init(t,o)},r.info(i,"Hooked InMemoryDexClassLoader.$init (ByteBuffer)")}catch(e){r.debug(i,`InMemoryDexClassLoader (ByteBuffer) not available: ${e}`)}try{const a=e.use("dalvik.system.DexFile");a.loadDex&&(a.loadDex.implementation=function(e,a,t){return r.info(i,`DexFile.loadDex: ${e}`),s(`[DexFile.loadDex] ${e}`,"DexFile",i),this.loadDex(e,a,t)},r.info(i,"Hooked DexFile.loadDex"))}catch(e){r.debug(i,`DexFile.loadDex not available: ${e}`)}o(i,"active","ClassLoader hooks installed")}
âœ„
{"version":3,"file":"cookieExtractor.js","names":["Java","STRATEGY_NAMES","DEX_MAGIC","sendStrategyStatus","sendClassLoaderFound","safeReadPointer","logger","TAG","COOKIE","readLongArray","arr","result","ArrayReflect","use","len","getLength","i","val","getLong","push","toString","e","debug","Array","isArray","length","String","e2","runCookieExtractor","dumper","offsetResolver","strategy","found","dexFileBeginOffset","enumerateClassLoaders","onMatch","loader","BaseDexClassLoader","cast","loaderStr","loaderType","$className","pathList","value","dexElements","dexFile","cookieObj","mCookie","mInternalCookie","cookieValues","j","nativeDexFilePtr","ptr","isNull","probed","probeDexFileOffsets","undefined","info","beginPtr","add","dumpFromAddress","offset","Process","pointerSize","candidate","readU32","onComplete","strategyError"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/strategies/","sources":["cookieExtractor.ts"],"mappings":"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","ignoreList":[]}
âœ„
import e from"frida-java-bridge";import{STRATEGY_NAMES as t,DEX_MAGIC as o}from"../config/constants.js";import{sendStrategyStatus as r,sendClassLoaderFound as n}from"../utils/messageSender.js";import{safeReadPointer as i}from"../utils/memoryUtils.js";import{logger as l}from"../utils/logger.js";const s=t.COOKIE;function a(t){const o=[];try{const r=e.use("java.lang.reflect.Array"),n=r.getLength(t);for(let e=0;e<n;e++){const n=r.getLong(t,e);o.push(n.toString())}}catch(e){l.debug(s,`readLongArray reflection failed: ${e}`);try{if(Array.isArray(t))for(let e=0;e<t.length;e++)o.push(String(t[e]));else if(t&&"number"==typeof t.length)for(let e=0;e<t.length;e++)o.push(String(t[e]))}catch(e){l.debug(s,`readLongArray fallback failed: ${e}`)}}return o}export function runCookieExtractor(t,c){l.strategy(s,"Starting cookie extraction..."),r(s,"active","Extracting DEX via ClassLoader cookies");let f=0,u=null;try{e.enumerateClassLoaders({onMatch(r){try{const g=e.use("dalvik.system.BaseDexClassLoader"),d=e.cast(r,g),m=r.toString(),h=r.$className||"unknown";try{n(m,h,"unknown")}catch{}const y=d.pathList.value;if(!y)return;const p=y.dexElements.value;if(!p)return;l.debug(s,`${h}: ${p.length} dexElements`);for(let e=0;e<p.length;e++)try{const r=p[e].dexFile.value;if(!r)continue;let n=null;try{n=r.mCookie.value}catch{}if(!n)try{n=r.mInternalCookie.value}catch{}if(!n){l.debug(s,`No cookie for ${m} element ${e}`);continue}const g=a(n);if(l.debug(s,`Cookie for ${h}[${e}]: ${g.length} entries`),g.length<2)continue;for(let e=1;e<g.length;e++)try{const r=ptr(g[e]);if(r.isNull())continue;if(null===u){const e=c.probeDexFileOffsets(r);void 0!==e?.dexFileBeginOffset&&(u=e.dexFileBeginOffset,l.info(s,`Probed DexFile::begin_ offset: 0x${u.toString(16)}`))}if(null!==u){const e=i(r.add(u));if(e&&!e.isNull()&&t.dumpFromAddress(e,s,{loader:m})){f++;continue}}for(let e=0;e<128;e+=Process.pointerSize){const n=i(r.add(e));if(n&&!n.isNull())try{if(n.readU32()===o){null===u&&(u=e,l.info(s,`Found DexFile::begin_ at offset 0x${e.toString(16)}`)),t.dumpFromAddress(n,s,{loader:m})&&f++;break}}catch{continue}}}catch(e){l.debug(s,`Cookie entry error: ${e}`)}}catch(e){l.debug(s,`DexElement error: ${e}`)}}catch{}},onComplete(){l.strategy(s,`Cookie extraction complete: ${f} DEX files`),r(s,"complete",`Found ${f} DEX files`)}})}catch(e){l.strategyError(s,`Cookie extraction failed: ${e}`),r(s,"error",`${e}`)}}
âœ„
{"version":3,"file":"dexFileConstructorHook.js","names":["STRATEGY_NAMES","DEX_MAGIC","validateDexHeader","sendStrategyStatus","logger","TAG","DEXFILE_CONSTRUCTOR","runDexFileConstructorHook","dumper","strategy","libart","Process","findModuleByName","strategyError","constructors","findDexFileConstructors","length","libdexfile","push","warn","hooked","ctor","Interceptor","attach","address","onEnter","args","argIdx","candidate","isNull","readU32","dumpFromAddress","location","name","info","e","debug","mod","results","seen","Set","processSymbol","includes","test","key","toString","has","add","symbols","enumerateSymbols","sym","type","exports","enumerateExports","exp"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/strategies/","sources":["dexFileConstructorHook.ts"],"mappings":"yBACSA,eAAgBC,MAAiB,qDACjCC,MAAyB,uDACzBC,MAA0B,6CAC1BC,MAAc,qBAEvB,MAAMC,EAAML,EAAeM,2BAmBrB,SAAUC,0BAA0BC,GACtCJ,EAAOK,SAASJ,EAAK,2CACrBF,EAAmBE,EAAK,SAAU,gCAElC,MAAMK,EAASC,QAAQC,iBAAiB,aACxC,IAAKF,EAGD,OAFAN,EAAOS,cAAcR,EAAK,4BAC1BF,EAAmBE,EAAK,QAAS,uBAKrC,MAAMS,EAAeC,EAAwBL,GAE7C,GAA4B,IAAxBI,EAAaE,OAAc,CAE3B,MAAMC,EAAaN,QAAQC,iBAAiB,iBACxCK,GACAH,EAAaI,QAAQH,EAAwBE,G,CAIrD,GAA4B,IAAxBH,EAAaE,OAGb,OAFAZ,EAAOe,KAAKd,EAAK,sCACjBF,EAAmBE,EAAK,UAAW,iCAIvC,IAAIe,EAAS,EAEb,IAAK,MAAMC,KAAQP,EACf,IACIQ,YAAYC,OAAOF,EAAKG,QAAS,CAC7BC,QAAQC,GASJ,IAAK,MAAMC,IAAU,CAAC,EAAG,EAAG,GACxB,IACI,MAAMC,EAAYF,EAAKC,GACvB,IAAKC,GAAaA,EAAUC,SAAU,SAGtC,GADcD,EAAUE,YACV7B,EAAW,SAGzB,GADiBC,EAAkB0B,GACpB,EAIX,YAHApB,EAAOuB,gBAAgBH,EAAWvB,EAAK,CACnC2B,SAAUX,EAAKY,M,CAIzB,MACE,Q,CAGZ,IAGJb,IACAhB,EAAO8B,KAAK7B,EAAK,uBAAuBgB,EAAKY,O,CAC/C,MAAOE,GACL/B,EAAOgC,MAAM/B,EAAK,kBAAkBgB,EAAKY,SAASE,I,CAItDf,EAAS,EACTjB,EAAmBE,EAAK,SAAU,UAAUe,0BAE5CjB,EAAmBE,EAAK,QAAS,iCAEzC,CAMA,SAASU,EAAwBsB,GAC7B,MAAMC,EAA2D,GAC3DC,EAAO,IAAIC,IAEXC,EAAgB,CAACR,EAAcT,KAEjC,IAAKS,EAAKS,SAAS,gBAAkBT,EAAKS,SAAS,cAAe,OAIlE,GAAI,wBAAwBC,KAAKV,GAAO,OAExC,MAAMW,EAAMpB,EAAQqB,WAChBN,EAAKO,IAAIF,KACbL,EAAKQ,IAAIH,GAETN,EAAQpB,KAAK,CAAEM,UAASS,SAAO,EAInC,IACI,MAAMe,EAAUX,EAAIY,mBACpB,IAAK,MAAMC,KAAOF,EACG,aAAbE,EAAIC,MACRV,EAAcS,EAAIjB,KAAMiB,EAAI1B,Q,CAElC,MAAOW,GACL/B,EAAOgC,MAAM/B,EAAK,iCAAiCgC,EAAIJ,SAASE,I,CAIpE,IACI,MAAMiB,EAAUf,EAAIgB,mBACpB,IAAK,MAAMC,KAAOF,EACG,aAAbE,EAAIH,MACRV,EAAca,EAAIrB,KAAMqB,EAAI9B,Q,CAElC,M,CAIF,OAAOc,CACX","ignoreList":[]}
âœ„
import{STRATEGY_NAMES as o,DEX_MAGIC as t}from"../config/constants.js";import{validateDexHeader as e}from"../utils/memoryUtils.js";import{sendStrategyStatus as r}from"../utils/messageSender.js";import{logger as n}from"../utils/logger.js";const s=o.DEXFILE_CONSTRUCTOR;export function runDexFileConstructorHook(o){n.strategy(s,"Setting up DexFile constructor hooks..."),r(s,"active","Hooking DexFile constructors");const c=Process.findModuleByName("libart.so");if(!c)return n.strategyError(s,"libart.so not found"),void r(s,"error","libart.so not found");const u=i(c);if(0===u.length){const o=Process.findModuleByName("libdexfile.so");o&&u.push(...i(o))}if(0===u.length)return n.warn(s,"No DexFile constructors found"),void r(s,"skipped","No DexFile constructors found");let a=0;for(const r of u)try{Interceptor.attach(r.address,{onEnter(n){for(const i of[1,2,3])try{const c=n[i];if(!c||c.isNull())continue;if(c.readU32()!==t)continue;if(e(c)>0)return void o.dumpFromAddress(c,s,{location:r.name})}catch{continue}}}),a++,n.info(s,`Hooked constructor: ${r.name}`)}catch(o){n.debug(s,`Failed to hook ${r.name}: ${o}`)}a>0?r(s,"active",`Hooked ${a} DexFile constructors`):r(s,"error","Failed to hook any constructor")}function i(o){const t=[],e=new Set,r=(o,r)=>{if(!o.includes("DexFileC1E")&&!o.includes("DexFileC2E"))return;if(/DexFileC[12]E(RKS|OS)/.test(o))return;const n=r.toString();e.has(n)||(e.add(n),t.push({address:r,name:o}))};try{const t=o.enumerateSymbols();for(const o of t)"function"===o.type&&r(o.name,o.address)}catch(t){n.debug(s,`Symbol enumeration failed for ${o.name}: ${t}`)}try{const t=o.enumerateExports();for(const o of t)"function"===o.type&&r(o.name,o.address)}catch{}return t}
âœ„
{"version":3,"file":"fartDump.js","names":["STRATEGY_NAMES","DEX_MAGIC","sendStrategyStatus","safeReadPointer","isValidPointer","logger","TAG","FART_DUMP","runFartDump","dumper","offsetResolver","offsets","strategy","found","libart","Process","findModuleByName","warn","hookAddr","hookName","match","enumerateSymbols","find","s","name","includes","type","address","e","debug","enumerateExports","info","Interceptor","attach","onEnter","args","argIdx","dexFilePtr","isNull","off","pointerSize","candidate","add","readPointer","readU32","dumpFromAddress","hookDefineClass","runtimePtr","getRuntimeInstance","classLinker","runtimeClassLinkerOffset","libBase","base","libEnd","size","dexPtrs","Set","dexAddresses","clOff","p1","p2","compare","sub","toUInt32","count","dexCount","sampleSize","Math","min","i","entryPtr","dOff","dexBegin","max","floor","toString","key","has","push","length","Thread","sleep","walkClassTable"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/strategies/","sources":["fartDump.ts"],"mappings":"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","ignoreList":[]}
âœ„
import{STRATEGY_NAMES as e,DEX_MAGIC as n}from"../config/constants.js";import{sendStrategyStatus as t}from"../utils/messageSender.js";import{safeReadPointer as o,isValidPointer as i}from"../utils/memoryUtils.js";import{logger as s}from"../utils/logger.js";const r=e.FART_DUMP;export function runFartDump(e,a,c){s.strategy(r,"Starting FART-style dump..."),t(r,"active","Setting up class definition hooks");let d=0;!function(e){const t=Process.findModuleByName("libart.so");if(!t)return void s.warn(r,"libart.so not found");let o=null,i="";try{const e=t.enumerateSymbols().find((e=>e.name.includes("ClassLinker")&&e.name.includes("DefineClass")&&e.name.includes("DexFile")&&"function"===e.type));e&&(o=e.address,i=e.name)}catch(e){s.debug(r,`Symbol enumeration failed: ${e}`)}if(!o)try{const e=t.enumerateExports().find((e=>e.name.includes("ClassLinker")&&e.name.includes("DefineClass")&&e.name.includes("DexFile")&&"function"===e.type));e&&(o=e.address,i=e.name)}catch{}if(!o)return void s.warn(r,"ClassLinker::DefineClass not found");s.info(r,`Hooking ${i}`);try{Interceptor.attach(o,{onEnter(t){try{for(const o of[5,4,3,6])try{const i=t[o];if(!i||i.isNull())continue;for(let t=0;t<128;t+=Process.pointerSize)try{const o=i.add(t).readPointer();if(o.isNull())continue;if(o.readU32()===n)return void e.dumpFromAddress(o,r)}catch{continue}}catch{continue}}catch{}}}),s.info(r,"ClassLinker::DefineClass hooked")}catch(e){s.warn(r,`Failed to hook DefineClass: ${e}`)}}(e),c&&(d+=function(e,t,a){let c=0;const d=t.getRuntimeInstance();if(!d)return 0;const l=o(d.add(a.runtimeClassLinkerOffset));if(!l||!i(l))return 0;s.info(r,"Scanning ClassLinker for additional DexFile vectors...");const f=Process.findModuleByName("libart.so");if(!f)return 0;const u=f.base,m=u.add(f.size),p=new Set,h=[];for(let e=0;e<1536;e+=Process.pointerSize)try{const t=l.add(e).readPointer(),a=l.add(e+Process.pointerSize).readPointer();if(!i(t)||!i(a))continue;if(a.compare(t)<=0)continue;if(t.compare(u)>=0&&t.compare(m)<0)continue;const c=a.sub(t).toUInt32();if(0===c||c>10485760||c%Process.pointerSize!=0)continue;const d=c/Process.pointerSize;if(d>1e4)continue;let f=0;const y=Math.min(d,10);for(let e=0;e<y;e++){const s=o(t.add(e*Process.pointerSize));if(s&&i(s))for(let e=0;e<64;e+=Process.pointerSize)try{const t=s.add(e).readPointer();if(t.isNull())continue;if(t.readU32()===n){f++;break}}catch{break}}if(f>=Math.max(1,Math.floor(y/2))){s.debug(r,`DexFile vector at CL+0x${e.toString(16)} (${d} entries)`);for(let e=0;e<d;e++){const s=o(t.add(e*Process.pointerSize));if(s&&i(s))for(let e=0;e<64;e+=Process.pointerSize)try{const t=s.add(e).readPointer();if(t.isNull())continue;if(t.readU32()===n){const e=t.toString();p.has(e)||(p.add(e),h.push(t));break}}catch{break}}}}catch{continue}s.info(r,`Found ${h.length} unique DEX addresses in class table`);for(let n=0;n<h.length;n++)e.dumpFromAddress(h[n],r)&&(c++,Thread.sleep(.001));return c}(e,a,c)),d>0&&s.strategy(r,`FART dump found ${d} DEX files from class table`),t(r,"active",`Found ${d} DEX files, hook active for new classes`)}
âœ„
{"version":3,"file":"memoryScanner.js","names":["STRATEGY_NAMES","DEX_MAGIC_BYTES","CDEX_MAGIC_BYTES","SCAN_BATCH_SIZE","SCAN_DELAY_MS","validateDexHeader","readDexBytes","sendScanProgress","sendStrategyStatus","logger","TAG","MEMORY_SCAN","SKIP_EXTENSIONS","shouldSkipRange","range","size","file","path","startsWith","lower","toLowerCase","ext","endsWith","debug","base","toFixed","runMemoryScanner","dumper","deepScan","strategy","ranges","Process","enumerateRanges","total","length","scanned","skipped","found","info","i","batch","slice","matches","Memory","scanSync","match","fileSize","address","rangeEnd","add","compare","dumpFromAddress","cdexMatches","cdexSize","readU32","remaining","sub","toUInt32","bytes","dumpBytes","Thread","sleep","e","strategyError"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/strategies/","sources":["memoryScanner.ts"],"mappings":"yBACSA,qBAAgBC,sBAAiBC,qBAAkBC,mBAAiBC,MAAqB,qDACzFC,kBAAmBC,MAAoB,qDACvCC,wBAAkBC,MAA0B,6CAC5CC,MAAc,qBAEvB,MAAMC,EAAMV,EAAeW,YASrBC,EAAkB,CAAC,MAAO,OAAQ,QAAS,OAAQ,QAAS,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,SAElH,SAASC,EAAgBC,GACrB,GAAIA,EAAMC,KAAO,IAAM,OAAO,EAE9B,GAAID,EAAME,MAAQF,EAAME,KAAKC,KAAM,CAC/B,MAAMA,EAAOH,EAAME,KAAKC,KACxB,GAAIA,EAAKC,WAAW,UAAYD,EAAKC,WAAW,SAAU,OAAO,EAGjE,MAAMC,EAAQF,EAAKG,cACnB,IAAK,MAAMC,KAAOT,EACd,GAAIO,EAAMG,SAASD,GAAM,OAAO,C,CAKxC,OAAIP,EAAMC,KApBe,UAqBrBN,EAAOc,MAAMb,EAAK,yBAAyBI,EAAMU,UAAUV,EAAMC,KAAO,KAAO,MAAMU,QAAQ,WACtF,EAIf,QAQM,SAAUC,iBAAiBC,EAAmBC,GAChDnB,EAAOoB,SAASnB,EAAK,2BACrBF,EAAmBE,EAAK,SAAU,yCAElC,IACI,MAAMoB,EAASC,QAAQC,gBAAgB,OACjCC,EAAQH,EAAOI,OACrB,IAAIC,EAAU,EACVC,EAAU,EACVC,EAAQ,EAEZ5B,EAAO6B,KAAK5B,EAAK,YAAYuB,oBAE7B,IAAK,IAAIM,EAAI,EAAGA,EAAIT,EAAOI,OAAQK,GAAKpC,EAAiB,CACrD,MAAMqC,EAAQV,EAAOW,MAAMF,EAAGA,EAAIpC,GAElC,IAAK,MAAMW,KAAS0B,EAGhB,GAFAL,IAEItB,EAAgBC,GAChBsB,SAIJ,IAEI,MAAMM,EAAUC,OAAOC,SAAS9B,EAAMU,KAAMV,EAAMC,KAAMd,GACxD,IAAK,MAAM4C,KAASH,EAAS,CACzB,MAAMI,EAAWzC,EAAkBwC,EAAME,SACzC,GAAiB,IAAbD,EAAgB,SAGpB,MAAME,EAAWlC,EAAMU,KAAKyB,IAAInC,EAAMC,MACvB8B,EAAME,QAAQE,IAAIH,GACtBI,QAAQF,GAAY,GAE3BrB,EAAOwB,gBAAgBN,EAAME,QAASrC,EAAK,CAC3CO,KAAMH,EAAME,MAAMC,QAElBoB,G,CAKR,GAAIT,EAAU,CACV,MAAMwB,EAAcT,OAAOC,SAAS9B,EAAMU,KAAMV,EAAMC,KAAMb,GAC5D,IAAK,MAAM2C,KAASO,EAAa,CAC7B3C,EAAOc,MAAMb,EAAK,iBAAiBmC,EAAME,WACzC,IACI,MAAMM,EAAWR,EAAME,QAAQE,IAAI,IAAMK,UACnCC,EAAYzC,EAAMU,KAAKyB,IAAInC,EAAMC,MAAMyC,IAAIX,EAAME,SAASU,WAChE,GAAIJ,EAAW,KAAQA,GAAYE,EAAW,CAC1C,MAAMG,EAAQpD,EAAauC,EAAME,QAASM,GACtCK,GACI/B,EAAOgC,UAAUD,EAAOhD,EAAK,CAC7BO,KAAMH,EAAME,MAAMC,QAElBoB,G,EAId,M,IAKZ,M,CAMN9B,EAAiB4B,EAASF,EAAOI,GAG7BE,EAAIpC,EAAkB2B,EAAOI,QAC7B0B,OAAOC,MAAMzD,EAAgB,I,CAIrCK,EAAOoB,SAASnB,EAAK,kBAAkB2B,sBAA0BF,sBAA4BC,cAC7F5B,EAAmBE,EAAK,WAAY,SAAS2B,c,CAC/C,MAAOyB,GACLrD,EAAOsD,cAAcrD,EAAK,uBAAuBoD,KACjDtD,EAAmBE,EAAK,QAAS,GAAGoD,I,CAE5C","ignoreList":[]}
âœ„
import{STRATEGY_NAMES as e,DEX_MAGIC_BYTES as s,CDEX_MAGIC_BYTES as t,SCAN_BATCH_SIZE as r,SCAN_DELAY_MS as o}from"../config/constants.js";import{validateDexHeader as n,readDexBytes as a}from"../utils/memoryUtils.js";import{sendScanProgress as i,sendStrategyStatus as c}from"../utils/messageSender.js";import{logger as d}from"../utils/logger.js";const f=e.MEMORY_SCAN,m=[".so",".oat",".vdex",".art",".odex",".apk",".jar",".ttf",".otf",".png",".jpg",".webp"];function l(e){if(e.size<112)return!0;if(e.file&&e.file.path){const s=e.file.path;if(s.startsWith("/dev/")||s.startsWith("/sys/"))return!0;const t=s.toLowerCase();for(const e of m)if(t.endsWith(e))return!0}return e.size>8388608&&(d.debug(f,`Skipping large region ${e.base} (${(e.size/1024/1024).toFixed(1)} MB)`),!0)}export function runMemoryScanner(e,m){d.strategy(f,"Starting memory scan..."),c(f,"active","Scanning memory regions for DEX files");try{const p=Process.enumerateRanges("r--"),g=p.length;let u=0,y=0,h=0;d.info(f,`Scanning ${g} memory regions`);for(let c=0;c<p.length;c+=r){const S=p.slice(c,c+r);for(const r of S)if(u++,l(r))y++;else try{const o=Memory.scanSync(r.base,r.size,s);for(const s of o){const t=n(s.address);if(0===t)continue;const o=r.base.add(r.size);s.address.add(t).compare(o)>0||e.dumpFromAddress(s.address,f,{path:r.file?.path})&&h++}if(m){const s=Memory.scanSync(r.base,r.size,t);for(const t of s){d.debug(f,`Found CDEX at ${t.address}`);try{const s=t.address.add(32).readU32(),o=r.base.add(r.size).sub(t.address).toUInt32();if(s>112&&s<=o){const o=a(t.address,s);o&&e.dumpBytes(o,f,{path:r.file?.path})&&h++}}catch{}}}}catch{}i(u,g,h),c+r<p.length&&Thread.sleep(o/1e3)}d.strategy(f,`Scan complete: ${h} DEX files found (${u} regions scanned, ${y} skipped)`),c(f,"complete",`Found ${h} DEX files`)}catch(e){d.strategyError(f,`Memory scan failed: ${e}`),c(f,"error",`${e}`)}}
âœ„
{"version":3,"file":"mmapHook.js","names":["STRATEGY_NAMES","DEX_MAGIC","validateDexHeader","sendStrategyStatus","logger","TAG","MMAP_HOOK","runMmapHook","dumper","strategy","libc","Process","findModuleByName","strategyError","readlinkFunc","readlinkAddr","findExportByName","NativeFunction","hooked","funcName","addr","Interceptor","attach","onEnter","args","fd","toInt32","length","toUInt32","this","skip","onLeave","retval","equals","ptr","isNull","readU32","fileSize","path","linkBuf","Memory","alloc","linkPath","allocUtf8String","len","readUtf8String","undefined","dumpFromAddress","info","e","warn","debug"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/strategies/","sources":["mmapHook.ts"],"mappings":"yBACSA,eAAgBC,MAAiB,qDACjCC,MAAyB,uDACzBC,MAA0B,6CAC1BC,MAAc,qBAEvB,MAAMC,EAAML,EAAeM,iBAUrB,SAAUC,YAAYC,GACxBJ,EAAOK,SAASJ,EAAK,mCACrBF,EAAmBE,EAAK,SAAU,uBAElC,MAAMK,EAAOC,QAAQC,iBAAiB,WACtC,IAAKF,EAGD,OAFAN,EAAOS,cAAcR,EAAK,0BAC1BF,EAAmBE,EAAK,QAAS,qBAKrC,IAAIS,EAAsF,KAC1F,MAAMC,EAAeL,EAAKM,iBAAiB,YACvCD,IACAD,EAAe,IAAIG,eAAeF,EAAc,MAAO,CAAC,UAAW,UAAW,SAGlF,IAAIG,EAAS,EAGb,IAAK,MAAMC,IAAY,CAAC,OAAQ,UAAW,CACvC,MAAMC,EAAOV,EAAKM,iBAAiBG,GACnC,GAAKC,EAKL,IACIC,YAAYC,OAAOF,EAAM,CACrBG,QAAQC,GAIJ,MAAMC,EAAKD,EAAK,GAAGE,UACbC,EAASH,EAAK,GAAGI,WACnBH,EAAK,GAAKE,EAAS,IACnBE,KAAKC,MAAO,GAGhBD,KAAKC,MAAO,EACZD,KAAKF,OAASA,EACdE,KAAKJ,GAAKA,EACd,EACAM,QAAQC,GACJ,GAAIH,KAAKC,KAAM,OAGf,GAAIE,EAAOC,OAAOC,KAAK,KAAOF,EAAOG,SAAU,OAE/C,MAAMR,EAASE,KAAKF,OAEpB,IAEI,GADcK,EAAOI,YACPnC,EAAW,OAEzB,MAAMoC,EAAWnC,EAAkB8B,GACnC,GAAiB,IAAbK,EAAgB,OACpB,GAAIA,EAAWV,EAAQ,OAGvB,IAAIW,EACJ,MAAMb,EAAKI,KAAKJ,GAChB,GAAIA,GAAM,GAAKX,EACX,IACI,MAAMyB,EAAUC,OAAOC,MAAM,KACvBC,EAAWF,OAAOG,gBAAgB,iBAAiBlB,KACnDmB,EAAM9B,EAAa4B,EAAUH,EAAS,KACxCK,EAAM,IACNN,EAAOC,EAAQM,eAAeD,SAAQE,E,CAE5C,M,CAKNtC,EAAOuC,gBAAgBf,EAAQ3B,EAAK,CAAEiC,Q,CACxC,M,CAGN,IAEJpB,IACAd,EAAO4C,KAAK3C,EAAK,UAAUc,I,CAC7B,MAAO8B,GACL7C,EAAO8C,KAAK7C,EAAK,kBAAkBc,MAAa8B,I,MA7DhD7C,EAAO+C,MAAM9C,EAAK,GAAGc,yB,CAiEzBD,EAAS,EACTf,EAAmBE,EAAK,SAAU,UAAUa,mBAE5Cf,EAAmBE,EAAK,QAAS,kCAEzC","ignoreList":[]}
âœ„
import{STRATEGY_NAMES as t,DEX_MAGIC as o}from"../config/constants.js";import{validateDexHeader as r}from"../utils/memoryUtils.js";import{sendStrategyStatus as n}from"../utils/messageSender.js";import{logger as i}from"../utils/logger.js";const e=t.MMAP_HOOK;export function runMmapHook(t){i.strategy(e,"Setting up mmap/mmap64 hooks..."),n(e,"active","Hooking mmap/mmap64");const s=Process.findModuleByName("libc.so");if(!s)return i.strategyError(e,"libc.so not found"),void n(e,"error","libc.so not found");let a=null;const m=s.findExportByName("readlink");m&&(a=new NativeFunction(m,"int",["pointer","pointer","int"]));let c=0;for(const n of["mmap","mmap64"]){const m=s.findExportByName(n);if(m)try{Interceptor.attach(m,{onEnter(t){const o=t[4].toInt32(),r=t[1].toUInt32();o<0||r<112?this.skip=!0:(this.skip=!1,this.length=r,this.fd=o)},onLeave(n){if(this.skip)return;if(n.equals(ptr(-1))||n.isNull())return;const i=this.length;try{if(n.readU32()!==o)return;const s=r(n);if(0===s)return;if(s>i)return;let m;const c=this.fd;if(c>=0&&a)try{const t=Memory.alloc(512),o=Memory.allocUtf8String(`/proc/self/fd/${c}`),r=a(o,t,511);r>0&&(m=t.readUtf8String(r)??void 0)}catch{}t.dumpFromAddress(n,e,{path:m})}catch{}}}),c++,i.info(e,`Hooked ${n}`)}catch(t){i.warn(e,`Failed to hook ${n}: ${t}`)}else i.debug(e,`${n} not found in libc.so`)}c>0?n(e,"active",`Hooked ${c} mmap variants`):n(e,"error","Failed to hook any mmap variant")}
âœ„
{"version":3,"file":"oatExtractor.js","names":["STRATEGY_NAMES","DEX_MAGIC_BYTES","validateDexHeader","sendStrategyStatus","logger","TAG","OAT_EXTRACT","runOatExtractor","dumper","strategy","found","fileRegions","regions","Map","ranges","Process","enumerateRanges","fileRanges","range","path","file","endsWith","arr","get","set","push","base","size","rangeList","sort","a","b","compare","currentBase","currentEnd","add","i","length","nextBase","nextEnd","totalSize","sub","toUInt32","collectFileRegions","info","key","region","split","scanRegionForDex","MAX_ANON_SCAN","readU32","debug","toFixed","e","strategyError","CHUNK","totalChunks","Math","ceil","allMatches","c","chunkBase","chunkSize","min","chunkMatches","Memory","scanSync","concat","Thread","sleep","matches","match","fileSize","address","regionEnd","dumpFromAddress","toString"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/strategies/","sources":["oatExtractor.ts"],"mappings":"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","ignoreList":[]}
âœ„
import{STRATEGY_NAMES as t,DEX_MAGIC_BYTES as e}from"../config/constants.js";import{validateDexHeader as o}from"../utils/memoryUtils.js";import{sendStrategyStatus as s}from"../utils/messageSender.js";import{logger as n}from"../utils/logger.js";const r=t.OAT_EXTRACT;export function runOatExtractor(t){n.strategy(r,"Starting OAT/VDEX extraction..."),s(r,"active","Extracting DEX from OAT/VDEX files");let e=0;try{const o=function(){const t=new Map,e=Process.enumerateRanges("r--"),o=new Map;for(const t of e){const e=t.file?.path;if(!e)continue;if(!e.endsWith(".vdex")&&!e.endsWith(".oat")&&!e.endsWith(".odex"))continue;let s=o.get(e);s||(s=[],o.set(e,s)),s.push({base:t.base,size:t.size})}for(const[e,s]of o){s.sort(((t,e)=>t.base.compare(e.base)));let o=s[0].base,n=o.add(s[0].size);for(let r=1;r<s.length;r++){const a=s[r].base,i=a.add(s[r].size);a.compare(n)<=0?i.compare(n)>0&&(n=i):(t.set(`${e}@${o}`,{base:o,totalSize:n.sub(o).toUInt32()}),o=a,n=i)}t.set(`${e}@${o}`,{base:o,totalSize:n.sub(o).toUInt32()})}return t}();n.info(r,`Found ${o.size} VDEX/OAT files in memory`);for(const[s,n]of o){const o=s.split("@")[0];e+=a(t,n.base,n.totalSize,o)}const i=33554432,c=Process.enumerateRanges("r--");for(const o of c)if(!(o.size<256||o.file?.path||o.size>i))try{2019910774===o.base.readU32()&&(n.debug(r,`Found anonymous VDEX at ${o.base} (${(o.size/1024/1024).toFixed(1)} MB)`),e+=a(t,o.base,o.size))}catch{continue}n.strategy(r,`OAT/VDEX extraction complete: ${e} DEX files`),s(r,"complete",`Found ${e} DEX files`)}catch(t){n.strategyError(r,`OAT/VDEX extraction failed: ${t}`),s(r,"error",`${t}`)}}function a(t,s,a,i){let c=0;const d=8388608,f=Math.ceil(a/d);try{let l=[];for(let t=0;t<f;t++){const o=s.add(t*d),n=Math.min(d,a-t*d),r=Memory.scanSync(o,n,e);l=l.concat(r),f>1&&t<f-1&&Thread.sleep(.001)}const m=l;for(const e of m){const d=o(e.address);if(0===d)continue;const f=s.add(a);e.address.add(d).compare(f)>0||t.dumpFromAddress(e.address,r,{path:i})&&(c++,n.debug(r,`Extracted DEX (${d} bytes) from ${i??s.toString()}`))}}catch(t){n.debug(r,`Scan failed for ${i??s.toString()}: ${t}`)}return c}
âœ„
{"version":3,"file":"openCommonHook.js","names":["STRATEGY_NAMES","validateDexHeader","sendStrategyStatus","logger","TAG","OPEN_COMMON_HOOK","runOpenCommonHook","dumper","strategy","hookAddress","hookLibrary","hookName","searchLibraries","lib","mod","Process","findModuleByName","match","enumerateSymbols","find","s","name","includes","type","address","enumerateExports","e","strategyError","info","Interceptor","attach","onEnter","args","argIdx","candidate","isNull","dumpFromAddress","location"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/strategies/","sources":["openCommonHook.ts"],"mappings":"yBACSA,MAAsB,qDACtBC,MAAyB,uDACzBC,MAA0B,6CAC1BC,MAAc,qBACvB,MAAMC,EAAMJ,EAAeK,wBAUrB,SAAUC,kBAAkBC,GAC9BJ,EAAOK,SAASJ,EAAK,6CAErB,IAAIK,EAAoC,KACpCC,EAAc,YACdC,EAAW,GAGf,MAAMC,EAAkB,CAAC,gBAAiB,aAE1C,IAAK,MAAMC,KAAOD,EACd,IACI,MAAME,EAAMC,QAAQC,iBAAiBH,GACrC,IAAKC,EAAK,SAEV,MACMG,EADUH,EAAII,mBACEC,MAAMC,GACxBA,EAAEC,KAAKC,SAAS,aACfF,EAAEC,KAAKC,SAAS,eAAiBF,EAAEC,KAAKC,SAAS,gBACvC,aAAXF,EAAEG,OAGN,GAAIN,EAAO,CACPR,EAAcQ,EAAMO,QACpBd,EAAcG,EACdF,EAAWM,EAAMI,KACjB,K,EAEN,MACE,Q,CAKR,IAAKZ,EACD,IAAK,MAAMI,KAAOD,EACd,IACI,MAAME,EAAMC,QAAQC,iBAAiBH,GACrC,IAAKC,EAAK,SAEV,MACMG,EADUH,EAAIW,mBACEN,MAAMO,GACxBA,EAAEL,KAAKC,SAAS,aACfI,EAAEL,KAAKC,SAAS,eAAiBI,EAAEL,KAAKC,SAAS,gBACvC,aAAXI,EAAEH,OAEN,GAAIN,EAAO,CACPR,EAAcQ,EAAMO,QACpBd,EAAcG,EACdF,EAAWM,EAAMI,KACjB,K,EAEN,MACE,Q,CAKZ,IAAKZ,EAGD,OAFAN,EAAOwB,cAAcvB,EAAK,oDAC1BF,EAAmBE,EAAK,UAAW,oBAIvCD,EAAOyB,KAAKxB,EAAK,WAAWO,QAAeD,KAE3C,IACImB,YAAYC,OAAOrB,EAAa,CAC5BsB,QAAQC,GAIJ,IAAK,IAAIC,EAAS,EAAGA,EAAS,EAAGA,IAC7B,IACI,MAAMC,EAAYF,EAAKC,GACvB,GAAIC,EAAUC,SAAU,SAGxB,GADiBlC,EAAkBiC,GACpB,EAIX,YAHA3B,EAAO6B,gBAAgBF,EAAW9B,EAAK,CACnCiC,SAAU1B,G,CAIpB,MACE,Q,CAGZ,IAGJT,EAAmBE,EAAK,SAAU,UAAUM,I,CAC9C,MAAOgB,GACLvB,EAAOwB,cAAcvB,EAAK,mBAAmBsB,KAC7CxB,EAAmBE,EAAK,QAAS,GAAGsB,I,CAE5C","ignoreList":[]}
âœ„
import{STRATEGY_NAMES as o}from"../config/constants.js";import{validateDexHeader as e}from"../utils/memoryUtils.js";import{sendStrategyStatus as n}from"../utils/messageSender.js";import{logger as t}from"../utils/logger.js";const r=o.OPEN_COMMON_HOOK;export function runOpenCommonHook(o){t.strategy(r,"Setting up OpenCommon/OpenMemory hooks...");let i=null,s="libart.so",m="";const c=["libdexfile.so","libart.so"];for(const o of c)try{const e=Process.findModuleByName(o);if(!e)continue;const n=e.enumerateSymbols().find((o=>o.name.includes("DexFile")&&(o.name.includes("OpenCommon")||o.name.includes("OpenMemory"))&&"function"===o.type));if(n){i=n.address,s=o,m=n.name;break}}catch{continue}if(!i)for(const o of c)try{const e=Process.findModuleByName(o);if(!e)continue;const n=e.enumerateExports().find((o=>o.name.includes("DexFile")&&(o.name.includes("OpenCommon")||o.name.includes("OpenMemory"))&&"function"===o.type));if(n){i=n.address,s=o,m=n.name;break}}catch{continue}if(!i)return t.strategyError(r,"Could not find OpenCommon/OpenMemory symbol"),void n(r,"skipped","Symbol not found");t.info(r,`Hooking ${m} in ${s}`);try{Interceptor.attach(i,{onEnter(n){for(let t=0;t<3;t++)try{const i=n[t];if(i.isNull())continue;if(e(i)>0)return void o.dumpFromAddress(i,r,{location:m})}catch{continue}}}),n(r,"active",`Hooked ${s}`)}catch(o){t.strategyError(r,`Failed to hook: ${o}`),n(r,"error",`${o}`)}}
âœ„
{"version":3,"file":"logger.js","names":["debugEnabled","setDebug","enabled","log","level","tag","message","now","Date","time","pad","getHours","getMinutes","getSeconds","console","n","logger","debug","msg","info","warn","error","strategy","name","strategyError"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/utils/","sources":["logger.ts"],"mappings":"AAMA,IAAIA,GAAe,SAEb,SAAUC,SAASC,GACrBF,EAAeE,CACnB,CAEA,SAASC,EAAIC,EAAiBC,EAAaC,GACvC,GAAc,UAAVF,IAAsBJ,EAAc,OACxC,MAAMO,EAAM,IAAIC,KACVC,EAAO,GAAGC,EAAIH,EAAII,eAAeD,EAAIH,EAAIK,iBAAiBF,EAAIH,EAAIM,gBACxEC,QAAQX,IAAI,IAAIM,OAAUL,OAAWC,MAAQC,IACjD,CAEA,SAASI,EAAIK,GACT,OAAOA,EAAI,GAAK,IAAMA,EAAI,GAAKA,CACnC,QAEO,MAAMC,OAAS,CAClBC,MAAMZ,EAAaa,GAAqBf,EAAI,QAASE,EAAKa,EAAM,EAChEC,KAAKd,EAAaa,GAAqBf,EAAI,OAAQE,EAAKa,EAAM,EAC9DE,KAAKf,EAAaa,GAAqBf,EAAI,OAAQE,EAAKa,EAAM,EAC9DG,MAAMhB,EAAaa,GAAqBf,EAAI,QAASE,EAAKa,EAAM,EAEhEI,SAASC,EAAoBL,GAAqBf,EAAI,OAAQ,YAAYoB,IAAQL,EAAM,EACxFM,cAAcD,EAAoBL,GAAqBf,EAAI,QAAS,YAAYoB,IAAQL,EAAM","ignoreList":[]}
âœ„
let e=!1;export function setDebug(t){e=t}function t(t,n,o){if("DEBUG"===t&&!e)return;const g=new Date,s=`${r(g.getHours())}:${r(g.getMinutes())}:${r(g.getSeconds())}`;console.log(`[${s}] [${t}] [${n}] ${o}`)}function r(e){return e<10?"0"+e:""+e}export const logger={debug(e,r){t("DEBUG",e,r)},info(e,r){t("INFO",e,r)},warn(e,r){t("WARN",e,r)},error(e,r){t("ERROR",e,r)},strategy(e,r){t("INFO",`STRATEGY:${e}`,r)},strategyError(e,r){t("ERROR",`STRATEGY:${e}`,r)}};
âœ„
{"version":3,"file":"memoryUtils.js","names":["DEX_MAGIC","DEX_FILE_SIZE_OFFSET","DEX_HEADER_SIZE_OFFSET","DEX_ENDIAN_TAG_OFFSET","DEX_HEADER_SIZE","DEX_ENDIAN_CONSTANT","MAX_DEX_SIZE","MIN_DEX_SIZE","validateDexHeader","address","readU32","fileSize","add","headerSize","endianTag","readDexBytes","size","readByteArray","safeReadPointer","readPointer","safeReadU32","safeReadU64","readU64","isValidPointer","p","isNull","compare","ptr","and","Process","pointerSize","getDexSizeFromBegin","beginPtr"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/utils/","sources":["memoryUtils.ts"],"mappings":"oBACIA,0BACAC,4BACAC,2BACAC,qBACAC,yBACAC,kBACAC,kBACAC,MACG,gCAMD,SAAUC,kBAAkBC,GAC9B,IAEI,GADcA,EAAQC,YACRV,EAAW,OAAO,EAEhC,MAAMW,EAAWF,EAAQG,IAAIX,GAAsBS,UAC7CG,EAAaJ,EAAQG,IAAIV,GAAwBQ,UACjDI,EAAYL,EAAQG,IAAIT,GAAuBO,UAErD,OAAIG,IAAeT,IACfU,IAAcT,GACdM,EAAWJ,GAAgBI,EAAWL,GAFC,EAIpCK,C,CACT,MACE,OAAO,C,CAEf,QAMM,SAAUI,aAAaN,EAAwBO,GACjD,IACI,OAAOP,EAAQQ,cAAcD,E,CAC/B,MACE,OAAO,I,CAEf,QAKM,SAAUE,gBAAgBT,GAC5B,IACI,OAAOA,EAAQU,a,CACjB,MACE,OAAO,I,CAEf,QAKM,SAAUC,YAAYX,GACxB,IACI,OAAOA,EAAQC,S,CACjB,MACE,OAAO,I,CAEf,QAKM,SAAUW,YAAYZ,GACxB,IACI,OAAOA,EAAQa,S,CACjB,MACE,OAAO,I,CAEf,QAKM,SAAUC,eAAeC,GAC3B,OAAIA,EAAEC,WAEuC,IAAzCD,EAAEE,QAAQC,IAAI,yBACmB,IAAjCH,EAAEE,QAAQC,IAAI,kBAEbH,EAAEI,IAAIC,QAAQC,YAAc,GAAGL,UAExC,QAKM,SAAUM,oBAAoBC,GAChC,OAAOxB,kBAAkBwB,EAC7B","ignoreList":[]}
âœ„
import{DEX_MAGIC as r,DEX_FILE_SIZE_OFFSET as e,DEX_HEADER_SIZE_OFFSET as t,DEX_ENDIAN_TAG_OFFSET as n,DEX_HEADER_SIZE as f,DEX_ENDIAN_CONSTANT as a,MAX_DEX_SIZE as o,MIN_DEX_SIZE as u}from"../config/constants.js";export function validateDexHeader(d){try{if(d.readU32()!==r)return 0;const c=d.add(e).readU32(),i=d.add(t).readU32(),l=d.add(n).readU32();return i!==f||(l!==a||c<u||c>o)?0:c}catch{return 0}}export function readDexBytes(r,e){try{return r.readByteArray(e)}catch{return null}}export function safeReadPointer(r){try{return r.readPointer()}catch{return null}}export function safeReadU32(r){try{return r.readU32()}catch{return null}}export function safeReadU64(r){try{return r.readU64()}catch{return null}}export function isValidPointer(r){return!r.isNull()&&(0!==r.compare(ptr("0xffffffffffffffff"))&&(0!==r.compare(ptr("0xffffffff"))&&!!r.and(Process.pointerSize-1).isNull()))}export function getDexSizeFromBegin(r){return validateDexHeader(r)}
âœ„
{"version":3,"file":"messageSender.js","names":["sendDexFound","strategy","dexBytes","extra","msg","type","size","byteLength","send","sendClassLoaded","name","loader","sendClassLoaderFound","id","loaderType","parent","sendScanProgress","scanned","total","found","sendStrategyStatus","status","message","sendError","sendInfo"],"sourceRoot":"D:/Projects/OpenSource/clsdumper/agent/src/utils/","sources":["messageSender.ts"],"mappings":"OAgEM,SAAUA,aACZC,EACAC,EACAC,GAEA,MAAMC,EAAuB,CACzBC,KAAM,YACNJ,WACAK,KAAMJ,EAASK,cACZJ,GAEPK,KAAKJ,EAAKF,EACd,QAEM,SAAUO,gBAAgBC,EAAcC,EAAgBV,GAE1DO,KADgC,CAAEH,KAAM,eAAgBK,OAAMC,SAAQV,YAE1E,QAEM,SAAUW,qBAAqBC,EAAYC,EAAoBC,GAEjEP,KADqC,CAAEH,KAAM,oBAAqBQ,KAAIC,aAAYC,UAEtF,QAEM,SAAUC,iBAAiBC,EAAiBC,EAAeC,GAE7DX,KADiC,CAAEH,KAAM,gBAAiBY,UAASC,QAAOC,SAE9E,QAEM,SAAUC,mBACZnB,EACAoB,EACAC,GAGAd,KADmC,CAAEH,KAAM,kBAAmBJ,WAAUoB,SAAQC,WAEpF,QAEM,SAAUC,UAAUtB,EAAiCqB,GAEvDd,KAD0B,CAAEH,KAAM,QAASJ,WAAUqB,WAEzD,QAEM,SAAUE,SAASF,GAErBd,KADyB,CAAEH,KAAM,OAAQiB,WAE7C","ignoreList":[]}
âœ„
export function sendDexFound(e,s,t){const n={type:"dex_found",strategy:e,size:s.byteLength,...t};send(n,s)}export function sendClassLoaded(e,s,t){send({type:"class_loaded",name:e,loader:s,strategy:t})}export function sendClassLoaderFound(e,s,t){send({type:"classloader_found",id:e,loaderType:s,parent:t})}export function sendScanProgress(e,s,t){send({type:"scan_progress",scanned:e,total:s,found:t})}export function sendStrategyStatus(e,s,t){send({type:"strategy_status",strategy:e,status:s,message:t})}export function sendError(e,s){send({type:"error",strategy:e,message:s})}export function sendInfo(e){send({type:"info",message:e})}